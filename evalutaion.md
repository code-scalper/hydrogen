---

**⚙️ [화면 ID : 7-1] 기본 정보 탭**

**■ 입력 변수 리스트 (FULL SPEC)**

| **변수명**           | **설명**                      | **단위** | **형식** | **기본값** | **최소값** | **최대값** | **선택 항목 / 조건**  |
| :------------------- | :---------------------------- | :------- | :------- | :--------- | :--------- | :--------- | :-------------------- |
| **EE_On**            | 경제성 평가 기능 활성화 여부  | -        | Select   | 1          | 0          | 1          | (0) 비활성 / (1) 활성 |
| **GraphOn**          | 그래프 표시 여부              | -        | Select   | 1          | 0          | 1          | (0) 미표시 / (1) 표시 |
| **Dal2Won**          | 환율 (달러→원)                | 원/$     | Number   | 1450       | 900        | 2000       | 직접 입력 가능        |
| **Currency_Elec**    | 급전 설비 비용 통화단위       | -        | Select   | "$"        | -          | -          | "$" 또는 "₩" 선택     |
| **Currency_LqTk**    | 액화수소 탱크 비용 통화단위   | -        | Select   | "$"        | -          | -          | "$" 또는 "₩" 선택     |
| **Currency_LqPp**    | 액화수소 펌프 비용 통화단위   | -        | Select   | "$"        | -          | -          | "$" 또는 "₩" 선택     |
| **Currency_Vap**     | 액화수소 기화기 비용 통화단위 | -        | Select   | "$"        | -          | -          | "$" 또는 "₩" 선택     |
| **Currency_Cp**      | 압축기 비용 통화단위          | -        | Select   | "$"        | -          | -          | "$" 또는 "₩" 선택     |
| **Currency_LBk**     | 저압 뱅크/버퍼 비용 통화단위  | -        | Select   | "$"        | -          | -          | "$" 또는 "₩" 선택     |
| **Currency_HBk**     | 고압 뱅크 비용 통화단위       | -        | Select   | "$"        | -          | -          | "$" 또는 "₩" 선택     |
| **Currency_Disp**    | 수소충전기 비용 통화단위      | -        | Select   | "$"        | -          | -          | "$" 또는 "₩" 선택     |
| **Currency_YrPrice** | 연도별 판매 단가 통화단위     | -        | Select   | "$"        | -          | -          | "$" 또는 "₩" 선택     |
| **Currency_YrPurch** | 연도별 구매 단가 통화단위     | -        | Select   | "$"        | -          | -          | "$" 또는 "₩" 선택     |

---

**■ 요구 기능 리스트 (Functional Requirements)**

| **기능 ID** | **기능명**           | **기능 설명**                                                                    |
| :---------- | :------------------- | :------------------------------------------------------------------------------- |
| **F301**    | SelectBox 구성       | 각 Currency\_ 변수는 Select 형식으로 통화 단위를 선택할 수 있어야 함 ("$" / "₩") |
| **F302**    | 기본값 로드          | 초기 화면 로드시 Dal2Won = 1450, 모든 Currency 변수 = "$" 로 자동 세팅           |
| **F303**    | 단위 연동            | 각 설비 탭(7-2~7-13)의 금액 단위는 해당 Currency\_\* 변수 값을 자동 참조         |
| **F304**    | 환율 연동            | Dal2Won 값 변경 시, 모든 "$" 기반 입력값 자동 환산 (1달러 × Dal2Won 적용)        |
| **F305**    | 입력값 검증          | Dal2Won 값은 900~2000 범위 내에서만 허용, SelectBox는 지정된 값만 선택 가능      |
| **F306**    | 실시간 반영          | 통화 또는 환율 값 변경 시 전체 화면 즉시 갱신 (CAPEX 계산식 내부 변수 업데이트)  |
| **F307**    | 데이터 자동저장      | 탭 전환 또는 입력 완료 시 임시 저장                                              |
| **F308**    | 그래프 활성화 설정   | GraphOn=1일 경우 경제성 평가 결과 탭(출력 그래프)에서 시각화 기능 활성화         |
| **F309**    | 그래프 비활성화 처리 | GraphOn=0일 경우 출력 탭 그래프 비활성화 및 캔버스 숨김 처리                     |
| **F310**    | 기능 On/Off          | EE_On=0일 경우 전체 탭 비활성화, EE_On=1일 경우 모든 입력 필드 활성화            |

---

**■ 그래프 관련 동작 구조**

| **구분** | **그래프 ID**       | **설명**                                  | **트리거 변수**       |
| :------- | :------------------ | :---------------------------------------- | :-------------------- |
| **G301** | Graph_Control_Main  | 그래프 활성화 여부 제어                   | GraphOn               |
| **G302** | Graph_Global_Update | 통화·환율 변경 시 전체 그래프 데이터 갱신 | Dal2Won, Currency\_\* |
| **G303** | Graph_Reset         | EE_On=0일 때 모든 그래프 초기화 및 비표시 | EE_On                 |

---

**📘 탭 설명 요약**

- 본 탭은 경제성 평가 기능의 **기준 환경 설정 영역**으로,\
  이후 모든 설비 CAPEX 입력 탭의 금액 단위와 환율 환산 로직이 이 탭에 의해 결정됩니다.
- GraphOn, EE_On은 전체 프로그램 동작 여부 및 결과 표시 여부를 제어하는 **전역 스위치 역할**을 합니다.
- Dal2Won과 각 Currency\_\* 변수는 모든 계산식에서 참조되며,\
  다른 탭의 수치형 입력값에 대한 실시간 환산 기능을 제공합니다.

---

---

**⚙️ [화면 ID : 7-2] 급전 설비 비용 탭**

**■ 입력 변수 리스트 (FULL SPEC)**

| **변수명**     | **설명**                                | **단위** | **형식** | **기본값** | **최소값** | **최대값** | **선택 항목 / 조건**    |
| :------------- | :-------------------------------------- | :------- | :------- | :--------- | :--------- | :--------- | :---------------------- |
| **Cont_Po**    | 계약 전력량 (Contract Power)            | kW       | Number   | 500        | 0          | -          | 기본 계약 전력 입력     |
| **Basic_ChR**  | 기본 요금 단가 (Basic Charge Rate)      | kW       | Number   | 7000       | 0          | -          | 단위당 요금 (원/kW)     |
| **Use_ChR**    | 사용 요금 단가 (Usage Charge Rate)      | 원/kW    | Number   | 100        | 0          | -          | 추가 사용량에 따른 요금 |
| **FuHrPerDay** | 1일 운전시간 (Full Load Hour per Day)   | hr       | Number   | 16         | 0          | -          | 하루 운전 시간          |
| **FuDayPerYr** | 연간 운전일수 (Full Load Days per Year) | day      | Number   | 365        | 0          | 365        | 1년 기준 운전일수       |

**▪ 사례별 전력 용량 및 비용**

| **변수명**                 | **설명**            | **단위** | **형식** | **기본값** | **최소값** | **최대값** | **조건 / 설명** |
| :------------------------- | :------------------ | :------- | :------- | :--------- | :--------- | :--------- | :-------------- |
| **x1_Elec**                | 사례 1 전력 용량    | bhp      | Number   | 15         | 0          | -          | 사례 1 시나리오 |
| **x2_Elec**                | 사례 2 전력 용량    | bhp      | Number   | 205        | 0          | -          | 사례 2 시나리오 |
| **x3_Elec**                | 사례 3 전력 용량    | bhp      | Number   | 800        | 0          | -          | 사례 3 시나리오 |
| **x4_Elec** ~ **x15_Elec** | 사례 4~15 전력 용량 | bhp      | Number   | 0          | 0          | -          | 선택적 입력     |
| **y1_Elec**                | 사례 1 설비비       | $        | Number   | 21000      | 0          | -          | x1_Elec 대응    |
| **y2_Elec**                | 사례 2 설비비       | $        | Number   | 29500      | 0          | -          | x2_Elec 대응    |
| **y3_Elec**                | 사례 3 설비비       | $        | Number   | 54500      | 0          | -          | x3_Elec 대응    |
| **y4_Elec** ~ **y15_Elec** | 사례 4~15 설비비    | $        | Number   | 0          | 0          | -          | 선택적 입력     |

---

**■ 요구 기능 리스트 (Functional Requirements)**

| **기능 ID** | **기능명**       | **기능 설명**                                                                   |
| :---------- | :--------------- | :------------------------------------------------------------------------------ |
| **F401**    | 입력 필드 구성   | x₁~x₁₅, y₁~y₁₅ 세트 필드 자동 생성                                              |
| **F402**    | 단위 표시        | 좌측 컬럼 단위는 bhp, 우측 컬럼은 $ 단위 표시                                   |
| **F403**    | 기본값 자동 로드 | 초기 진입 시 x₁~x₁₅, y₁~y₁₅ 기본값 자동 로드                                    |
| **F404**    | 단위 연동        | Currency_Elec(기본정보 탭) 값이 “₩”일 경우, yₙ_Elec 단위 자동 변경 및 환율 반영 |
| **F405**    | 환율 반영 계산   | Currency_Elec = “$”인 경우 → yₙ_Elec × Dal2Won으로 내부 원화 환산               |
| **F406**    | 입력 검증        | 음수, NaN, 공란 입력 시 오류 메시지 출력 및 저장 불가 처리                      |
| **F407**    | 평균 단가 계산   | xₙ, yₙ 값 기준 단위당 설비비(원/bhp) 산출 및 표시                               |
| **F408**    | 실시간 업데이트  | 입력 변경 시 실시간 그래프 데이터 업데이트 트리거                               |
| **F409**    | 데이터 자동 저장 | 입력 완료 후 자동 저장                                                          |
| **F410**    | 데이터 초기화    | “초기화” 버튼 선택 시 기본값으로 리셋 및 그래프 초기화                          |
| **F411**    | 데이터 동기화    | EE_On=0일 경우 전체 입력 필드 비활성화 및 회색 처리                             |
| **F412**    | 스크롤 컨트롤    | 15개 사례가 모두 표시될 수 있도록 세로 스크롤바 구성                            |

---

**■ 그래프 관련 기능 (Graph Behavior)**

| **그래프 ID** | **설명**                    | **트리거 변수**                                   | **그래프 형식**     | **세부 기능**                              |
| :------------ | :-------------------------- | :------------------------------------------------ | :------------------ | :----------------------------------------- |
| **G401**      | 급전 설비비용 산점도 그래프 | xₙ_Elec, yₙ_Elec                                  | 2D Scatter          | x축: 전력 용량(bhp), y축: 설비비($ 또는 ₩) |
| **G402**      | 실시간 갱신                 | 입력값 변경 시 자동 업데이트                      | Scatter 실시간 반영 | 그래프On=1일 때만 작동                     |
| **G403**      | 환율 연동                   | Dal2Won, Currency_Elec 변경 시 전체 데이터 재계산 | 자동 스케일링       | 원화 환산시 축 단위 자동 변경              |
| **G404**      | 그래프 표시 제어            | GraphOn=0일 경우 그래프 캔버스 숨김 처리          | Boolean             | 그래프 영역 비활성화                       |

---

**📘 탭 설명 요약**

- 이 탭은 수소충전소 **전력 인입 설비 및 급전 계통의 초기 투자비**를 정의합니다.
- 입력값은 전력 용량(bhp)과 설비비($ 또는 ₩)의 관계를 구성하며,\
  최대 15개 사례 입력이 가능해 회귀분석 기반 CAPEX 산출에 활용됩니다.
- Currency_Elec과 Dal2Won 값은 [7-1 기본정보 탭]의 설정을 참조합니다.
- GraphOn=1 설정 시 실시간 2D 산점도로 비용곡선을 표시합니다.

---

---

**⚙️ [화면 ID : 7-3] 액화수소 탱크 비용 탭**

**■ 입력 변수 리스트 (FULL SPEC)**

**▪ 사례별 탱크 용량 및 비용 입력**

| **변수명**                 | **설명**            | **단위** | **형식** | **기본값** | **최소값** | **최대값** | **조건 / 설명** |
| :------------------------- | :------------------ | :------- | :------- | :--------- | :--------- | :--------- | :-------------- |
| **x1_LqTk**                | 사례 1 탱크 용량    | m³       | Number   | 20         | 0          | -          | 1번 사례        |
| **x2_LqTk**                | 사례 2 탱크 용량    | m³       | Number   | 30         | 0          | -          | 2번 사례        |
| **x3_LqTk**                | 사례 3 탱크 용량    | m³       | Number   | 50         | 0          | -          | 3번 사례        |
| **x4_LqTk** ~ **x15_LqTk** | 사례 4~15 탱크 용량 | m³       | Number   | 0          | 0          | -          | 선택적 입력     |
| **y1_LqTk**                | 사례 1 설비비       | $        | Number   | 85000      | 0          | -          | x1_LqTk 대응    |
| **y2_LqTk**                | 사례 2 설비비       | $        | Number   | 95000      | 0          | -          | x2_LqTk 대응    |
| **y3_LqTk**                | 사례 3 설비비       | $        | Number   | 120000     | 0          | -          | x3_LqTk 대응    |
| **y4_LqTk** ~ **y15_LqTk** | 사례 4~15 설비비    | $        | Number   | 0          | 0          | -          | 선택적 입력     |

---

**■ 요구 기능 리스트 (Functional Requirements)**

| **기능 ID** | **기능명**       | **기능 설명**                                               |
| :---------- | :--------------- | :---------------------------------------------------------- |
| **F501**    | 입력 필드 구성   | x₁~x₁₅, y₁~y₁₅ 세트 필드 자동 생성                          |
| **F502**    | 기본값 자동 로드 | 초기 로딩 시 x₁~x₁₅, y₁~y₁₅ 기본값 자동 설정                |
| **F503**    | 단위 표시        | 좌측 컬럼 단위 = m³, 우측 컬럼 단위 = $                     |
| **F504**    | 단위 연동        | Currency_LqTk 값이 “₩”일 경우 단위 자동 변경 및 환율 반영   |
| **F505**    | 환율 반영 계산   | Currency_LqTk = “$”일 경우 yₙ_LqTk × Dal2Won 으로 원화 환산 |
| **F506**    | 입력 검증        | 음수, 비어 있음, 비정상 단위 입력 시 경고창 및 저장 불가    |
| **F507**    | 평균 단가 계산   | xₙ, yₙ 입력값 기준 단위당 설비비(원/m³) 산출                |
| **F508**    | 실시간 갱신      | 값 변경 시 그래프 데이터 즉시 업데이트                      |
| **F509**    | 데이터 자동 저장 |                                                             |
| **F510**    | 초기화 기능      | “초기화” 버튼 클릭 시 모든 입력 필드 기본값으로 복귀        |
| **F511**    | 탭 비활성화 제어 | EE_On=0일 경우 입력 필드 전체 비활성화 처리                 |

---

**■ 그래프 관련 기능 (Graph Behavior)**

| **그래프 ID** | **설명**                   | **트리거 변수**                              | **그래프 형식**     | **세부 기능**                        |
| :------------ | :------------------------- | :------------------------------------------- | :------------------ | :----------------------------------- |
| **G501**      | 탱크 용량–비용 관계 그래프 | xₙ_LqTk, yₙ_LqTk                             | 2D Scatter          | x축: 용량(m³), y축: 설비비($ 또는 ₩) |
| **G502**      | 실시간 갱신                | 입력값 변경 시 그래프 자동 업데이트          | Scatter 실시간 반영 | GraphOn=1일 경우 활성                |
| **G503**      | 환율 연동                  | Dal2Won, Currency_LqTk 변경 시 스케일 재계산 | 축 단위 자동 변경   |                                      |
| **G504**      | 그래프 표시 제어           | GraphOn=0일 경우 그래프 영역 숨김 처리       | Boolean             |                                      |

---

**📘 탭 설명 요약**

- 이 탭은 수소충전소의 \*\*액화수소 저장탱크 설비비(CAPEX)\*\*를 구성하는 입력 구간입니다.
- 최대 15개 용량–비용 데이터를 입력해 **탱크 용량–비용 관계 곡선**을 구성합니다.
- 입력값은 Currency_LqTk, Dal2Won 값을 참조하며, 그래프는 실시간으로 이를 반영합니다.

---

---

**⚙️ [화면 ID : 7-4] 액화수소 펌프 비용 탭**

---

**■ 입력 변수 리스트 (FULL SPEC)**

**▪ 사례별 펌프 유량 및 비용 입력**

| **변수명**                 | **설명**         | **단위** | **형식** | **기본값** | **최소값** | **최대값** | **조건 / 설명** |
| :------------------------- | :--------------- | :------- | :------- | :--------- | :--------- | :--------- | :-------------- |
| **x1_LqPp**                | 사례 1 유량      | kg/h     | Number   | 100        | 0          | -          | 사례 1 시나리오 |
| **x2_LqPp**                | 사례 2 유량      | kg/h     | Number   | 200        | 0          | -          | 사례 2 시나리오 |
| **x3_LqPp** ~ **x15_LqPp** | 사례 3~15 유량   | kg/h     | Number   | 0          | 0          | -          | 선택적 입력     |
| **y1_LqPp**                | 사례 1 설비비    | 천$      | Number   | 68\.28     | 0          | -          | x1_LqPp 대응    |
| **y2_LqPp**                | 사례 2 설비비    | 천$      | Number   | 124\.99    | 0          | -          | x2_LqPp 대응    |
| **y3_LqPp** ~ **y15_LqPp** | 사례 3~15 설비비 | 천$      | Number   | 0          | 0          | -          | 선택적 입력     |

---

**■ 요구 기능 리스트 (Functional Requirements)**

| **기능 ID** | **기능명**            | **기능 설명**                                                     |
| :---------- | :-------------------- | :---------------------------------------------------------------- |
| **F601**    | 입력 필드 구성        | x₁~x₁₅, y₁~y₁₅ 세트 필드 자동 생성                                |
| **F602**    | 기본값 자동 로드      | 초기 로딩 시 x₁~x₁₅, y₁~y₁₅ 모든 기본값 자동 설정                 |
| **F603**    | 단위 표시             | 좌측 컬럼 단위 = kg/h, 우측 컬럼 단위 = 천$                       |
| **F604**    | 단위 연동             | Currency_LqPp 값이 “₩”일 경우 단위 자동 변경 및 환율 반영         |
| **F605**    | 환율 반영 계산        | Currency_LqPp = “$”일 경우 yₙ_LqPp × Dal2Won × 1000으로 원화 환산 |
| **F606**    | 입력 검증             | 음수, 비어 있음, 비정상 단위 입력 시 오류 및 저장 차단            |
| **F607**    | 평균 단가 계산        | xₙ, yₙ 입력값 기준 단위당 설비비(원/kg/h) 산출                    |
| **F608**    | 실시간 갱신           | 값 변경 시 그래프 즉시 업데이트 트리거 발생                       |
| **F609**    | 데이터 자동 저장      |                                                                   |
| **F610**    | 초기화 기능           | “초기화” 버튼 클릭 시 모든 입력값을 기본값으로 복귀               |
| **F611**    | 비활성화 제어         | EE_On=0일 경우 모든 필드 비활성화 (입력 차단)                     |
| **F612**    | 데이터 표시 단위 제어 | 천$ → 원화 전환 시, 자동으로 "백만원" 단위 표기 전환              |

---

**■ 그래프 관련 기능 (Graph Behavior)**

| **그래프 ID** | **설명**                   | **트리거 변수**                                       | **그래프 형식**     | **세부 기능**                                 |
| :------------ | :------------------------- | :---------------------------------------------------- | :------------------ | :-------------------------------------------- |
| **G601**      | 펌프 유량–비용 관계 그래프 | xₙ_LqPp, yₙ_LqPp                                      | 2D Scatter          | x축: 유량(kg/h), y축: 설비비(천$ 또는 백만원) |
| **G602**      | 실시간 갱신                | 입력값 변경 시 자동 업데이트                          | Scatter 실시간 반영 | GraphOn=1일 경우 활성                         |
| **G603**      | 환율 연동                  | Dal2Won, Currency_LqPp 변경 시 축 단위 자동 조정      | 스케일링 적용       |                                               |
| **G604**      | 그래프 표시 제어           | GraphOn=0일 경우 그래프 캔버스 숨김 처리              | Boolean             |                                               |
| **G605**      | 곡선 근사화                | 15개 데이터 기반 최소자승법 곡선 회귀 (비용곡선 표시) | 자동 연산           |                                               |

---

**📘 탭 설명 요약**

- 본 탭은 수소충전소 내 **액화수소 펌프 설비비(CAPEX)** 산출을 위한 입력 탭입니다.
- 최대 15개 시나리오를 비교할 수 있습니다.
- 입력값은 Currency_LqPp, Dal2Won을 참조해 실시간 환산됩니다.
- 그래프는 **유량–설비비 관계를 시각화**하며, 데이터 기반 곡선 근사(회귀선)를 함께 표시합니다.

---

---

**⚙️ [화면 ID : 7-5] 액화수소 기화기 비용 탭 (Liquid Hydrogen Vaporizer Cost Tab)**

---

**■ 입력 변수 리스트 (FULL SPEC)**

| **변수명**               | **설명**         | **단위** | **형식** | **기본값** | **최소값** | **최대값** | **조건 / 설명** |
| :----------------------- | :--------------- | :------- | :------- | :--------- | :--------- | :--------- | :-------------- |
| **x1_Vap**               | 사례 1 유량      | kg/h     | Number   | 100        | 0          | -          | 1번 사례        |
| **x2_Vap**               | 사례 2 유량      | kg/h     | Number   | 200        | 0          | -          | 2번 사례        |
| **x3_Vap** ~ **x15_Vap** | 사례 3~15 유량   | kg/h     | Number   | 0          | 0          | -          | 선택적 입력     |
| **y1_Vap**               | 사례 1 설비비    | 천$      | Number   | 92\.48     | 0          | -          | x1_Vap 대응     |
| **y2_Vap**               | 사례 2 설비비    | 천$      | Number   | 182\.57    | 0          | -          | x2_Vap 대응     |
| **y3_Vap** ~ **y15_Vap** | 사례 3~15 설비비 | 천$      | Number   | 0          | 0          | -          | 선택적 입력     |

---

**■ 요구 기능 리스트 (Functional Requirements)**

| **기능 ID** | **기능명**         | **기능 설명**                                                   |
| :---------- | :----------------- | :-------------------------------------------------------------- |
| **F701**    | 입력 필드 구성     | x₁~x₁₅, y₁~y₁₅ 세트 필드 자동 생성                              |
| **F702**    | 기본값 자동 로드   | 초기 로딩 시 x₁~x₁₅, y₁~y₁₅ 모든 기본값 자동 설정               |
| **F703**    | 단위 표시          | 좌측 컬럼 단위 = kg/h, 우측 컬럼 단위 = 천$                     |
| **F704**    | 단위 연동          | Currency_Vap 값이 “₩”일 경우 단위 자동 변경 및 환율 반영        |
| **F705**    | 환율 반영 계산     | Currency_Vap = “$”일 경우 yₙ_Vap × Dal2Won × 1000으로 원화 환산 |
| **F706**    | 입력 검증          | 음수, 비정상 단위, 비어 있음 입력 시 오류 메시지 및 저장 차단   |
| **F707**    | 평균 단가 계산     | xₙ, yₙ 입력값 기준 단위당 설비비(원/kg/h) 산출                  |
| **F708**    | 실시간 그래프 갱신 | 값 변경 시 자동으로 그래프 데이터 업데이트                      |
| **F709**    | 데이터 자동 저장   |                                                                 |
| **F710**    | 초기화 기능        | “초기화” 버튼 클릭 시 모든 값 기본값으로 복귀                   |
| **F711**    | 비활성화 제어      | EE_On=0일 경우 모든 필드 비활성화 및 입력 차단                  |
| **F712**    | 그래프 연동 확인   | GraphOn=0일 때 그래프 숨김 처리, On일 때 즉시 표시              |

---

**■ 그래프 관련 기능 (Graph Behavior)**

| **그래프 ID** | **설명**                     | **트리거 변수**                                    | **그래프 형식**     | **세부 기능**                                 |
| :------------ | :--------------------------- | :------------------------------------------------- | :------------------ | :-------------------------------------------- |
| **G701**      | 기화기 유량–비용 관계 그래프 | xₙ_Vap, yₙ_Vap                                     | 2D Scatter          | x축: 유량(kg/h), y축: 설비비(천$ 또는 백만원) |
| **G702**      | 실시간 갱신                  | 입력값 변경 시 그래프 자동 업데이트                | Scatter 실시간 반영 | GraphOn=1일 경우 활성                         |
| **G703**      | 환율 연동                    | Dal2Won, Currency_Vap 변경 시 스케일 재계산        | 축 단위 자동 변경   |                                               |
| **G704**      | 그래프 표시 제어             | GraphOn=0일 경우 그래프 캔버스 숨김 처리           | Boolean             |                                               |
| **G705**      | 곡선 근사화                  | 15개 입력데이터 기반 최소자승법 회귀곡선 자동 생성 | 실시간 계산         |                                               |

---

**📘 탭 설명 요약**

- 본 탭은 \*\*액화수소 기화기(LH₂ Vaporizer)\*\*의 설비비(CAPEX)를 구성하기 위한 입력 탭입니다.
- 각 기화기 용량(kg/h)에 따른 설비비(천$)를 최대 15개 사례로 입력할 수 있습니다.
- 단위는 Currency_Vap, Dal2Won 설정에 따라 자동 전환되며, 입력값 변경 시 실시간 반영됩니다.
- 그래프는 유량–비용의 산점도 및 회귀선을 표시하여 비용 추정식을 시각적으로 확인할 수 있습니다.

---

---

**⚙️ [화면 ID : 7-6] 압축기 비용 탭**

**■ 입력 변수 리스트 (FULL SPEC)**

| **변수명**             | **설명**         | **단위** | **형식** | **기본값** | **최소값** | **최대값** | **조건 / 설명** |
| :--------------------- | :--------------- | :------- | :------- | :--------- | :--------- | :--------- | :-------------- |
| **x1_Cp**              | 사례 1 유량      | kg/h     | Number   | 40         | 0          | -          | 1번 사례        |
| **x2_Cp**              | 사례 2 유량      | kg/h     | Number   | 30\.5      | 0          | -          | 2번 사례        |
| **x3_Cp**              | 사례 3 유량      | kg/h     | Number   | 208\.5     | 0          | -          | 3번 사례        |
| **x4_Cp**              | 사례 4 유량      | kg/h     | Number   | 118\.2     | 0          | -          | 4번 사례        |
| **x5_Cp**              | 사례 5 유량      | kg/h     | Number   | 126\.5     | 0          | -          | 5번 사례        |
| **x6_Cp**              | 사례 6 유량      | kg/h     | Number   | 132\.3     | 0          | -          | 6번 사례        |
| **x7_Cp** ~ **x15_Cp** | 사례 7~15 유량   | kg/h     | Number   | 0          | 0          | -          | 선택적 입력     |
| **y1_Cp**              | 사례 1 설비비    | 백만원   | Number   | 670        | 0          | -          | x1_Cp 대응      |
| **y2_Cp**              | 사례 2 설비비    | 백만원   | Number   | 500        | 0          | -          | x2_Cp 대응      |
| **y3_Cp**              | 사례 3 설비비    | 백만원   | Number   | 1865\.5    | 0          | -          | x3_Cp 대응      |
| **y4_Cp**              | 사례 4 설비비    | 백만원   | Number   | 670        | 0          | -          | x4_Cp 대응      |
| **y5_Cp**              | 사례 5 설비비    | 백만원   | Number   | 670        | 0          | -          | x5_Cp 대응      |
| **y6_Cp**              | 사례 6 설비비    | 백만원   | Number   | 1200       | 0          | -          | x6_Cp 대응      |
| **y7_Cp** ~ **y15_Cp** | 사례 7~15 설비비 | 백만원   | Number   | 0          | 0          | -          | 선택적 입력     |

---

**■ 요구 기능 리스트 (Functional Requirements)**

| **기능 ID** | **기능명**         | **기능 설명**                                                   |
| :---------- | :----------------- | :-------------------------------------------------------------- |
| **F801**    | 입력 필드 구성     | x₁~x₁₅, y₁~y₁₅ 세트 필드 자동 생성                              |
| **F802**    | 기본값 자동 로드   | 초기 로딩 시 x₁~x₁₅, y₁~y₁₅ 기본값 자동 설정                    |
| **F803**    | 단위 표시          | 좌측 컬럼 단위 = kg/h, 우측 컬럼 단위 = 백만원                  |
| **F804**    | 단위 연동          | Currency_Cp 값이 “$”일 경우 단위 자동 변경 및 환율 반영         |
| **F805**    | 환율 반영 계산     | Currency_Cp = “$”일 경우 yₙ_Cp × Dal2Won × 10000 으로 원화 환산 |
| **F806**    | 입력 검증          | 음수, 비정상 단위, 비어 있음 입력 시 오류 메시지 및 저장 차단   |
| **F807**    | 평균 단가 계산     | xₙ, yₙ 입력값 기준 단위당 설비비(원/kg/h) 산출                  |
| **F808**    | 실시간 그래프 갱신 | 값 변경 시 그래프 데이터 자동 업데이트                          |
| **F809**    | 데이터 자동 저장   |                                                                 |
| **F810**    | 초기화 기능        | “초기화” 버튼 클릭 시 모든 입력 필드 기본값으로 복귀            |
| **F811**    | 비활성화 제어      | EE_On=0일 경우 모든 필드 비활성화 처리                          |
| **F812**    | 그래프 연동 제어   | GraphOn=0일 때 그래프 숨김 처리, GraphOn=1일 때 표시            |
| **F813**    | 데이터 유효성 검사 | 동일한 xₙ 입력값이 중복될 경우 경고창 출력 및 저장 차단         |

---

**■ 그래프 관련 기능 (Graph Behavior)**

| **그래프 ID** | **설명**                     | **트리거 변수**                                | **그래프 형식**     | **세부 기능**                                 |
| :------------ | :--------------------------- | :--------------------------------------------- | :------------------ | :-------------------------------------------- |
| **G801**      | 압축기 유량–비용 관계 그래프 | xₙ_Cp, yₙ_Cp                                   | 2D Scatter          | x축: 유량(kg/h), y축: 설비비(백만원 또는 천$) |
| **G802**      | 실시간 갱신                  | 입력값 변경 시 그래프 자동 업데이트            | Scatter 실시간 반영 | GraphOn=1일 경우 활성                         |
| **G803**      | 환율 연동                    | Dal2Won, Currency_Cp 변경 시 축 단위 자동 조정 | 스케일 재계산       |                                               |
| **G804**      | 그래프 표시 제어             | GraphOn=0일 경우 그래프 캔버스 숨김 처리       | Boolean             |                                               |
| **G805**      | 곡선 근사화                  | 15개 데이터 기반 최소자승법 회귀곡선 표시      | 자동 연산           |                                               |

---

**📘 탭 설명 요약**

- 본 탭은 수소충전소 **압축기 설비비(CAPEX)** 산출을 위한 입력 탭입니다.
- 각 사례별 유량–비용 관계를 최대 15개까지 입력할 수 있으며,\
  Currency_Cp 및 Dal2Won 설정을 실시간 반영합니다.
- GraphOn 설정 시 실시간으로 회귀곡선이 표시되며,\
  이를 통해 압축기 용량 대비 설비비 추세를 시각적으로 확인할 수 있습니다.

---

---

**⚙️ [화면 ID : 7-7] 저압 뱅크 및 버퍼 비용 탭**

**■ 입력 변수 리스트 (FULL SPEC)**

| **변수명**               | **설명**         | **단위** | **형식** | **기본값** | **최소값** | **최대값** | **조건 / 설명** |
| :----------------------- | :--------------- | :------- | :------- | :--------- | :--------- | :--------- | :-------------- |
| **x1_LBk**               | 사례 1 용량      | kg       | Number   | 139        | 0          | -          | 1번 사례        |
| **x2_LBk**               | 사례 2 용량      | kg       | Number   | 93         | 0          | -          | 2번 사례        |
| **x3_LBk**               | 사례 3 용량      | kg       | Number   | 139        | 0          | -          | 3번 사례        |
| **x4_LBk**               | 사례 4 용량      | kg       | Number   | 205        | 0          | -          | 4번 사례        |
| **x5_LBk**               | 사례 5 용량      | kg       | Number   | 93         | 0          | -          | 5번 사례        |
| **x6_LBk**               | 사례 6 용량      | kg       | Number   | 172        | 0          | -          | 6번 사례        |
| **x7_LBk**               | 사례 7 용량      | kg       | Number   | 173        | 0          | -          | 7번 사례        |
| **x8_LBk** ~ **x15_LBk** | 사례 8~15 용량   | kg       | Number   | 0          | 0          | -          | 선택적 입력     |
| **y1_LBk**               | 사례 1 설비비    | 백만원   | Number   | 160        | 0          | -          | x1_LBk 대응     |
| **y2_LBk**               | 사례 2 설비비    | 백만원   | Number   | 150        | 0          | -          | x2_LBk 대응     |
| **y3_LBk**               | 사례 3 설비비    | 백만원   | Number   | 160        | 0          | -          | x3_LBk 대응     |
| **y4_LBk**               | 사례 4 설비비    | 백만원   | Number   | 313        | 0          | -          | x4_LBk 대응     |
| **y5_LBk**               | 사례 5 설비비    | 백만원   | Number   | 150        | 0          | -          | x5_LBk 대응     |
| **y6_LBk**               | 사례 6 설비비    | 백만원   | Number   | 240        | 0          | -          | x6_LBk 대응     |
| **y7_LBk**               | 사례 7 설비비    | 백만원   | Number   | 240        | 0          | -          | x7_LBk 대응     |
| **y8_LBk** ~ **y15_LBk** | 사례 8~15 설비비 | 백만원   | Number   | 0          | 0          | -          | 선택적 입력     |

---

**■ 요구 기능 리스트 (Functional Requirements)**

| **기능 ID** | **기능명**         | **기능 설명**                                                     |
| :---------- | :----------------- | :---------------------------------------------------------------- |
| **F901**    | 입력 필드 구성     | x₁~x₁₅, y₁~y₁₅ 세트 필드 자동 생성                                |
| **F902**    | 기본값 자동 로드   | 초기 로딩 시 x₁~x₁₅, y₁~y₁₅ 기본값 자동 설정                      |
| **F903**    | 단위 표시          | 좌측 컬럼 단위 = kg, 우측 컬럼 단위 = 백만원                      |
| **F904**    | 단위 연동          | Currency_LBk 값이 “$”일 경우 단위 자동 변경 및 환율 반영          |
| **F905**    | 환율 반영 계산     | Currency_LBk = “$”일 경우 yₙ_LBk × Dal2Won × 10000 으로 원화 환산 |
| **F906**    | 입력 검증          | 음수, 비정상 단위, 비어 있음 입력 시 오류 메시지 및 저장 차단     |
| **F907**    | 평균 단가 계산     | xₙ, yₙ 입력값 기준 단위당 설비비(원/kg) 산출                      |
| **F908**    | 실시간 그래프 갱신 | 값 변경 시 자동으로 그래프 업데이트                               |
| **F909**    | 데이터 자동 저장   |                                                                   |
| **F910**    | 초기화 기능        | “초기화” 버튼 클릭 시 모든 값 기본값으로 복귀                     |
| **F911**    | 비활성화 제어      | EE_On=0일 경우 모든 필드 비활성화                                 |
| **F912**    | 그래프 연동 제어   | GraphOn=0일 경우 그래프 숨김 처리, GraphOn=1일 경우 표시          |
| **F913**    | 데이터 중복 검증   | 동일한 xₙ 값 중복 시 경고창 및 저장 차단                          |

---

**■ 그래프 관련 기능 (Graph Behavior)**

| **그래프 ID** | **설명**                        | **트리거 변수**                                 | **그래프 형식**     | **세부 기능**                               |
| :------------ | :------------------------------ | :---------------------------------------------- | :------------------ | :------------------------------------------ |
| **G901**      | 저압 뱅크 용량–비용 관계 그래프 | xₙ_LBk, yₙ_LBk                                  | 2D Scatter          | x축: 용량(kg), y축: 설비비(백만원 또는 천$) |
| **G902**      | 실시간 갱신                     | 입력값 변경 시 그래프 자동 업데이트             | Scatter 실시간 반영 | GraphOn=1일 경우 활성                       |
| **G903**      | 환율 연동                       | Dal2Won, Currency_LBk 변경 시 축 단위 자동 조정 | 스케일 재계산       |                                             |
| **G904**      | 그래프 표시 제어                | GraphOn=0일 경우 그래프 캔버스 숨김 처리        | Boolean             |                                             |
| **G905**      | 곡선 근사화                     | 15개 입력데이터 기반 최소자승법 회귀곡선 표시   | 자동 연산           |                                             |

---

**📘 탭 설명 요약**

- 본 탭은 수소충전소의 **저압 저장 뱅크 및 버퍼 탱크 CAPEX 산출**을 위한 입력 구간입니다.
- 최대 15개 용량–비용 데이터를 입력할 수 있으며, Currency_LBk, Dal2Won 설정을 자동 반영합니다.
- GraphOn 설정 시 입력값 변경에 따라 즉시 산점도 및 근사곡선이 표시됩니다.

---

---

**⚙️ [화면 ID : 7-8] 고압 뱅크 비용 탭**

**■ 입력 변수 리스트 (FULL SPEC)**

| **변수명**               | **설명**         | **단위** | **형식** | **기본값** | **최소값** | **최대값** | **조건 / 설명** |
| :----------------------- | :--------------- | :------- | :------- | :--------- | :--------- | :--------- | :-------------- |
| **x1_HBk**               | 사례 1 용량      | kg       | Number   | 91         | 0          | -          | 1번 사례        |
| **x2_HBk**               | 사례 2 용량      | kg       | Number   | 120        | 0          | -          | 2번 사례        |
| **x3_HBk**               | 사례 3 용량      | kg       | Number   | 67         | 0          | -          | 3번 사례        |
| **x4_HBk**               | 사례 4 용량      | kg       | Number   | 25         | 0          | -          | 4번 사례        |
| **x5_HBk**               | 사례 5 용량      | kg       | Number   | 157        | 0          | -          | 5번 사례        |
| **x6_HBk**               | 사례 6 용량      | kg       | Number   | 136        | 0          | -          | 6번 사례        |
| **x7_HBk**               | 사례 7 용량      | kg       | Number   | 126        | 0          | -          | 7번 사례        |
| **x8_HBk**               | 사례 8 용량      | kg       | Number   | 128        | 0          | -          | 8번 사례        |
| **x9_HBk** ~ **x15_HBk** | 사례 9~15 용량   | kg       | Number   | 0          | 0          | -          | 선택적 입력     |
| **y1_HBk**               | 사례 1 설비비    | 백만원   | Number   | 236        | 0          | -          | x1_HBk 대응     |
| **y2_HBk**               | 사례 2 설비비    | 백만원   | Number   | 356        | 0          | -          | x2_HBk 대응     |
| **y3_HBk**               | 사례 3 설비비    | 백만원   | Number   | 196        | 0          | -          | x3_HBk 대응     |
| **y4_HBk**               | 사례 4 설비비    | 백만원   | Number   | 68         | 0          | -          | x4_HBk 대응     |
| **y5_HBk**               | 사례 5 설비비    | 백만원   | Number   | 480        | 0          | -          | x5_HBk 대응     |
| **y6_HBk**               | 사례 6 설비비    | 백만원   | Number   | 400        | 0          | -          | x6_HBk 대응     |
| **y7_HBk**               | 사례 7 설비비    | 백만원   | Number   | 400        | 0          | -          | x7_HBk 대응     |
| **y8_HBk**               | 사례 8 설비비    | 백만원   | Number   | 400        | 0          | -          | x8_HBk 대응     |
| **y9_HBk** ~ **y15_HBk** | 사례 9~15 설비비 | 백만원   | Number   | 0          | 0          | -          | 선택적 입력     |

---

**■ 요구 기능 리스트 (Functional Requirements)**

| **기능 ID** | **기능명**         | **기능 설명**                                                      |
| :---------- | :----------------- | :----------------------------------------------------------------- |
| **F1001**   | 입력 필드 구성     | x₁~x₁₅, y₁~y₁₅ 세트 필드 자동 생성                                 |
| **F1002**   | 기본값 자동 로드   | 초기 로딩 시 x₁~x₁₅, y₁~y₁₅ 기본값 자동 설정                       |
| **F1003**   | 단위 표시          | 좌측 컬럼 단위 = kg, 우측 컬럼 단위 = 백만원                       |
| **F1004**   | 단위 연동          | Currency_HBk 값이 “$”일 경우 단위 자동 변경 및 환율 반영           |
| **F1005**   | 환율 반영 계산     | Currency_HBk = “$”일 경우 yₙ_HBk × Dal2Won × 10000 으로 원화 환산  |
| **F1006**   | 입력 검증          | 음수, 비정상 단위, 비어 있음 입력 시 오류 메시지 및 저장 차단      |
| **F1007**   | 평균 단가 계산     | xₙ, yₙ 입력값 기준 단위당 설비비(원/kg) 산출                       |
| **F1008**   | 실시간 그래프 갱신 | 값 변경 시 자동으로 그래프 데이터 업데이트                         |
| **F1009**   | 데이터 자동 저장   |                                                                    |
| **F1010**   | 초기화 기능        | “초기화” 버튼 클릭 시 모든 값 기본값으로 복귀                      |
| **F1011**   | 비활성화 제어      | EE_On=0일 경우 모든 필드 비활성화                                  |
| **F1012**   | 그래프 연동 제어   | GraphOn=0일 경우 그래프 숨김 처리, GraphOn=1일 경우 표시           |
| **F1013**   | 데이터 중복 검증   | 동일한 xₙ 값 중복 시 경고창 출력 및 저장 차단                      |
| **F1014**   | 설비 그룹 반영     | 입력값 변경 시 CAPEX 계산 모듈 내 고압뱅크 그룹 항목 자동 업데이트 |

---

**■ 그래프 관련 기능 (Graph Behavior)**

| **그래프 ID** | **설명**                        | **트리거 변수**                                         | **그래프 형식**     | **세부 기능**                               |
| :------------ | :------------------------------ | :------------------------------------------------------ | :------------------ | :------------------------------------------ |
| **G1001**     | 고압 뱅크 용량–비용 관계 그래프 | xₙ_HBk, yₙ_HBk                                          | 2D Scatter          | x축: 용량(kg), y축: 설비비(백만원 또는 천$) |
| **G1002**     | 실시간 갱신                     | 입력값 변경 시 그래프 자동 업데이트                     | Scatter 실시간 반영 | GraphOn=1일 경우 활성                       |
| **G1003**     | 환율 연동                       | Dal2Won, Currency_HBk 변경 시 축 단위 자동 조정         | 스케일 재계산       |                                             |
| **G1004**     | 그래프 표시 제어                | GraphOn=0일 경우 그래프 캔버스 숨김 처리                | Boolean             |                                             |
| **G1005**     | 곡선 근사화                     | 15개 입력데이터 기반 최소자승법 회귀곡선 표시           | 자동 연산           |                                             |
| **G1006**     | 설비 그룹 반영                  | 그래프 데이터 변경 시 고압뱅크 CAPEX 총합 자동 업데이트 | 실시간 반영         |                                             |

---

**📘 탭 설명 요약**

- 본 탭은 수소충전소의 **고압 저장 뱅크 설비비(CAPEX)** 산출을 위한 입력 구간입니다.
- 최대 15개 용량–비용 데이터를 입력할 수 있으며,\
  Currency_HBk, Dal2Won 설정값에 따라 실시간 환율이 반영됩니다.
- 그래프는 입력값 변경 시 실시간으로 업데이트되며,\
  고압뱅크 CAPEX 계산 모듈에 자동 연동됩니다.

---

---

**⚙️ [화면 ID : 7-9] 수소충전기 비용 탭 (Hydrogen Dispenser Cost Tab)**

**■ 입력 변수 리스트 (FULL SPEC)**

| **변수명**                 | **설명**              | **단위** | **형식** | **기본값** | **최소값** | **최대값** | **조건 / 설명** |
| :------------------------- | :-------------------- | :------- | :------- | :--------- | :--------- | :--------- | :-------------- |
| **x1_Disp**                | 사례 1 충전기 수량    | ea       | Number   | 1          | 0          | -          | 1번 사례        |
| **x2_Disp**                | 사례 2 충전기 수량    | ea       | Number   | 1          | 0          | -          | 2번 사례        |
| **x3_Disp**                | 사례 3 충전기 수량    | ea       | Number   | 3          | 0          | -          | 3번 사례        |
| **x4_Disp**                | 사례 4 충전기 수량    | ea       | Number   | 1          | 0          | -          | 4번 사례        |
| **x5_Disp**                | 사례 5 충전기 수량    | ea       | Number   | 1          | 0          | -          | 5번 사례        |
| **x6_Disp**                | 사례 6 충전기 수량    | ea       | Number   | 1          | 0          | -          | 6번 사례        |
| **x7_Disp**                | 사례 7 충전기 수량    | ea       | Number   | 2          | 0          | -          | 7번 사례        |
| **x8_Disp**                | 사례 8 충전기 수량    | ea       | Number   | 2          | 0          | -          | 8번 사례        |
| **x9_Disp** ~ **x15_Disp** | 사례 9~15 충전기 수량 | ea       | Number   | 0          | 0          | -          | 선택적 입력     |
| **y1_Disp**                | 사례 1 설비비         | 백만원   | Number   | 295        | 0          | -          | x1_Disp 대응    |
| **y2_Disp**                | 사례 2 설비비         | 백만원   | Number   | 223        | 0          | -          | x2_Disp 대응    |
| **y3_Disp**                | 사례 3 설비비         | 백만원   | Number   | 316\.8     | 0          | -          | x3_Disp 대응    |
| **y4_Disp**                | 사례 4 설비비         | 백만원   | Number   | 189        | 0          | -          | x4_Disp 대응    |
| **y5_Disp**                | 사례 5 설비비         | 백만원   | Number   | 295        | 0          | -          | x5_Disp 대응    |
| **y6_Disp**                | 사례 6 설비비         | 백만원   | Number   | 180        | 0          | -          | x6_Disp 대응    |
| **y7_Disp**                | 사례 7 설비비         | 백만원   | Number   | 266\.5     | 0          | -          | x7_Disp 대응    |
| **y8_Disp**                | 사례 8 설비비         | 백만원   | Number   | 266\.5     | 0          | -          | x8_Disp 대응    |
| **y9_Disp** ~ **y15_Disp** | 사례 9~15 설비비      | 백만원   | Number   | 0          | 0          | -          | 선택적 입력     |

---

**■ 요구 기능 리스트 (Functional Requirements)**

| **기능 ID** | **기능명**         | **기능 설명**                                                       |
| :---------- | :----------------- | :------------------------------------------------------------------ |
| **F1101**   | 입력 필드 구성     | x₁~x₁₅, y₁~y₁₅ 세트 필드 자동 생성                                  |
| **F1102**   | 기본값 자동 로드   | 초기 로딩 시 x₁~x₁₅, y₁~y₁₅ 기본값 자동 설정                        |
| **F1103**   | 단위 표시          | 좌측 컬럼 단위 = ea, 우측 컬럼 단위 = 백만원                        |
| **F1104**   | 단위 연동          | Currency_Disp 값이 “$”일 경우 단위 자동 변경 및 환율 반영           |
| **F1105**   | 환율 반영 계산     | Currency_Disp = “$”일 경우 yₙ_Disp × Dal2Won × 10000 으로 원화 환산 |
| **F1106**   | 입력 검증          | 음수, 비정상 단위, 비어 있음 입력 시 오류 메시지 및 저장 차단       |
| **F1107**   | 평균 단가 계산     | xₙ, yₙ 입력값 기준 단위당 설비비(원/ea) 산출                        |
| **F1108**   | 실시간 그래프 갱신 | 값 변경 시 그래프 데이터 자동 업데이트                              |
| **F1109**   | 데이터 자동 저장   |                                                                     |
| **F1110**   | 초기화 기능        | “초기화” 버튼 클릭 시 모든 값 기본값으로 복귀                       |
| **F1111**   | 비활성화 제어      | EE_On=0일 경우 모든 필드 비활성화                                   |
| **F1112**   | 그래프 연동 제어   | GraphOn=0일 경우 그래프 숨김 처리, GraphOn=1일 경우 표시            |
| **F1113**   | 데이터 중복 검증   | 동일한 xₙ 값 중복 시 경고창 및 저장 차단                            |
| **F1114**   | 설비 그룹 반영     | 입력값 변경 시 CAPEX 계산 모듈 내 충전기 그룹 항목 자동 업데이트    |

---

**■ 그래프 관련 기능 (Graph Behavior)**

| **그래프 ID** | **설명**                     | **트리거 변수**                                       | **그래프 형식**     | **세부 기능**                                      |
| :------------ | :--------------------------- | :---------------------------------------------------- | :------------------ | :------------------------------------------------- |
| **G1101**     | 충전기 수량–비용 관계 그래프 | xₙ_Disp, yₙ_Disp                                      | 2D Scatter          | x축: 충전기 수량(ea), y축: 설비비(백만원 또는 천$) |
| **G1102**     | 실시간 갱신                  | 입력값 변경 시 그래프 자동 업데이트                   | Scatter 실시간 반영 | GraphOn=1일 경우 활성                              |
| **G1103**     | 환율 연동                    | Dal2Won, Currency_Disp 변경 시 축 단위 자동 조정      | 스케일 재계산       |                                                    |
| **G1104**     | 그래프 표시 제어             | GraphOn=0일 경우 그래프 캔버스 숨김 처리              | Boolean             |                                                    |
| **G1105**     | 곡선 근사화                  | 15개 입력데이터 기반 최소자승법 회귀곡선 표시         | 자동 연산           |                                                    |
| **G1106**     | 설비 그룹 반영               | 그래프 데이터 변경 시 충전기 CAPEX 총합 자동 업데이트 | 실시간 반영         |                                                    |

---

**📘 탭 설명 요약**

- 본 탭은 수소충전소의 **수소충전기(Dispenser) 설비비(CAPEX)** 산출용 입력 구간입니다.
- 각 충전기 수량(ea) 대비 설비비(백만원)를 최대 15개 사례로 입력할 수 있습니다.
- Currency_Disp, Dal2Won 설정을 실시간 반영하며,\
  GraphOn 활성 시 즉시 시각화됩니다.
- 그래프는 산점도 및 회귀곡선을 통해 충전기 수량 대비 단가 추세를 표시합니다.

---

---

**⚙️ [화면 ID : 7-10] 설치비용 계수 탭**

**■ 입력 변수 리스트 (FULL SPEC)**

| **변수명**       | **설명**                    | **단위** | **형식** | **기본값** | **최소값** | **최대값** | **조건 / 설명** |
| :--------------- | :-------------------------- | :------- | :------- | :--------- | :--------- | :--------- | :-------------- |
| **F_Inst_Comp**  | 압축기 설치비 계수          | -        | Number   | 1\.2       | 0          | -          |                 |
| **F_Inst_Bank**  | 뱅크 설치비 계수            | -        | Number   | 1\.3       | 0          | -          |                 |
| **F_Inst_Disp**  | 수소충전기 설치비 계수      | -        | Number   | 1\.2       | 0          | -          |                 |
| **F_Inst_LqTk**  | 액화수소 탱크 설치비 계수   | -        | Number   | 1\.2       | 0          | -          |                 |
| **F_Inst_LqPp**  | 액화수소 펌프 설치비 계수   | -        | Number   | 1\.2       | 0          | -          |                 |
| **F_Inst_LqVap** | 액화수소 기화기 설치비 계수 | -        | Number   | 1\.2       | 0          | -          |                 |
| **F_Inst_Elec**  | 급전 설비 설치비 계수       | -        | Number   | 2\.24      | 0          | -          |                 |

---

**■ 요구 기능 리스트 (Functional Requirements)**

| **기능 ID** | **기능명**              | **기능 설명**                                                                  |
| :---------- | :---------------------- | :----------------------------------------------------------------------------- |
| **F1201**   | 계수 입력 필드 구성     | F_Inst_Comp ~ F_Inst_Elec 입력 필드 생성                                       |
| **F1202**   | 기본값 자동 로드        | 초기 로딩 시 기본값 자동 설정 (압축기 1.2, 뱅크 1.3, 충전기 1.2, 전기 2.24 등) |
| **F1203**   | 실시간 반영             | 입력값 변경 시 해당 설비 그룹의 총 CAPEX 자동 재계산                           |
| **F1204**   | CAPEX 연동 계산         | 설비 그룹별 총 CAPEX = (∑ 설비비 × 설치비 계수)                                |
| **F1205**   | 입력 검증               | 0 이하 입력 방지, 소수점 2자리까지 허용                                        |
| **F1206**   | 그룹 계산 자동 업데이트 | 변경된 계수를 기반으로 “경제성 평가” 탭 내 설치비용 합계 항목 자동 수정        |
| **F1207**   | 초기화 기능             | “초기화” 버튼 클릭 시 모든 계수 기본값으로 복귀                                |
| **F1208**   | 비활성화 제어           | EE_On=0일 경우 모든 필드 비활성화                                              |
| **F1209**   | 그래프 연동             | GraphOn=1일 경우 각 설비별 CAPEX 비중 Pie 그래프 업데이트                      |
| **F1210**   | 데이터 자동 저장        |                                                                                |
| **F1211**   | 환율 연동               | Currency_Elec 등 통화 단위 변경 시 자동 재계산 (전기 계통 포함)                |

---

**■ 그래프 관련 기능 (Graph Behavior)**

| **그래프 ID** | **설명**                  | **트리거 변수**                                   | **그래프 형식** | **세부 기능**                              |
| :------------ | :------------------------ | :------------------------------------------------ | :-------------- | :----------------------------------------- |
| **G1201**     | 설비별 설치비 비중 그래프 | F_Inst\_\* 변수 전체                              | Pie Chart       | 각 설비 항목별 CAPEX × 계수 결과 비율 표시 |
| **G1202**     | 실시간 갱신               | 계수값 변경 시 자동 업데이트                      | Pie 실시간 반영 | GraphOn=1일 경우 활성                      |
| **G1203**     | 색상 구분                 | 설비 종류별 색상 지정 (압축기=파랑, 뱅크=녹색 등) | UI 일관성 유지  |                                            |
| **G1204**     | 단위 변환 반영            | 환율/단위 변경 시 그래프 자동 스케일 조정         | 자동 연산       |                                            |

---

**📘 탭 설명 요약**

- 본 탭은 각 설비별 **설치비용 계수(Installation Factor)** 를 설정하는 구간으로,\
  경제성 평가 시 CAPEX를 현실화하기 위한 **비가중 계수 입력 기능**을 수행합니다.
- 계수값 변경 시 즉시 전체 설비 CAPEX가 재계산되어,\
  이후 경제성 평가(ROI, Payback 등) 탭에 자동 반영됩니다.
- 그래프 활성 시, 설비별 총 설치비 비중을 **Pie Chart** 형태로 표시합니다.

---

---

**⚙️ [화면 ID : 7-11] 설계·운영 간접비 계수 탭**

**■ 입력 변수 리스트 (FULL SPEC)**

| **변수명**             | **설명**                     | **단위** | **형식** | **기본값** | **최소값** | **최대값** | **조건 / 설명**                              |
| :--------------------- | :--------------------------- | :------- | :------- | :--------- | :--------- | :--------- | :------------------------------------------- |
| **F_Indi_SitePrep**    | 부지 정지 및 기반공사비 계수 | -        | Number   | 0\.05      | 0          | -          | 총 설비비 대비 비율                          |
| **F_Indi_DesignEng**   | 설계 및 엔지니어링비 계수    | -        | Number   | 0\.10      | 0          | -          | 기본 및 상세 설계비 포함                     |
| **F_Indi_Contingency** | 예비비(Contingency) 계수     | -        | Number   | 0\.05      | 0          | -          | 예측 불확실성 보정                           |
| **F_Indi_Permit**      | 인허가비 계수                | -        | Number   | 0\.03      | 0          | -          | 환경/안전 인허가 관련 비용                   |
| **F_Indi_Licens**      | 라이선스 및 인증비 계수      | -        | Number   | 0          | 0          | -          | 기술 라이선스, 인증 비용 등 (필요 시만 입력) |

---

**■ 요구 기능 리스트 (Functional Requirements)**

| **기능 ID** | **기능명**       | **기능 설명**                                      |
| :---------- | :--------------- | :------------------------------------------------- |
| **F1301**   | 입력 필드 구성   | F_Indi_SitePrep ~ F_Indi_Licens 입력 필드 생성     |
| **F1302**   | 기본값 자동 로드 | 초기 로딩 시 각 계수 기본값 자동 설정              |
| **F1303**   | 실시간 반영      | 계수 변경 시 간접비 총액 및 총 CAPEX 즉시 재계산   |
| **F1304**   | 간접비 연동 계산 | 총 간접비 = (설치비 총합 × 각 계수) 의 합          |
| **F1305**   | 입력 검증        | 음수, 비정상 입력 차단 및 경고 메시지 출력         |
| **F1306**   | 계수 합계 검증   | 전체 계수 합계가 1(100%) 초과 시 경고 및 저장 불가 |
| **F1307**   | 초기화 기능      | “초기화” 버튼 클릭 시 기본값으로 복귀              |
| **F1308**   | 비활성화 제어    | EE_On=0일 경우 모든 필드 비활성화                  |
| **F1309**   | 실시간 총계 표시 | 화면 하단에 간접비 합계(%) 및 환산금액 표시        |
| **F1310**   | CAPEX 반영       | 경제성 평가 탭 내 “간접비용” 항목에 자동 반영      |
| **F1311**   | 데이터 자동 저장 |                                                    |
| **F1312**   | 그래프 연동      | GraphOn=1일 경우 간접비 비율 Pie 그래프 활성화     |

---

**■ 그래프 관련 기능 (Graph Behavior)**

| **그래프 ID** | **설명**                | **트리거 변수**                                    | **그래프 형식** | **세부 기능**           |
| :------------ | :---------------------- | :------------------------------------------------- | :-------------- | :---------------------- |
| **G1301**     | 간접비 구성 비율 그래프 | F_Indi\_\* 변수 전체                               | Pie Chart       | 각 항목별 비율 (%) 표시 |
| **G1302**     | 실시간 갱신             | 입력값 변경 시 그래프 자동 업데이트                | Pie 실시간 반영 | GraphOn=1일 경우 활성   |
| **G1303**     | 합계 기준 스케일링      | 합계가 1(=100%) 초과 시 그래프 스케일 제한 및 경고 |                 |                         |
| **G1304**     | 단위 변환 반영          | 환율, 화폐 단위 변경 시 자동 환산 적용             | 자동 계산       |                         |

---

**📘 탭 설명 요약**

- 본 탭은 **수소충전소 프로젝트의 설계·운영 간접비(Indirect Cost)** 계수를 설정하는 화면입니다.
- 설치비용 계수 탭에서 산출된 총 설치비를 기준으로,\
  설계비·인허가비·예비비 등의 비율을 반영하여 **총 CAPEX를 보정**합니다.
- 입력값 수정 시 경제성 평가 탭의 총비용 구조 및 ROI 계산에 즉시 반영됩니다.
- GraphOn 활성 시 각 간접비 항목의 구성비를 Pie Chart로 시각화합니다.

---

---

**⚙️ [화면 ID : 7-12] OPEX 비용 계수 탭**

**■ 입력 변수 리스트 (FULL SPEC)**

| **변수명**             | **설명**                | **단위** | **형식** | **기본값** | **최소값** | **최대값** | **조건 / 설명**             |
| :--------------------- | :---------------------- | :------- | :------- | :--------- | :--------- | :--------- | :-------------------------- |
| **F_Opex_Insurance**   | 보험료 계수             | -        | Number   | 0\.01      | 0          | -          | 총 CAPEX 대비 비율          |
| **F_Opex_PropertyTax** | 재산세 계수             | -        | Number   | 0\.0075    | 0          | -          | 총 CAPEX 대비 비율          |
| **F_Opex_LicenPermit** | 인허가·면허 갱신비 계수 | -        | Number   | 0\.001     | 0          | -          | 총 CAPEX 대비 비율          |
| **F_Opex_OpexComp**    | 압축기 운영비 계수      | -        | Number   | 0\.04      | 0          | -          | 압축기 CAPEX 대비 연간 비율 |
| **F_Opex_OpexBk**      | 뱅크 운영비 계수        | -        | Number   | 0\.01      | 0          | -          | 뱅크 CAPEX 대비 연간 비율   |
| **F_Opex_OpexDisp**    | 수소충전기 운영비 계수  | -        | Number   | 0\.03      | 0          | -          | 충전기 CAPEX 대비 연간 비율 |

---

**■ 요구 기능 리스트 (Functional Requirements)**

| **기능 ID** | **기능명**       | **기능 설명**                                                            |
| :---------- | :--------------- | :----------------------------------------------------------------------- |
| **F1401**   | 입력 필드 구성   | F_Opex_Insurance ~ F_Opex_OpexDisp 입력 필드 자동 생성                   |
| **F1402**   | 기본값 자동 로드 | 초기 로딩 시 각 계수 기본값 자동 설정                                    |
| **F1403**   | 실시간 반영      | 계수 변경 시 연간 OPEX 총액 즉시 재계산                                  |
| **F1404**   | OPEX 연동 계산   | 연간 OPEX = ∑(설비 CAPEX × 해당 운영비 계수) + ∑(총 CAPEX × 일반비 계수) |
| **F1405**   | 입력 검증        | 음수 입력 차단 및 허용 소수점 4자리 이하 제한                            |
| **F1406**   | 단위 일관성 유지 | 모든 항목 무단위(-)로 표시되며, 연간 비율로만 사용                       |
| **F1407**   | 초기화 기능      | “초기화” 버튼 클릭 시 모든 계수 기본값으로 복귀                          |
| **F1408**   | 비활성화 제어    | EE_On=0일 경우 모든 필드 비활성화                                        |
| **F1409**   | 연간 환산 기능   | 연간 운영비 = CAPEX × 계수 × 환율(Dal2Won) 적용 시 자동 환산             |
| **F1410**   | 데이터 자동 저장 |                                                                          |
| **F1411**   | 경제성 평가 연동 | 계산된 OPEX 총액을 경제성 평가 탭의 연간 비용 항목에 자동 전송           |
| **F1412**   | 그래프 연동      | GraphOn=1일 경우 OPEX 구성 Pie 그래프 활성화                             |
| **F1413**   | 계수 합계 검증   | 전체 비율 합계 초과 시 경고 표시 및 저장 차단                            |

---

**■ 그래프 관련 기능 (Graph Behavior)**

| **그래프 ID** | **설명**                   | **트리거 변수**                                     | **그래프 형식** | **세부 기능**                               |
| :------------ | :------------------------- | :-------------------------------------------------- | :-------------- | :------------------------------------------ |
| **G1401**     | 연간 OPEX 구성 비율 그래프 | F_Opex\_\* 변수 전체                                | Pie Chart       | 각 항목별 비율 표시 (보험, 세금, 압축기 등) |
| **G1402**     | 실시간 갱신                | 입력값 변경 시 그래프 자동 업데이트                 | Pie 실시간 반영 | GraphOn=1일 경우 활성                       |
| **G1403**     | 합계 스케일 검증           | 총합 100% 초과 시 경고 및 색상 변경 (빨간 표시)     |                 |                                             |
| **G1404**     | 단위 변환 반영             | Currency_Elec, Dal2Won 변경 시 환율 자동 반영       |                 |                                             |
| **G1405**     | 누적비율 표시              | Pie Chart 내 누적합 % 및 총금액 표시 (Tooltip 기능) |                 |                                             |

---

**📘 탭 설명 요약**

- 본 탭은 **운전 및 유지관리비(OPEX)** 를 설비 CAPEX 및 총 CAPEX 대비 비율로 산정하기 위한 계수 입력 구간입니다.
- 각 항목은 연간 비율로 설정되며, 설비비 및 환율(Dal2Won)과 연동되어 자동 계산됩니다.
- 계산된 OPEX는 경제성 평가 탭의 “연간 운영비” 항목에 직접 반영됩니다.
- GraphOn 활성 시 항목별 비중을 Pie Chart로 시각화합니다.

---

---

**⚙️ [화면 ID : 7-13] 인건비 정보 탭**

**■ 입력 변수 리스트 (FULL SPEC)**

| **변수명**       | **설명**                     | **단위** | **형식** | **기본값** | **최소값** | **최대값** | **조건 / 설명**                                 |
| :--------------- | :--------------------------- | :------- | :------- | :--------- | :--------- | :--------- | :---------------------------------------------- |
| **MinPer1Fu**    | 1회 충전 소요시간            | min      | Number   | 10         | 0          | -          | 1회 차량당 평균 충전시간(분)                    |
| **WorkHrPerDay** | 1일 근무시간                 | hr       | Number   | 8          | 1          | 24         | 근무자 1인 기준 1일 근무시간                    |
| **WagePerHr**    | 인건비 단가                  | Won/hr   | Number   | 25000      | 0          | -          | 시간당 급여 단가(원)                            |
| **R_OverhGnA**   | 일반관리비율(Overhead & G&A) | Won      | Number   | 0\.2       | 0          | 1          | 인건비 대비 간접비율 (비율 입력, 단위는 무차원) |

---

**■ 요구 기능 리스트 (Functional Requirements)**

| **기능 ID** | **기능명**       | **기능 설명**                                                                   |
| :---------- | :--------------- | :------------------------------------------------------------------------------ |
| **F1501**   | 입력 필드 구성   | MinPer1Fu, WorkHrPerDay, WagePerHr, R_OverhGnA 입력 필드 자동 생성              |
| **F1502**   | 기본값 자동 로드 | 초기 로딩 시 기본값 자동 설정 (10, 8, 25000, 0.2)                               |
| **F1503**   | 단위 표시        | 각 항목별 단위 자동 표기 (분, 시간, 원/시간, 비율)                              |
| **F1504**   | 실시간 반영      | 입력값 변경 시 인건비 총액 자동 재계산                                          |
| **F1505**   | 인건비 계산식    | 연간 인건비 = (WorkHrPerDay × WagePerHr × 근무일수 × 인원수) × (1 + R_OverhGnA) |
| **F1506**   | 입력 검증        | 음수 입력 차단 및 비정상 단위 경고 메시지 표시                                  |
| **F1507**   | 근무일수 연동    | FuDayPerYr(연간 운영일수) 값과 자동 연동                                        |
| **F1508**   | 단위 환산 기능   | Currency_YrPurch가 “$”일 경우 환율(Dal2Won) 반영 자동 계산                      |
| **F1509**   | 초기화 기능      | “초기화” 버튼 클릭 시 모든 입력값 기본값으로 복귀                               |
| **F1510**   | 비활성화 제어    | EE_On=0일 경우 입력 비활성화                                                    |
| **F1511**   | 데이터 자동 저장 |                                                                                 |
| **F1512**   | 경제성 평가 연동 | 인건비 총액이 “연간 인건비” 항목에 자동 반영                                    |
| **F1513**   | 그래프 연동      | GraphOn=1일 경우 인건비 구성 Pie Chart 활성화                                   |
| **F1514**   | 인원수 입력 연동 | 별도 인원수 입력 모듈이 존재할 경우 자동 참조                                   |

---

**■ 그래프 관련 기능 (Graph Behavior)**

| **그래프 ID** | **설명**           | **트리거 변수**                            | **그래프 형식**     | **세부 기능**                    |
| :------------ | :----------------- | :----------------------------------------- | :------------------ | :------------------------------- |
| **G1501**     | 인건비 구성 그래프 | WagePerHr, WorkHrPerDay, R_OverhGnA        | Pie Chart           | 기본 인건비 vs. 관리비 비율 표시 |
| **G1502**     | 실시간 갱신        | 입력값 변경 시 그래프 자동 업데이트        | GraphOn=1일 때 활성 |                                  |
| **G1503**     | 합계 표시          | 총 인건비(연간) 계산값 툴팁으로 표시       |                     |                                  |
| **G1504**     | 단위 변환 반영     | Currency_YrPurch 변경 시 자동 환산         |                     |                                  |
| **G1505**     | 근무일수 연동 표시 | FuDayPerYr에 따라 연간 근무량 계산 및 표시 |                     |                                  |

---

**📘 탭 설명 요약**

- 본 탭은 **수소충전소 운영 인건비 산정**을 위한 핵심 입력 구간입니다.
- 시간당 급여, 근무시간, 충전주기 등의 입력을 통해\
  연간 인건비 및 관리비를 자동 산출하며,\
  경제성 평가 탭의 연간 운영비(OPEX)에 직접 반영됩니다.
- GraphOn이 활성화되면 인건비 대비 관리비 비율이 시각적으로 표시됩니다.

---

---

**⚙️ [화면 ID : 7-14] 충전 비용 정보 탭**

**■ 입력 변수 리스트 (FULL SPEC)**

| **변수명**    | **설명**                                       | **단위** | **형식** | **기본값** | **최소값** | **최대값** | **조건 / 설명**                            |
| :------------ | :--------------------------------------------- | :------- | :------- | :--------- | :--------- | :--------- | :----------------------------------------- |
| **N_FuHDV_0** | HRS 개입 시점 Heavy Duty Vehicle 1일 충전 대수 | ea/day   | Number   | 4          | 0          | -          | 중·대형 차량 기준 초기 일일 충전 횟수      |
| **N_FuLDV_0** | HRS 개입 시점 Light Duty Vehicle 1일 충전 대수 | ea/day   | Number   | 20         | 0          | -          | 소형 차량 기준 초기 일일 충전 횟수         |
| **M_1FuHDV**  | Heavy Duty Vehicle 1회 충전 시 H₂ 평균 충전량  | kg/ea    | Number   | 25         | 0          | -          | 1회 충전당 충전되는 평균 수소량            |
| **M_2FuLDV**  | Light Duty Vehicle 1회 충전 시 H₂ 평균 충전량  | kg/ea    | Number   | 5          | 0          | -          | 1회 충전당 충전되는 평균 수소량            |
| **R_GrowHDV** | 연단위 Heavy Duty Vehicle 충전량 증가율        | -        | Number   | 0\.2       | 0          | 1          | 연도별 중·대형 차량 충전량 증가율          |
| **R_GrowLDV** | 연단위 Light Duty Vehicle 충전량 증가율        | -        | Number   | 0\.15      | 0          | 1          | 연도별 소형 차량 충전량 증가율             |
| **R_H2Loss**  | HRS에서 H₂ 구매량 대비 손실률                  | %        | Number   | 0\.039     | 0          | 1          | 충전·배관 과정에서 발생하는 평균 손실 비율 |
| **t_BrkLDV**  | LDV 충전 준비 시간                             | sec      | Number   | 3          | 0          | -          | 차량 전환, 노즐 체결 등 준비 소요시간      |
| **t_BrkHDV**  | HDV 충전 준비 시간                             | sec      | Number   | 5          | 0          | -          | 중·대형차 충전 전환 준비 소요시간          |
| **t_FuLDV**   | LDV 충전 소요 시간                             | sec      | Number   | 3\.5       | 0          | -          | 실제 충전기 가동 시간                      |
| **t_FuHDV**   | HDV 충전 소요 시간                             | sec      | Number   | 12\.3      | 0          | -          | 실제 충전기 가동 시간                      |

---

**■ 요구 기능 리스트 (Functional Requirements)**

| **기능 ID** | **기능명**       | **기능 설명**                                                          |     |     |
| :---------- | :--------------- | :--------------------------------------------------------------------- | :-- | :-- |
| **F1601**   | 입력 필드 구성   | N_FuHDV_0 ~ t_FuHDV 입력 필드 자동 생성                                |     |     |
| **F1602**   | 기본값 자동 로드 | 초기 로딩 시 모든 입력값 기본값으로 설정                               |     |     |
| **F1603**   | 단위 표시        | 각 항목별 단위 자동 표기 및 포맷 고정                                  |     |     |
| **F1604**   | 입력 검증        | 음수, 비정상 단위, 공백 입력 방지 및 경고 메시지 출력                  |     |     |
| **F1605**   | 실시간 반영      | 입력값 변경 시 경제성 평가 탭 내 ‘연간 수소 판매량’ 항목 즉시 업데이트 |     |     |
| **F1606**   | 초기화 기능      | “초기화” 클릭 시 모든 변수 기본값으로 복귀                             |     |     |
| **F1607**   | 비활성화 제어    | EE_On=0일 경우 전체 입력 필드 비활성화                                 |     |     |
| **F1608**   | 그래프 연동      | GraphOn=1일 경우 충전량–시간 관계 3D 그래프 표시                       |     |     |
| **F1609**   | 데이터 자동 저장 |                                                                        |     |     |
| **F1610**   | 단위 환산        | Currency_YrPurch가 “$”일 경우 환율(Dal2Won) 자동 적용                  |     |     |

---

**■ 그래프 관련 기능 (Graph Behavior)**

| **그래프 ID** | **설명**                             | **트리거 변수**                                              | **그래프 형식**       | **세부 기능**                                 |
| :------------ | :----------------------------------- | :----------------------------------------------------------- | :-------------------- | :-------------------------------------------- |
| **G1601**     | 연도별 차량유형별 충전량 변화 그래프 | N_FuLDV_0, N_FuHDV_0, R_GrowLDV, R_GrowHDV                   | 3D Surface            | x축: 연도, y축: 차량유형, z축: 충전량(kg/day) |
| **G1602**     | 실시간 갱신                          | 입력값 변경 시 즉시 갱신                                     | GraphOn=1일 경우 활성 |                                               |
| **G1603**     | 수소 손실률 반영                     | R_H2Loss 반영 시 충전효율 및 실제 충전량 자동 보정           |                       |                                               |
| **G1604**     | 시간대별 충전패턴 분석               | t_BrkLDV, t_BrkHDV, t_FuLDV, t_FuHDV 기반 충전기 활용률 계산 |                       |                                               |
| **G1605**     | 데이터 연동                          | 계산된 충전량 결과를 EconomicEvaluation 모듈에 자동 전달     |                       |                                               |
| **G1606**     | 단위 변환 자동화                     | Dal2Won, Currency_YrPrice 변경 시 그래프 단위 즉시 반영      |                       |                                               |

---

**📘 탭 설명 요약**

- 본 탭은 **HRS(Hydrogen Refueling Station)** 의 실제 충전 운전 조건을 정의하여\
  수소 판매량, 충전 시간, 손실률 및 수요성장률을 기반으로 **운영비용 및 수익 예측**에 반영하는 입력 화면입니다.
- 차량 유형별 충전 횟수와 평균 충전량, 충전 시간, 수소 손실률을 통합 계산하여\
  경제성 평가 모듈의 “연간 수소 판매량”, “운전시간” 등 주요 변수로 전달됩니다.
- GraphOn 활성 시, 충전량–시간–성장률의 관계를 3차원 Surface Plot으로 시각화합니다.

---

---

**⚙️ [화면 ID : 7-15] 수소 판매비용 정보 탭**

**■ 입력 변수 리스트 (FULL SPEC)**

| **변수명**                       | **설명**                     | **단위** | **형식** | **기본값** | **최소값** | **최대값** | **조건 / 설명**                |
| :------------------------------- | :--------------------------- | :------- | :------- | :--------- | :--------- | :--------- | :----------------------------- |
| **x1_YrPrice**                   | 판매단가 기준 연도 (1차년도) | Yr       | Number   | 2031       | 0          | -          | 기준연도 1                     |
| **x2_YrPrice**                   | 판매단가 기준 연도 (2차년도) | Yr       | Number   | 2041       | 0          | -          | 기준연도 2                     |
| **x3_YrPrice**                   | 판매단가 기준 연도 (3차년도) | Yr       | Number   | 2051       | 0          | -          | 기준연도 3                     |
| **x4_YrPrice** ~ **x15_YrPrice** | 추가 연도 항목               | Yr       | Number   | 0          | 0          | -          | 선택적 입력                    |
| **y1_Price**                     | 수소 판매단가 (1차년도)      | Won/kg   | Number   | 8800       | 0          | -          | x1_YrPrice에 해당하는 판매단가 |
| **y2_Price**                     | 수소 판매단가 (2차년도)      | Won/kg   | Number   | 8500       | 0          | -          | x2_YrPrice에 해당하는 판매단가 |
| **y3_Price**                     | 수소 판매단가 (3차년도)      | Won/kg   | Number   | 8200       | 0          | -          | x3_YrPrice에 해당하는 판매단가 |
| **y4_Price** ~ **y15_Price**     | 추가 연도 판매단가           | Won/kg   | Number   | 0          | 0          | -          | 선택적 입력                    |

---

**■ 요구 기능 리스트 (Functional Requirements)**

| **기능 ID** | **기능명**         | **기능 설명**                                                           |
| :---------- | :----------------- | :---------------------------------------------------------------------- |
| **F1701**   | 입력 필드 구성     | x₁~x₁₅, y₁~y₁₅ 세트 필드 자동 생성                                      |
| **F1702**   | 기본값 자동 로드   | 초기 로딩 시 x₁~x₁₅, y₁~y₁₅ 기본값 자동 설정                            |
| **F1703**   | 단위 표시          | 좌측 컬럼: 연도(Yr), 우측 컬럼: 단가(Won/kg)                            |
| **F1704**   | 단위 연동          | Currency_YrPrice 값이 “$”일 경우 Dal2Won 환율 반영                      |
| **F1705**   | 입력 검증          | 연도 중복, 비연속 값, 음수 입력 시 오류 경고 및 저장 차단               |
| **F1706**   | 실시간 매출 계산   | 판매단가 변경 시 연간 매출액 = 충전량(kg) × yₙ_Price 자동 반영          |
| **F1707**   | 환율 연동 계산     | Currency_YrPrice = “$”일 경우 yₙ_Price × Dal2Won 으로 환산              |
| **F1708**   | 자동 보간 기능     | 입력된 연도 구간 사이의 판매단가를 선형 보간하여 중간 연도 값 자동 생성 |
| **F1709**   | 실시간 그래프 갱신 | yₙ_Price 값 변경 시 즉시 그래프 업데이트                                |
| **F1710**   | 초기화 기능        | “초기화” 클릭 시 모든 값 기본값 복귀                                    |
| **F1711**   | 비활성화 제어      | EE_On=0일 경우 입력 비활성화                                            |
| **F1712**   | 그래프 연동 제어   | GraphOn=0일 경우 그래프 숨김 처리, GraphOn=1일 경우 표시                |
| **F1713**   | 데이터 자동 저장   |                                                                         |
| **F1714**   | 시계열 검증        | 입력된 연도 순서 자동 정렬 및 중복 제거 로직 포함                       |

---

**■ 그래프 관련 기능 (Graph Behavior)**

| **그래프 ID** | **설명**                         | **트리거 변수**                                              | **그래프 형식**       | **세부 기능**                        |
| :------------ | :------------------------------- | :----------------------------------------------------------- | :-------------------- | :----------------------------------- |
| **G1701**     | 연도별 수소 판매단가 추이 그래프 | xₙ_YrPrice, yₙ_Price                                         | 2D Line Chart         | x축: 연도, y축: 단가(Won/kg or $/kg) |
| **G1702**     | 실시간 갱신                      | 입력값 변경 시 그래프 자동 업데이트                          | GraphOn=1일 경우 활성 |                                      |
| **G1703**     | 환율 연동                        | Dal2Won 및 Currency_YrPrice 변경 시 단위 자동 변환           |                       |                                      |
| **G1704**     | 보간곡선 표시                    | 입력값이 없는 연도는 보간값을 점선 형태로 표시               |                       |                                      |
| **G1705**     | 데이터 연동                      | 매출 계산 모듈(EconomicEvaluation)에 그래프 데이터 자동 전달 |                       |                                      |
| **G1706**     | 단위 변환 반영                   | Won↔$ 변환 시 축 스케일 동기화                               |                       |                                      |

---

**📘 탭 설명 요약**

- 본 탭은 **수소 판매단가(H₂ Sale Price)** 를 연도별로 설정하여,\
  경제성 평가 모듈의 연간 매출(Revenue) 예측에 직접 반영하는 입력 구간입니다.
- 연도별로 최대 15개 구간까지 입력할 수 있으며,\
  환율 및 화폐단위 설정(Currency_YrPrice, Dal2Won)과 연동되어 자동 환산됩니다.
- GraphOn 활성 시, 연도별 수소 단가 변화를 **시계열 그래프(Line Chart)** 로 표시하며,

---

---

**⚙️ [화면 ID : 7-16] 수소 구매비용 탭**

**■ 입력 변수 리스트 (FULL SPEC)**

| **변수명**                       | **설명**                          | **단위** | **형식** | **기본값** | **최소값** | **최대값** | **조건 / 설명**                |
| :------------------------------- | :-------------------------------- | :------- | :------- | :--------- | :--------- | :--------- | :----------------------------- |
| **x1_YrPurch**                   | 수소 구매단가 기준 연도 (1차년도) | Yr       | Number   | 2031       | 0          | -          | 기준연도 1                     |
| **x2_YrPurch**                   | 수소 구매단가 기준 연도 (2차년도) | Yr       | Number   | 2041       | 0          | -          | 기준연도 2                     |
| **x3_YrPurch**                   | 수소 구매단가 기준 연도 (3차년도) | Yr       | Number   | 2051       | 0          | -          | 기준연도 3                     |
| **x4_YrPurch** ~ **x15_YrPurch** | 추가 연도 항목                    | Yr       | Number   | 0          | 0          | -          | 선택적 입력                    |
| **y1_Purch**                     | 수소 구매단가 (1차년도)           | Won/kg   | Number   | 6500       | 0          | -          | x1_YrPurch에 해당하는 구매단가 |
| **y2_Purch**                     | 수소 구매단가 (2차년도)           | Won/kg   | Number   | 5000       | 0          | -          | x2_YrPurch에 해당하는 구매단가 |
| **y3_Purch**                     | 수소 구매단가 (3차년도)           | Won/kg   | Number   | 3500       | 0          | -          | x3_YrPurch에 해당하는 구매단가 |
| **y4_Purch** ~ **y15_Purch**     | 추가 연도 구매단가                | Won/kg   | Number   | 0          | 0          | -          | 선택적 입력                    |

---

**■ 요구 기능 리스트 (Functional Requirements)**

| **기능 ID** | **기능명**         | **기능 설명**                                             |
| :---------- | :----------------- | :-------------------------------------------------------- |
| **F1801**   | 입력 필드 구성     | x₁~x₁₅, y₁~y₁₅ 세트 필드 자동 생성                        |
| **F1802**   | 기본값 자동 로드   | 초기 로딩 시 x₁~x₁₅, y₁~y₁₅ 기본값 자동 설정              |
| **F1803**   | 단위 표시          | 좌측 컬럼: 연도(Yr), 우측 컬럼: 단가(Won/kg)              |
| **F1804**   | 단위 연동          | Currency_YrPurch 값이 “$”일 경우 Dal2Won 환율 자동 반영   |
| **F1805**   | 입력 검증          | 연도 중복, 비연속 값, 음수 입력 시 오류 경고 및 저장 차단 |
| **F1806**   | 실시간 그래프 갱신 | yₙ_Purch 값 변경 시 즉시 그래프 업데이트                  |
| **F1807**   | 초기화 기능        | “초기화” 클릭 시 모든 값 기본값 복귀                      |
| **F1808**   | 비활성화 제어      | EE_On=0일 경우 입력 비활성화                              |
| **F1809**   | 그래프 연동 제어   | GraphOn=0일 경우 그래프 숨김 처리, GraphOn=1일 경우 표시  |
| **F1810**   | 데이터 자동 저장   |                                                           |
| **F1811**   | 시계열 검증        | 연도 순서 자동 정렬 및 중복 제거 로직 포함                |

---

**■ 그래프 관련 기능 (Graph Behavior)**

| **그래프 ID** | **설명**                         | **트리거 변수**                                                 | **그래프 형식**       | **세부 기능**                        |
| :------------ | :------------------------------- | :-------------------------------------------------------------- | :-------------------- | :----------------------------------- |
| **G1801**     | 연도별 수소 구매단가 추이 그래프 | xₙ_YrPurch, yₙ_Purch                                            | 2D Line Chart         | x축: 연도, y축: 단가(Won/kg or $/kg) |
| **G1802**     | 실시간 갱신                      | 입력값 변경 시 그래프 자동 업데이트                             | GraphOn=1일 경우 활성 |                                      |
| **G1803**     | 환율 연동                        | Dal2Won 및 Currency_YrPurch 변경 시 단위 자동 변환              |                       |                                      |
| **G1804**     | 보간곡선 표시                    | 입력되지 않은 연도 구간은 보간값 점선으로 표시                  |                       |                                      |
| **G1805**     | 데이터 연동                      | 그래프 데이터 EconomicEvaluation 모듈의 원가 예측 로직으로 전달 |                       |                                      |
| **G1806**     | 단위 변환 반영                   | Won↔$ 변환 시 축 스케일 즉시 동기화                             |                       |                                      |

---

**📘 탭 설명 요약**

- 본 탭은 수소충전소의 **원료 수소(H₂) 구매단가**를 연도별로 입력하여\
  경제성 평가의 **연간 운전비(OPEX)** 중 원료비 항목에 직접 반영하는 입력 화면입니다.
- 최대 15개 연도 구간 입력 가능
- 환율(Dal2Won) 및 화폐단위(Currency_YrPurch) 설정과 연동되어\
  원화 또는 달러 기준으로 실시간 환산 계산이 가능합니다.
- GraphOn 활성 시, 연도별 구매단가 변화를 **시계열 그래프(Line Chart)** 로 표시합니다.

---

---

**⚙️ [화면 ID : 7-17] 인상 및 감가 정보 탭**

**■ 입력 변수 리스트 (FULL SPEC)**

| **변수명**             | **설명**                                           | **단위** | **형식** | **기본값** | **최소값** | **최대값** | **조건 / 설명**                  |
| :--------------------- | :------------------------------------------------- | :------- | :------- | :--------- | :--------- | :--------- | :------------------------------- |
| **R_Inflation**        | 연평균 물가상승률 (Inflation Rate)                 | %        | Number   | 0\.004     | 0          | 1          | 전체 경제지표에 반영             |
| **R_WageIncrease**     | 연평균 인건비 상승률 (Wage Growth Rate)            | %        | Number   | 0\.029     | 0          | 1          | 인건비 관련 탭(WagePerHr)에 연동 |
| **R_ElecBillIncrease** | 전력요금 연평균 인상률 (Electricity Rate Increase) | %        | Number   | 0\.03      | 0          | 1          | 전력비 계산 시 반영              |
| **R_Depreciation**     | 감가상각률 (Depreciation Rate)                     | %        | Number   | 0\.139     | 0          | 1          | 정액법 기준, 자산가치 감소율     |
| **R_SalvageVal**       | 잔존가치율 (Salvage Value Rate)                    | %        | Number   | 0\.05      | 0          | 1          | 초기투자 대비 잔존자산 비율      |
| **R_Discount**         | 할인율 (Discount Rate)                             | %        | Number   | 0\.045     | 0          | 1          | NPV 및 IRR 계산 시 적용          |
| **Yr_Life**            | 설비 내용연수 (Facility Life Span)                 | yr       | Integer  | 20         | 1          | 100        | 감가상각 연한                    |
| **Yr_Base**            | 기준연도 (Base Year)                               | Yr       | Integer  | 2025       | 0          | -          | 모든 비용·가격 환산 기준연도     |
| **Yr_DoStart**         | 운전 시작 연도 (Operation Start Year)              | Yr       | Integer  | 2027       | 0          | -          | 운전비(OPEX) 발생 시점           |
| **Yr_EE**              | 경제성 평가 기간 (Evaluation Period)               | Yr       | Integer  | 30         | 1          | 100        | 전체 시뮬레이션 평가 구간        |

---

**■ 요구 기능 리스트 (Functional Requirements)**

| **기능 ID** | **기능명**       | **기능 설명**                                |
| :---------- | :--------------- | :------------------------------------------- |
| **F1901**   | 입력 필드 구성   | 각 항목별 값(Number)과 단위(Label) 자동 생성 |
| **F1902**   | 기본값 자동 로드 | 초기 로딩 시 표준 경제 변수값 자동 입력      |
| **F1903**   | 단위 표시        | % 및 Yr 단위 고정 표시                       |
| **F1904**   | 입력 검증        | 0~1(%) 범위 외 값 입력 시 경고 팝업          |
| **F1905**   | 자동 보정        | 평가기간이 Life보다 짧을 경우 자동 일치 조정 |
| **F1906**   | 그래프 연동      | 연도별 감가상각곡선 및 비용 증가 곡선 시각화 |
| **F1907**   | 단위 변환 제어   | % 입력 시 자동 소수변환 (예: 4.5% → 0.045)   |
| **F1908**   | 초기화 기능      | “초기화” 버튼 클릭 시 모든 기본값 복귀       |
| **F1909**   | 데이터 저장      |                                              |

---

**■ 그래프 관련 기능 (Graph Behavior)**

| **그래프 ID** | **설명**                | **트리거 변수**                                 | **그래프 형식**         | **세부 기능**                      |
| :------------ | :---------------------- | :---------------------------------------------- | :---------------------- | :--------------------------------- |
| **G1901**     | 연도별 감가상각 곡선    | R_Depreciation, Yr_Life                         | Line Chart              | 연도별 자산가치 감소 시각화        |
| **G1902**     | 비용 인상률 비교 그래프 | R_Inflation, R_WageIncrease, R_ElecBillIncrease | Multi-Line Chart        | 각 항목별 상승률 추이 비교         |
| **G1903**     | 할인율 효과 시각화      | R_Discount, Yr_EE                               | Exponential Decay Chart | 현가계수(1/(1+r)^n) 시각화         |
| **G1904**     | 잔존가치 반영           | R_SalvageVal                                    | Bar Chart               | 자산가치 대비 잔존비율 표시        |
| **G1905**     | 복합 인상 시뮬레이션    | 모든 인상률                                     | Combined Trend Chart    | OPEX 변화 종합 시뮬레이션용 그래프 |

---

**📘 탭 설명 요약**

- 본 탭은 경제성 평가의 기본 지표로 사용되는 **인상률·감가상각률·할인율**을 설정하는 구간입니다.
- 입력된 값은 CAPEX와 OPEX 항목 전체에 자동 연동되어\
  연간 현금흐름(Discounted Cash Flow, DCF)을 계산하는 데 활용됩니다.
- GraphOn 옵션 활성 시, 각 항목의 **시간적 변화 그래프**를 자동 표시합니다.

---

---

**⚙️ [화면 ID : 8-1] 리포트 결과 팝업**

**📋 화면 개요**

- **목적:** 7-1~7-17 입력값 및 Output_EE2.csv의 계산 결과를 기반으로 경제성 평가 요약 리포트를 표시
- **트리거:** “리포트 보기” 버튼 클릭 시 팝업 활성화
- **저장 기능:** “저장(Excel)” 버튼 클릭 시 결과를 .xlsx로 내보내기
- **데이터 소스:** /data/Output_EE2.csv

---

**🧩 출력 변수 리스트 (FULL SPEC)**

| **변수명**     | **설명**                             | **단위** | **데이터 출처** |
| :------------- | :----------------------------------- | :------- | :-------------- |
| **C_LCpCA**    | 저압 압축기 CAPEX                    | 원       | Output_EE2.csv  |
| **C_MCp2CA**   | 중압압축기 2 CAPEX                   | 원       | Output_EE2.csv  |
| **C_MCp1CA**   | 중압압축기 1 CAPEX                   | 원       | Output_EE2.csv  |
| **C_HCpCA**    | 고압 압축기 CAPEX                    | 원       | Output_EE2.csv  |
| **C_CpCA**     | 전체 압축기 CAPEX                    | 원       | Output_EE2.csv  |
| **C_BufCA**    | 버퍼탱크 CAPEX                       | 원       | Output_EE2.csv  |
| **C_LBkCA**    | 저압 뱅크 CAPEX                      | 원       | Output_EE2.csv  |
| **C_MBkCA**    | 중압 뱅크 CAPEX                      | 원       | Output_EE2.csv  |
| **C_HBkCA**    | 고압 뱅크 CAPEX                      | 원       | Output_EE2.csv  |
| **C_BkCA**     | 전체 뱅크 CAPEX                      | 원       | Output_EE2.csv  |
| **C_Disp1CA**  | 수소충전기 1 CAPEX                   | 원       | Output_EE2.csv  |
| **C_Disp2CA**  | 수소충전기 CAPEX                     | 원       | Output_EE2.csv  |
| **C_DispCA**   | 전체 수소충전기 CAPEX                | 원       | Output_EE2.csv  |
| **C_LH2TkCA**  | 액화수소 탱크 CAPEX                  | 원       | Output_EE2.csv  |
| **C_LH2PpCA**  | 액화수소 펌프 CAPEX                  | 원       | Output_EE2.csv  |
| **C_LH2VapCA** | 액화수소 기화기 CAPEX                | 원       | Output_EE2.csv  |
| **C_LH2CA**    | 액화수소 설비 CAPEX                  | 원       | Output_EE2.csv  |
| **C_ElecCA**   | 전기 설비 CAPEX                      | 원       | Output_EE2.csv  |
| **C_ElecOP**   | 전기 설비 OPEX                       | 원/Month | Output_EE2.csv  |
| **WonOPEX**    | 연간 운전비 총합 (OPEX)              | 원       | Output_EE2.csv  |
| **WonCAPEX**   | 초기 투자비 총합 (CAPEX)             | 원       | Output_EE2.csv  |
| **NPV**        | 순현재가치 (Net Present Value)       | 원       | Output_EE2.csv  |
| **BCR**        | 편익/비용 비율 (Benefit-Cost Ratio)  | -        | Output_EE2.csv  |
| **IRR**        | 내부수익률 (Internal Rate of Return) | %        | Output_EE2.csv  |
| **yr_Payback** | 투자회수기간 (Payback Period)        | Yr       | Output_EE2.csv  |

---

**⚙️ 요구 기능 리스트 (Functional Requirements)**

| **기능 ID** | **기능명**      | **기능 설명**                                               |
| :---------- | :-------------- | :---------------------------------------------------------- |
| **F8001**   | 팝업 호출       | “리포트 보기” 버튼 클릭 시 ReportPopup 창 오픈              |
| **F8002**   | 데이터 로드     | Output_EE2.csv 파일에서 모든 변수 자동 불러오기             |
| **F8003**   | 테이블 표시     | 출력 변수별 값, 단위, 설명을 표 형식으로 표시               |
| **F8004**   | 단위 표시       | 금액(₩)은 3자리 구분 표시 및 원 단위 표기                   |
| **F8005**   | 실시간 업데이트 | 7-1~7-17 입력값 변경 시 ReportPopup 값 자동 갱신            |
| **F8006**   | 계산 모듈 연동  | EconomicCalc.py에서 NPV, IRR, BCR, Payback 계산 후 갱신     |
| **F8007**   | 시각 강조       | IRR, NPV, Payback이 목표 기준 미달 시 붉은색 강조 표시      |
| **F8008**   | 스크롤 UI       | 30개 이상의 행 데이터 표시를 위한 세로 스크롤 구성          |
| **F8009**   | 저장 기능 추가  | “저장(Excel)” 버튼 클릭 시 현재 화면 내용 저장              |
| **F8010**   | 파일 경로       | 기본 저장경로: C:\Users\<User>\Documents\Economic_Reports\| |
| **F8011**   | 파일명 규칙     | Economic_Report\_[YYYYMMDD\_HHMM].xlsx 자동 생성            |
| **F8012**   | 데이터 변환     | 테이블 데이터를 DataFrame으로 변환 후 저장                  |
| **F8013**   | 사용자 피드백   | 저장 완료 시 “Report successfully saved.” 팝업 출력         |
| **F8014**   | 오류 감지       | 파일 접근 불가, 경로 오류 발생 시 경고창 표시               |

---

**💾 저장 기능 상세 (Excel Export Flow)**

**Trigger:** 사용자가 “저장(Excel)” 버튼 클릭\
**Action:** 현재 리포트 테이블 → Pandas DataFrame 변환\
**File Creation:**\
` `- Economic_Report_YYYYMMDD_HHMM.xlsx\
` `- 기본 저장경로: C:\Users\<User>\Documents\Economic_Reports\\
**Feedback:** 저장 성공 시 “리포트 파일이 생성되었습니다.” 메시지 출력

---

**📊 그래프 버튼 동작 정의 (연동 기능)**

| **버튼명**                   | **기능**                         | **출력 화면**                |
| :--------------------------- | :------------------------------- | :--------------------------- |
| **리포트 저장 (Save Excel)** | 리포트 테이블 전체를 엑셀로 저장 | Output_EE2_Report.xlsx 생성  |
| **닫기 (Close)**             | 팝업 종료                        | 메인 경제성 평가 탭으로 복귀 |

---

---

**⚙️ [화면 ID : 8-2] 경제성 평가 그래프 결과 팝업**

---

**1️⃣ 화면 개요**

| **항목**             | **내용**                                                                                                                                        |
| :------------------- | :---------------------------------------------------------------------------------------------------------------------------------------------- |
| **화면 목적**        | 경제성 평가 결과(7-1~7-17 및 Output_EE1.csv 및 Output_EE2.csv를 그래프로 시각화하여 분석자가 주요 변수의 경제적 영향 추세를 확인할 수 있도록 함 |
| **호출 조건**        | 리포트 팝업(7-1~7-17) 내 “그래프” 버튼 클릭 시 활성화                                                                                           |
| **기본 크기**        | 1600 × 900 px                                                                                                                                   |
| **데이터 소스**      | Input_Total.xlsx, Output_EE1.csv, Output_EE2.csv                                                                                                |
| **그래프 저장 포맷** | PNG, JPG                                                                                                                                        |
| **구성 영역**        | 좌측 탭 목록 / 우측 그래프 출력 영역 / 하단 버튼 영역                                                                                           |

---

**2️⃣ 탭 목록 및 기능 정의**

| **탭 ID**       |
| :-------------- |
| PlotPriceElec   |
| PlotPriceLqTk   |
| PlotPriceLqPp   |
| PlotPriceLqVap  |
| PlotPriceCp     |
| PlotPriceLBkBuf |
| PlotPriceHBk    |
| PlotPriceDisp   |
| PlotH2Sale      |
| PlotH2Purchase  |
| PlotOp          |
| PlotH2SnP       |
| PlotPeople      |
| PlotDep         |
| PlotOPEXElement |
| PlotOPEX        |
| PlotCashFlow    |

---

**3️⃣ 기능 정의**

| **기능 ID** | **기능명**         | **기능 설명**                                                                 |
| :---------- | :----------------- | :---------------------------------------------------------------------------- |
| **F8201**   | 팝업 호출          | “그래프 보기” 버튼 클릭 시 팝업 실행                                          |
| **F8202**   | 탭 선택 기능       | 좌측 그래프 목록 중 하나 클릭 시 해당 그래프 표시                             |
| **F8203**   | 그래프 생성        | Input_Total.xlsx, Output_EE1.csv, Output_EE2.csv 데이터 기반 그래프 자동 생성 |
| **F8204**   | 그래프 업데이트    | 탭 전환 시 기존 그래프 제거 후 새 데이터 렌더링                               |
| **F8205**   | 데이터 포맷 일원화 | 금액 단위(₩) 자동 변환, 3자리 구분 표시                                       |
| **F8206**   | 저장 기능          | “저장” 클릭 시 그래프 이미지(JPG, PNG) 저장 팝업                              |
| **F8207**   | 파일명 규칙        | Plot\_[TabName]\_[YYYYMMDD\_HHMM].png 자동 생성                               |
| **F8208**   | 저장 경로          | C:\Users\<User>\Documents\EcoGraphs\|                                         |
| **F8209**   | 닫기 기능          | “닫기” 클릭 시 팝업 종료                                                      |
| **F8210**   | 확대/축소 기능     | 마우스 드래그 및 휠 확대 지원                                                 |
| **F8211**   | 툴팁 표시          | 데이터포인트 Hover 시 값/단위 표시                                            |
| **F8212**   | Trendline 표시     | 선형 회귀선을 자동 추가 (빨간색 선)                                           |
| **F8213**   | 범례 표시          | ‘Data Points’, ‘Trendline’ 자동 생성                                          |
| **F8214**   | 그래프 타이틀 표시 | 각 그래프별 제목 자동 설정 (예: “Price by Capacity...”)                       |
| **F8215**   | 단위 표시          | 축 단위 자동 추가 ($, 원, kg, yr 등)                                          |

---

**4️⃣ 저장 기능 상세**

| **항목**        | **내용**                                           |
| :-------------- | :------------------------------------------------- |
| **트리거**      | “저장” 버튼 클릭                                   |
| **저장 형식**   | PNG (기본), JPG (선택 팝업 제공)                   |
| **파일명 규칙** | Plot\_[TabName]\_YYYYMMDD_HHMM.png                 |
| **저장 경로**   | C:\Users\<User>\Documents\EcoGraphs\|              |
| **피드백**      | 저장 완료 시 “그래프가 저장되었습니다.” 팝업 표시  |
| **예외 처리**   | 경로 접근 불가, 파일 권한 오류 시 에러 메시지 출력 |

---

**🧠 5️⃣ UI 구성요소 요약**

| **번호** | **구성 요소**    | **설명**                                        |
| :------- | :--------------- | :---------------------------------------------- |
| ①        | **탭 목록 영역** | 그래프 목록 클릭 시 그래프 갱신                 |
| ②        | **저장 버튼**    | 현재 표시 중인 그래프를 이미지로 저장 (JPG/PNG) |
| ③        | **닫기 버튼**    | 팝업 종료 및 메인 경제성 평가 화면으로 복귀     |

---

---

**📊 [탭 ID: PlotPriceElec]**

**그래프명:** Price by Capacity of Electric Power Facilities\
**그래프 종류:** 2D Line + Scatter (Trendline 포함)

---

**🔹 1️⃣ 그래프 기본 정보**

| **항목**             | **값**                                                     |
| :------------------- | :--------------------------------------------------------- |
| **그래프 타입**      | 2D Line Plot + Scatter (Trendline 포함)                    |
| **그래프 제목**      | Price by Capacity of Electric Power Facilities             |
| **X축 제목**         | Capacity (bhp)                                             |
| **Y축 제목**         | Total Uninstalled Cost ($)                                 |
| **단위 변환**        | 전력 설비비: 원 → 달러 ($) 변환 시 Dal2Won(기본 1450) 적용 |
| **그래프 범례**      | Blue Circle → Data Points / Red Line → Trendline           |
| **축 라벨 포맷**     | 3자리 콤마 구분 표시                                       |
| **그래프 색상 규칙** | 데이터 포인트: 파란색 ● / 추세선: 빨간색 선                |
| **좌표 축 범위**     | 자동 스케일링 (X: 0~최대 bhp, Y: 0~최대 비용 × 1.1)        |
| **배경색**           | 투명 (#FFFFFF)                                             |
| **그래프 영역 라벨** | “Data Points”, “Trendline” 표시 (legend 위치: upper right) |

---

**🔹 2️⃣ 입력 데이터 매핑**

**📁 데이터 파일 참조**

- **입력 파일:** Input_Total.xlsx
- **회귀계수 파일:** Output_EE1.csv

---

**🧩 Data Points (Scatter Plot)**

| **데이터**    | **경로**                          | **내용**                                               |
| :------------ | :-------------------------------- | :----------------------------------------------------- |
| **x값**       | Input_Total.xlsx → B열(360~374행) | 0을 제외한 값 사용 (전력 설비 용량, 단위: bhp)         |
| **y값**       | Input_Total.xlsx → B열(375~389행) | 0을 제외한 값 사용 (설비 비용, 단위: 원 → $ 변환 적용) |
| **표시 방식** | 파란색 점(marker='o', size=8)     |                                                        |
| **표시 조건** | x, y 값 모두 존재 시만 출력       |                                                        |

---

**🧩 Trendline (회귀선)**

| **항목**                | **경로**                                         | **설명**                                |
| :---------------------- | :----------------------------------------------- | :-------------------------------------- |
| **기울기 (Slope, m)**   | Output_EE1.csv → H열 3행                         | 회귀식 ( y = m \times x + b ) 의 기울기 |
| **절편 (Intercept, b)** | Output_EE1.csv → H열 4행                         | 회귀식 ( y = m \times x + b ) 의 절편   |
| **표시 방식**           | 빨간색 선(color='r', linewidth=2)                |                                         |
| **표시식**              | y = m\*x + b 로 계산된 추세선                    |                                         |
| **식 표시**             | 그래프 상단 오른쪽에 y = mx + b 형태로 자동 표시 |                                         |
| **계산 방식**           | Python 예시 → trend_y = m \* x + b               |                                         |

---

**🔹 3️⃣ 그래프 계산 로직 (의사코드)**

import pandas as pd

import matplotlib.pyplot as plt

import numpy as np

\# 1. 데이터 로드

input_df = pd.read_excel('Input_Total.xlsx', sheet_name=0)

output_df = pd.read_csv('Output_EE1.csv')

\# 2. Data Point 추출

x_vals = input_df.iloc[359:374, 1].dropna() # B열(360~374행)

y_vals = input_df.iloc[374:389, 1].dropna() # B열(375~389행)

\# 3. Trendline 계수 불러오기

slope = output_df.iloc[2, 7] # H열(3행)

intercept = output_df.iloc[3, 7] # H열(4행)

\# 4. 추세선 계산

trend_y = slope \* x_vals + intercept

\# 5. 그래프 생성

plt.figure(figsize=(6,5))

plt.scatter(x_vals, y_vals, color='blue', label='Data Points')

plt.plot(x_vals, trend_y, color='red', label='Trendline')

plt.xlabel('bhp')

plt.ylabel('Total Uninstalled Cost ($)')

plt.title('Price by Capacity of Electric Power Facilities')

plt.legend()

plt.grid(True)

plt.show()

---

**🔹 4️⃣ 요구 기능 리스트**

| **기능 ID** | **기능명**         | **기능 설명**                                             |
| :---------- | :----------------- | :-------------------------------------------------------- |
| **F8301**   | 그래프 생성        | Input_Total.xlsx & Output_EE1.csv 기반 그래프 자동 렌더링 |
| **F8302**   | Trendline 표시     | 회귀식 계수(H열 3~4행) 기반 y=mx+b 선형 그래프 출력       |
| **F8303**   | Data Point 표시    | 0이 아닌 x, y 데이터 포인트 파란색 점으로 출력            |
| **F8304**   | 단위 변환          | Dal2Won 환산 비율 반영 ($ 변환 시 1450 기준)              |
| **F8305**   | 그래프 제목 표시   | "Price by Capacity of Electric Power Facilities"          |
| **F8306**   | 범례 표시          | "Data Points", "Trendline" 표시                           |
| **F8307**   | 축 라벨 표시       | X: bhp / Y: Total Uninstalled Cost ($)                    |
| **F8308**   | 그래프 저장        | “저장” 버튼 클릭 시 JPG/PNG로 저장                        |
| **F8309**   | 팝업 닫기          | “닫기” 클릭 시 그래프 결과 팝업 종료                      |
| **F8310**   | 오토 스케일링      | X, Y축 데이터 범위 자동 계산 후 여백 추가 표시            |
| **F8311**   | 수식 표시          | 그래프 우상단에 회귀식(기울기, 절편) 자동 표시            |
| **F8312**   | 이미지 파일명 규칙 | PlotPriceElec_YYYYMMDD_HHMM.png 자동 생성                 |

---

**🔹 5️⃣ 그래프 저장 기능**

| **항목**           | **내용**                                     |
| :----------------- | :------------------------------------------- |
| **저장 버튼 기능** | 현재 그래프 화면을 이미지로 캡처 및 저장     |
| **파일 형식 선택** | PNG (기본) / JPG (선택)                      |
| **저장 경로**      | C:\Users\<User>\Documents\EcoGraphs\|        |
| **파일명 규칙**    | PlotPriceElec\_[YYYYMMDD\_HHMM].png          |
| **저장 시 알림**   | “그래프가 성공적으로 저장되었습니다.” 표시   |
| **에러 처리**      | 경로 접근 불가, 파일권한 오류 시 경고창 출력 |

---

---

**📊 [탭 ID: PlotPriceLqTk]**

**그래프명:** Trendline on LH₂ Tank Price Based on Capacity\
**그래프 종류:** 2D Line + Scatter (Trendline 포함)

---

**🔹 1️⃣ 그래프 기본 정보**

| **항목**             | **값**                                                                 |
| :------------------- | :--------------------------------------------------------------------- |
| **그래프 타입**      | 2D Line Plot + Scatter (Trendline 포함)                                |
| **그래프 제목**      | Trendline on LH₂ Tank Price Based on Capacity                          |
| **X축 제목**         | LH₂Tk Capacity (m³)                                                    |
| **Y축 제목**         | Total Uninstalled Cost ($K)                                            |
| **단위 변환**        | 원 → 달러 ($) 변환 시 Dal2Won = 1450 적용 후 1,000 단위 축소 표시 ($K) |
| **그래프 색상 규칙** | 데이터 포인트: 파란색 ● / 추세선: 빨간색 선                            |
| **그래프 범례**      | Blue Circle → Data Points / Red Line → Trendline                       |
| **축 라벨 포맷**     | 3자리 콤마 구분 표시, y단위는 “×10³” 형식                              |
| **배경색**           | 흰색 (#FFFFFF)                                                         |
| **범례 위치**        | 우상단 (upper right)                                                   |
| **추세식 표시 위치** | 그래프 중앙 왼쪽 (y=mx+b 형태 표시)                                    |

---

**🔹 2️⃣ 입력 데이터 매핑**

**📁 데이터 파일 참조**

- **입력 파일:** Input_Total.xlsx
- **회귀계수 파일:** Output_EE1.csv

---

**🧩 Data Points (Scatter Plot)**

| **데이터**    | **경로**                                     | **내용**                                                      |
| :------------ | :------------------------------------------- | :------------------------------------------------------------ |
| **x값**       | Input_Total.xlsx → B열 (391~405행)           | 0을 제외한 데이터 사용 (LH₂ 탱크 용량, 단위: m³)              |
| **y값**       | Input_Total.xlsx → B열 (406~420행)           | 0을 제외한 데이터 사용 (LH₂ 탱크 설비비용, 단위: 원 → $ 변환) |
| **표시 방식** | 파란색 점 (marker='o', size=8, color='blue') |                                                               |
| **표시 조건** | x, y 값이 모두 0이 아닐 때만 표시            |                                                               |

---

**🧩 Trendline (회귀선)**

| **항목**                | **경로**                                                   | **설명**                                |
| :---------------------- | :--------------------------------------------------------- | :-------------------------------------- |
| **기울기 (Slope, m)**   | Output_EE1.csv → E열 3행                                   | 회귀식 ( y = m \times x + b ) 의 기울기 |
| **절편 (Intercept, b)** | Output_EE1.csv → E열 4행                                   | 회귀식 ( y = m \times x + b ) 의 절편   |
| **표시 방식**           | 빨간색 선 (color='r', linewidth=2)                         |                                         |
| **표시식**              | 그래프 내부에 y = mx + b 표시 (폰트: Arial, 크기 12, Bold) |                                         |
| **계산식**              | trend_y = m \* x_vals + b                                  |                                         |
| **표시 단위**           | $K (천 달러 단위)`                                         |                                         |

---

**🔹 3️⃣ 그래프 계산 로직 (의사코드 예시)**

import pandas as pd

import matplotlib.pyplot as plt

import numpy as np

\# 1. 데이터 로드

input_df = pd.read_excel('Input_Total.xlsx', sheet_name=0)

output_df = pd.read_csv('Output_EE1.csv')

\# 2. Data Point 추출

x_vals = input_df.iloc[390:405, 1].replace(0, np.nan).dropna() # B열(391~405행)

y_vals = input_df.iloc[405:420, 1].replace(0, np.nan).dropna() # B열(406~420행)

\# 단위 변환 (원 → 달러($) → 천 단위)

Dal2Won = 1450

y_vals = (y_vals / Dal2Won) / 1000

\# 3. Trendline 계수

slope = output_df.iloc[2, 4] # E열(3행)

intercept = output_df.iloc[3, 4] # E열(4행)

\# 4. 추세선 계산

trend_y = slope \* x_vals + intercept

\# 5. 그래프 생성

plt.figure(figsize=(6,5))

plt.scatter(x_vals, y_vals, color='blue', label='Data Points')

plt.plot(x_vals, trend_y, color='red', label='Trendline')

plt.text(0.3\*max(x_vals), 0.5\*max(y_vals),

`         `f"y = {slope:.4f}x + {intercept:.4f}",

`         `fontsize=12, color='black', fontweight='bold')

plt.xlabel('LH2Tk Capacity (m³)')

plt.ylabel('Total Uninstalled Cost ($K)')

plt.title('Trendline on LH2 Tank Price Based on Capacity')

plt.legend()

plt.grid(True)

plt.show()

---

**🔹 4️⃣ 요구 기능 리스트**

| **기능 ID** | **기능명**       | **기능 설명**                                              |
| :---------- | :--------------- | :--------------------------------------------------------- |
| **F8351**   | 그래프 생성      | Input_Total.xlsx 및 Output_EE1.csv 기반 그래프 자동 렌더링 |
| **F8352**   | Trendline 표시   | E열(3~4행) 기반 y=mx+b 추세선 출력                         |
| **F8353**   | Data Point 표시  | 0이 아닌 x, y 데이터 포인트 파란색 점으로 출력             |
| **F8354**   | 단위 변환        | Dal2Won 적용 후 천 단위 ($K) 변환                          |
| **F8355**   | 추세식 표시      | 그래프 내부에 y=mx+b 수식 텍스트로 출력                    |
| **F8356**   | 축 라벨 표시     | X: LH2Tk Capacity (m³) / Y: Total Uninstalled Cost ($K)    |
| **F8357**   | 범례 표시        | Data Points, Trendline 항목 표시                           |
| **F8358**   | 그래프 저장      | “저장” 클릭 시 JPG/PNG로 그래프 캡처 및 저장               |
| **F8359**   | 저장 파일명 규칙 | PlotPriceLqTk\_[YYYYMMDD\_HHMM].png                        |
| **F8360**   | 팝업 닫기        | “닫기” 클릭 시 그래프 결과 팝업 종료                       |
| **F8361**   | 오토 스케일링    | X, Y 범위 자동 계산 및 10% 여백 반영                       |
| **F8362**   | 단위 표기 자동화 | y축 단위($K) 자동 변환                                     |
| **F8363**   | 회귀값 업데이트  | Output_EE1.csv 값 변경 시 즉시 반영                        |

---

**🔹 5️⃣ 그래프 저장 기능**

| **항목**           | **내용**                                            |
| :----------------- | :-------------------------------------------------- |
| **저장 버튼 기능** | 현재 그래프 이미지를 PNG/JPG 형식으로 저장          |
| **파일명 규칙**    | PlotPriceLqTk\_[YYYYMMDD\_HHMM].png                 |
| **저장 경로**      | C:\Users\<User>\Documents\EcoGraphs\|               |
| **기본 포맷**      | PNG                                                 |
| **피드백 메시지**  | “PlotPriceLqTk 그래프가 성공적으로 저장되었습니다.” |
| **에러 처리**      | 파일 권한 및 경로 오류 발생 시 경고창 표시          |

---

---

**📊 [탭 ID: PlotPriceLqPp]**

**그래프명:** Trendline on LH₂ Pump Price Based on Capacity\
**그래프 종류:** 2D Line + Scatter (Trendline 포함)

---

**🔹 1️⃣ 그래프 기본 정보**

| **항목**             | **값**                                                              |
| :------------------- | :------------------------------------------------------------------ |
| **그래프 타입**      | 2D Line Plot + Scatter (Trendline 포함)                             |
| **그래프 제목**      | Trendline on LH₂ Pump Price Based on Capacity                       |
| **X축 제목**         | LH₂ Pump Capacity (kg/h)                                            |
| **Y축 제목**         | Total Uninstalled Cost ($K)                                         |
| **단위 변환**        | 원 → 달러 ($) 변환 시 Dal2Won = 1450 적용 후 천 단위 축소 표시 ($K) |
| **그래프 색상 규칙** | Data Points: 파란색 ● / Trendline: 빨간색 선                        |
| **그래프 범례**      | Blue Circle → Data Points / Red Line → Trendline                    |
| **축 라벨 포맷**     | 3자리 콤마 구분 표시, y단위는 “×10³” 형식                           |
| **배경색**           | 흰색 (#FFFFFF)                                                      |
| **범례 위치**        | 우상단 (upper right)                                                |
| **추세식 표시 위치** | 그래프 중앙 왼쪽 (y=mx+b 형태 표시)                                 |

---

**🔹 2️⃣ 입력 데이터 매핑**

**📁 데이터 파일 참조**

- **입력 파일:** Input_Total.xlsx
- **회귀계수 파일:** Output_EE1.csv

---

**🧩 Data Points (Scatter Plot)**

| **데이터**    | **경로**                                     | **내용**                                                  |
| :------------ | :------------------------------------------- | :-------------------------------------------------------- |
| **x값**       | Input_Total.xlsx → B열 (422~436행)           | 0을 제외한 값 사용 (LH₂ 펌프 용량, 단위: kg/h)            |
| **y값**       | Input_Total.xlsx → B열 (437~451행)           | 0을 제외한 값 사용 (LH₂ 펌프 설비비용, 단위: 원 → $ 변환) |
| **표시 방식** | 파란색 점 (marker='o', size=8, color='blue') |                                                           |
| **표시 조건** | x, y 값 모두 0이 아닐 때만 출력              |                                                           |

---

**🧩 Trendline (회귀선)**

| **항목**                | **경로**                                                          | **설명**                                |
| :---------------------- | :---------------------------------------------------------------- | :-------------------------------------- |
| **기울기 (Slope, m)**   | Output_EE1.csv → F열 3행                                          | 회귀식 ( y = m \times x + b ) 의 기울기 |
| **절편 (Intercept, b)** | Output_EE1.csv → F열 4행                                          | 회귀식 ( y = m \times x + b ) 의 절편   |
| **표시 방식**           | 빨간색 선 (color='r', linewidth=2)                                |                                         |
| **표시식**              | 그래프 내부에 y = mx + b 형태로 표시 (폰트: Arial, 크기 12, Bold) |                                         |
| **계산식**              | trend_y = m \* x_vals + b                                         |                                         |
| **표시 단위**           | $K (천 달러 단위)`                                                |                                         |

---

**🔹 3️⃣ 그래프 계산 로직 (의사코드 예시)**

import pandas as pd

import matplotlib.pyplot as plt

import numpy as np

\# 1. 데이터 로드

input_df = pd.read_excel('Input_Total.xlsx', sheet_name=0)

output_df = pd.read_csv('Output_EE1.csv')

\# 2. Data Point 추출

x_vals = input_df.iloc[421:436, 1].replace(0, np.nan).dropna() # B열(422~436행)

y_vals = input_df.iloc[436:451, 1].replace(0, np.nan).dropna() # B열(437~451행)

\# 단위 변환 (원 → 달러($) → 천 단위)

Dal2Won = 1450

y_vals = (y_vals / Dal2Won) / 1000

\# 3. Trendline 계수

slope = output_df.iloc[2, 5] # F열(3행)

intercept = output_df.iloc[3, 5] # F열(4행)

\# 4. 추세선 계산

trend_y = slope \* x_vals + intercept

\# 5. 그래프 생성

plt.figure(figsize=(6,5))

plt.scatter(x_vals, y_vals, color='blue', label='Data Points')

plt.plot(x_vals, trend_y, color='red', label='Trendline')

plt.text(0.2\*max(x_vals), 0.6\*max(y_vals),

`         `f"y = {slope:.4f}x + {intercept:.4f}",

`         `fontsize=12, color='black', fontweight='bold')

plt.xlabel('LH2 Pump Capacity (kg/h)')

plt.ylabel('Total Uninstalled Cost ($K)')

plt.title('Trendline on LH2 Pump Price Based on Capacity')

plt.legend()

plt.grid(True)

plt.show()

---

**🔹 4️⃣ 요구 기능 리스트**

| **기능 ID** | **기능명**       | **기능 설명**                                                |
| :---------- | :--------------- | :----------------------------------------------------------- |
| **F8371**   | 그래프 생성      | Input_Total.xlsx 및 Output_EE1.csv 기반 그래프 자동 렌더링   |
| **F8372**   | Trendline 표시   | F열(3~4행) 기반 y=mx+b 추세선 출력                           |
| **F8373**   | Data Point 표시  | 0이 아닌 x, y 데이터 포인트 파란색 점으로 출력               |
| **F8374**   | 단위 변환        | Dal2Won 적용 후 천 단위($K) 변환                             |
| **F8375**   | 추세식 표시      | 그래프 내부에 y=mx+b 수식 텍스트로 출력                      |
| **F8376**   | 축 라벨 표시     | X: LH2 Pump Capacity (kg/h) / Y: Total Uninstalled Cost ($K) |
| **F8377**   | 범례 표시        | Data Points, Trendline 항목 표시                             |
| **F8378**   | 그래프 저장      | “저장” 클릭 시 JPG/PNG로 그래프 캡처 및 저장                 |
| **F8379**   | 저장 파일명 규칙 | PlotPriceLqPp\_[YYYYMMDD\_HHMM].png                          |
| **F8380**   | 팝업 닫기        | “닫기” 클릭 시 그래프 결과 팝업 종료                         |
| **F8381**   | 오토 스케일링    | X, Y 범위 자동 계산 및 10% 여백 반영                         |
| **F8382**   | 단위 표기 자동화 | y축 단위($K) 자동 변환                                       |
| **F8383**   | 회귀값 업데이트  | Output_EE1.csv 값 변경 시 즉시 반영                          |

---

**🔹 5️⃣ 그래프 저장 기능**

| **항목**           | **내용**                                            |
| :----------------- | :-------------------------------------------------- |
| **저장 버튼 기능** | 현재 그래프 이미지를 PNG/JPG 형식으로 저장          |
| **파일명 규칙**    | PlotPriceLqPp\_[YYYYMMDD\_HHMM].png                 |
| **저장 경로**      | C:\Users\<User>\Documents\EcoGraphs\|               |
| **기본 포맷**      | PNG                                                 |
| **피드백 메시지**  | “PlotPriceLqPp 그래프가 성공적으로 저장되었습니다.” |
| **에러 처리**      | 파일 권한 또는 경로 접근 오류 시 경고창 표시        |

---

좋아요 👌\
이제 이어서 \*\*PlotPriceLqVap 탭 (액화수소 기화기 가격 추이)\*\*에 대한 설계 명세를 이전 탭들과 동일한 형식으로 정리해드릴게요.\
이 사양은 UI 및 계산 엔진 양쪽에서 바로 반영 가능한 완전한 설계 문서입니다.

---

**📊 [탭 ID: PlotPriceLqVap]**

**그래프명:** Trendline on LH₂ Vaporizer Price Based on Capacity\
**그래프 종류:** 2D Line + Scatter (Trendline 포함)

---

**🔹 1️⃣ 그래프 기본 정보**

| **항목**             | **값**                                                              |
| :------------------- | :------------------------------------------------------------------ |
| **그래프 타입**      | 2D Line Plot + Scatter (Trendline 포함)                             |
| **그래프 제목**      | Trendline on LH₂ Vaporizer Price Based on Capacity                  |
| **X축 제목**         | LH₂ Vaporizer Capacity (kg/h)                                       |
| **Y축 제목**         | Total Uninstalled Cost ($K)                                         |
| **단위 변환**        | 원 → 달러 ($) 변환 시 Dal2Won = 1450 적용 후 천 단위 축소 표시 ($K) |
| **그래프 색상 규칙** | Data Points: 파란색 ● / Trendline: 빨간색 선                        |
| **그래프 범례**      | Blue Circle → Data Points / Red Line → Trendline                    |
| **축 라벨 포맷**     | 3자리 콤마 구분 표시, y단위는 “×10³” 형식                           |
| **배경색**           | 흰색 (#FFFFFF)                                                      |
| **범례 위치**        | 우상단 (upper right)                                                |
| **추세식 표시 위치** | 그래프 중앙 왼쪽 (y=mx+b 형태 표시)                                 |

---

**🔹 2️⃣ 입력 데이터 매핑**

**📁 데이터 파일 참조**

- **입력 파일:** Input_Total.xlsx
- **회귀계수 파일:** Output_EE1.csv

---

**🧩 Data Points (Scatter Plot)**

| **데이터**    | **경로**                                     | **내용**                                                    |
| :------------ | :------------------------------------------- | :---------------------------------------------------------- |
| **x값**       | Input_Total.xlsx → B열 (453~467행)           | 0을 제외한 값 사용 (LH₂ 기화기 용량, 단위: kg/h)            |
| **y값**       | Input_Total.xlsx → B열 (468~482행)           | 0을 제외한 값 사용 (LH₂ 기화기 설비비용, 단위: 원 → $ 변환) |
| **표시 방식** | 파란색 점 (marker='o', size=8, color='blue') |                                                             |
| **표시 조건** | x, y 값이 모두 0이 아닐 때만 출력            |                                                             |

---

**🧩 Trendline (회귀선)**

| **항목**                | **경로**                                                   | **설명**                                |
| :---------------------- | :--------------------------------------------------------- | :-------------------------------------- |
| **기울기 (Slope, m)**   | Output_EE1.csv → G열 3행                                   | 회귀식 ( y = m \times x + b ) 의 기울기 |
| **절편 (Intercept, b)** | Output_EE1.csv → G열 4행                                   | 회귀식 ( y = m \times x + b ) 의 절편   |
| **표시 방식**           | 빨간색 선 (color='r', linewidth=2)                         |                                         |
| **표시식**              | 그래프 내부에 y = mx + b 표시 (폰트: Arial, 크기 12, Bold) |                                         |
| **계산식**              | trend_y = m \* x_vals + b                                  |                                         |
| **표시 단위**           | $K (천 달러 단위)`                                         |                                         |

---

**🔹 3️⃣ 그래프 계산 로직 (의사코드 예시)**

import pandas as pd

import matplotlib.pyplot as plt

import numpy as np

\# 1. 데이터 로드

input_df = pd.read_excel('Input_Total.xlsx', sheet_name=0)

output_df = pd.read_csv('Output_EE1.csv')

\# 2. Data Point 추출

x_vals = input_df.iloc[452:467, 1].replace(0, np.nan).dropna() # B열(453~467행)

y_vals = input_df.iloc[467:482, 1].replace(0, np.nan).dropna() # B열(468~482행)

\# 단위 변환 (원 → 달러($) → 천 단위)

Dal2Won = 1450

y_vals = (y_vals / Dal2Won) / 1000

\# 3. Trendline 계수

slope = output_df.iloc[2, 6] # G열(3행)

intercept = output_df.iloc[3, 6] # G열(4행)

\# 4. 추세선 계산

trend_y = slope \* x_vals + intercept

\# 5. 그래프 생성

plt.figure(figsize=(6,5))

plt.scatter(x_vals, y_vals, color='blue', label='Data Points')

plt.plot(x_vals, trend_y, color='red', label='Trendline')

plt.text(0.25\*max(x_vals), 0.55\*max(y_vals),

`         `f"y = {slope:.4f}x + {intercept:.4f}",

`         `fontsize=12, color='black', fontweight='bold')

plt.xlabel('LH2 Vaporizer Capacity (kg/h)')

plt.ylabel('Total Uninstalled Cost ($K)')

plt.title('Trendline on LH2 Vaporizer Price Based on Capacity')

plt.legend()

plt.grid(True)

plt.show()

---

**🔹 4️⃣ 요구 기능 리스트**

| **기능 ID** | **기능명**       | **기능 설명**                                                     |
| :---------- | :--------------- | :---------------------------------------------------------------- |
| **F8391**   | 그래프 생성      | Input_Total.xlsx 및 Output_EE1.csv 기반 그래프 자동 렌더링        |
| **F8392**   | Trendline 표시   | G열(3~4행) 기반 y=mx+b 추세선 출력                                |
| **F8393**   | Data Point 표시  | 0이 아닌 x, y 데이터 포인트 파란색 점으로 출력                    |
| **F8394**   | 단위 변환        | Dal2Won 적용 후 천 단위($K) 변환                                  |
| **F8395**   | 추세식 표시      | 그래프 내부에 y=mx+b 수식 텍스트로 출력                           |
| **F8396**   | 축 라벨 표시     | X: LH₂ Vaporizer Capacity (kg/h) / Y: Total Uninstalled Cost ($K) |
| **F8397**   | 범례 표시        | Data Points, Trendline 항목 표시                                  |
| **F8398**   | 그래프 저장      | “저장” 클릭 시 JPG/PNG로 그래프 캡처 및 저장                      |
| **F8399**   | 저장 파일명 규칙 | PlotPriceLqVap\_[YYYYMMDD\_HHMM].png                              |
| **F8400**   | 팝업 닫기        | “닫기” 클릭 시 그래프 결과 팝업 종료                              |
| **F8401**   | 오토 스케일링    | X, Y 범위 자동 계산 및 10% 여백 반영                              |
| **F8402**   | 단위 표기 자동화 | y축 단위($K) 자동 변환                                            |
| **F8403**   | 회귀값 업데이트  | Output_EE1.csv 값 변경 시 즉시 반영                               |

---

**🔹 5️⃣ 그래프 저장 기능**

| **항목**           | **내용**                                             |
| :----------------- | :--------------------------------------------------- |
| **저장 버튼 기능** | 현재 그래프 이미지를 PNG/JPG 형식으로 저장           |
| **파일명 규칙**    | PlotPriceLqVap\_[YYYYMMDD\_HHMM].png                 |
| **저장 경로**      | C:\Users\<User>\Documents\EcoGraphs\|                |
| **기본 포맷**      | PNG                                                  |
| **피드백 메시지**  | “PlotPriceLqVap 그래프가 성공적으로 저장되었습니다.” |
| **에러 처리**      | 파일 권한 또는 경로 접근 오류 시 경고창 표시         |

---

---

**📊 [탭 ID: PlotPriceCp]**

**그래프명:** Trendline on Compressor Price Based on Capacity\
**그래프 종류:** 2D Line + Scatter (Trendline 포함)

---

**🔹 1️⃣ 그래프 기본 정보**

| **항목**             | **값**                                           |
| :------------------- | :----------------------------------------------- |
| **그래프 타입**      | 2D Line Plot + Scatter (Trendline 포함)          |
| **그래프 제목**      | Trendline on Compressor Price Based on Capacity  |
| **X축 제목**         | Comp. Capacity (kg/h)                            |
| **Y축 제목**         | Total Uninstalled Cost (M KRW)                   |
| **단위 변환**        | 원 → 백만원(M KRW) 단위로 변환 (/1,000,000)      |
| **그래프 색상 규칙** | 데이터 포인트: 파란색 ● / 추세선: 빨간색 선      |
| **그래프 범례**      | Blue Circle → Data Points / Red Line → Trendline |
| **축 라벨 포맷**     | 3자리 콤마 구분 표시, y단위는 “×10⁶” 형식        |
| **배경색**           | 흰색 (#FFFFFF)                                   |
| **범례 위치**        | 우하단 (lower right)                             |
| **추세식 표시 위치** | 그래프 좌측 중간 영역 (y=mx+b 형태 표시)         |

---

**🔹 2️⃣ 입력 데이터 매핑**

**📁 데이터 파일 참조**

- **입력 파일:** Input_Total.xlsx
- **회귀계수 파일:** Output_EE1.csv

---

**🧩 Data Points (Scatter Plot)**

| **데이터**    | **경로**                                     | **내용**                                                            |
| :------------ | :------------------------------------------- | :------------------------------------------------------------------ |
| **x값**       | Input_Total.xlsx → B열 (484~498행)           | 0을 제외한 값 사용 (압축기 용량, 단위: kg/h)                        |
| **y값**       | Input_Total.xlsx → B열 (499~513행)           | 0을 제외한 값 사용 (압축기 설비비용, 단위: 원 → 백만원(M KRW) 변환) |
| **표시 방식** | 파란색 점 (marker='o', size=8, color='blue') |                                                                     |
| **표시 조건** | x, y 값이 모두 0이 아닐 때만 표시            |                                                                     |

---

**🧩 Trendline (회귀선)**

| **항목**                | **경로**                                                   | **설명**                                |
| :---------------------- | :--------------------------------------------------------- | :-------------------------------------- |
| **기울기 (Slope, m)**   | Output_EE1.csv → A열 3행                                   | 회귀식 ( y = m \times x + b ) 의 기울기 |
| **절편 (Intercept, b)** | Output_EE1.csv → A열 4행                                   | 회귀식 ( y = m \times x + b ) 의 절편   |
| **표시 방식**           | 빨간색 선 (color='r', linewidth=2)                         |                                         |
| **표시식**              | 그래프 내부에 y = mx + b 표시 (폰트: Arial, 크기 12, Bold) |                                         |
| **계산식**              | trend_y = m \* x_vals + b                                  |                                         |
| **표시 단위**           | M KRW (백만원 단위)                                        |                                         |

---

**🔹 3️⃣ 그래프 계산 로직 (의사코드 예시)**

import pandas as pd

import matplotlib.pyplot as plt

import numpy as np

\# 1. 데이터 로드

input_df = pd.read_excel('Input_Total.xlsx', sheet_name=0)

output_df = pd.read_csv('Output_EE1.csv')

\# 2. Data Point 추출

x_vals = input_df.iloc[483:498, 1].replace(0, np.nan).dropna() # B열(484~498행)

y_vals = input_df.iloc[498:513, 1].replace(0, np.nan).dropna() # B열(499~513행)

\# 단위 변환 (원 → 백만원)

y_vals = y_vals / 1_000_000

\# 3. Trendline 계수

slope = output_df.iloc[2, 0] # A열(3행)

intercept = output_df.iloc[3, 0] # A열(4행)

\# 4. 추세선 계산

trend_y = slope \* x_vals + intercept

\# 5. 그래프 생성

plt.figure(figsize=(6,5))

plt.scatter(x_vals, y_vals, color='blue', label='Data Points')

plt.plot(x_vals, trend_y, color='red', label='Trendline')

plt.text(0.15\*max(x_vals), 0.6\*max(y_vals),

`         `f"y = {slope:.4f}x + {intercept:.4f}",

`         `fontsize=12, color='black', fontweight='bold')

plt.xlabel('Comp. Capacity (kg/h)')

plt.ylabel('Total Uninstalled Cost (M KRW)')

plt.title('Trendline on Compressor Price Based on Capacity')

plt.legend()

plt.grid(True)

plt.show()

---

**🔹 4️⃣ 요구 기능 리스트**

| **기능 ID** | **기능명**       | **기능 설명**                                                |
| :---------- | :--------------- | :----------------------------------------------------------- |
| **F8411**   | 그래프 생성      | Input_Total.xlsx 및 Output_EE1.csv 기반 그래프 자동 렌더링   |
| **F8412**   | Trendline 표시   | A열(3~4행) 기반 y=mx+b 추세선 출력                           |
| **F8413**   | Data Point 표시  | 0이 아닌 x, y 데이터 포인트 파란색 점으로 출력               |
| **F8414**   | 단위 변환        | 원 단위를 백만원(M KRW) 단위로 변환                          |
| **F8415**   | 추세식 표시      | 그래프 내부에 y=mx+b 수식 텍스트로 출력                      |
| **F8416**   | 축 라벨 표시     | X: Comp. Capacity (kg/h) / Y: Total Uninstalled Cost (M KRW) |
| **F8417**   | 범례 표시        | Data Points, Trendline 항목 표시                             |
| **F8418**   | 그래프 저장      | “저장” 클릭 시 JPG/PNG로 그래프 캡처 및 저장                 |
| **F8419**   | 저장 파일명 규칙 | PlotPriceCp\_[YYYYMMDD\_HHMM].png                            |
| **F8420**   | 팝업 닫기        | “닫기” 클릭 시 그래프 결과 팝업 종료                         |
| **F8421**   | 오토 스케일링    | X, Y 범위 자동 계산 및 10% 여백 반영                         |
| **F8422**   | 단위 표기 자동화 | y축 단위(M KRW) 자동 변환                                    |
| **F8423**   | 회귀값 업데이트  | Output_EE1.csv 값 변경 시 즉시 반영                          |

---

**🔹 5️⃣ 그래프 저장 기능**

| **항목**           | **내용**                                          |
| :----------------- | :------------------------------------------------ |
| **저장 버튼 기능** | 현재 그래프 이미지를 PNG/JPG 형식으로 저장        |
| **파일명 규칙**    | PlotPriceCp\_[YYYYMMDD\_HHMM].png                 |
| **저장 경로**      | C:\Users\<User>\Documents\EcoGraphs\|             |
| **기본 포맷**      | PNG                                               |
| **피드백 메시지**  | “PlotPriceCp 그래프가 성공적으로 저장되었습니다.” |
| **에러 처리**      | 파일 권한 또는 경로 접근 오류 시 경고창 표시      |

---

---

**📊 [탭 ID: PlotPriceLBkBuf]**

**그래프명:** Trendline on Buf/LBk Price Based on Capacity\
**그래프 종류:** 2D Line + Scatter (Trendline 포함)

---

**🔹 1️⃣ 그래프 기본 정보**

| **항목**             | **값**                                           |
| :------------------- | :----------------------------------------------- |
| **그래프 타입**      | 2D Line Plot + Scatter (Trendline 포함)          |
| **그래프 제목**      | Trendline on Buf/LBk Price Based on Capacity     |
| **X축 제목**         | Buf or LBk Capacity (kg)                         |
| **Y축 제목**         | Total Uninstalled Cost (M KRW)                   |
| **단위 변환**        | 원 → 백만원(M KRW) 단위 (/1,000,000)             |
| **그래프 색상 규칙** | Data Points: 파란색 ● / Trendline: 빨간색 선     |
| **그래프 범례**      | Blue Circle → Data Points / Red Line → Trendline |
| **축 라벨 포맷**     | 3자리 콤마 구분, y축 단위는 “×10⁶” 형식          |
| **배경색**           | 흰색 (#FFFFFF)                                   |
| **범례 위치**        | 우상단 (upper right)                             |
| **추세식 표시 위치** | 그래프 중앙 왼쪽 (y=mx+b 형태 표시)              |

---

**🔹 2️⃣ 입력 데이터 매핑**

**📁 데이터 파일 참조**

- **입력 파일:** Input_Total.xlsx
- **회귀계수 파일:** Output_EE1.csv

---

**🧩 Data Points (Scatter Plot)**

| **데이터**    | **경로**                                     | **내용**                                                                      |
| :------------ | :------------------------------------------- | :---------------------------------------------------------------------------- |
| **x값**       | Input_Total.xlsx → B열 (515~529행)           | 0을 제외한 값 사용 (저압뱅크 및 버퍼 용량, 단위: kg)                          |
| **y값**       | Input_Total.xlsx → B열 (530~544행)           | 0을 제외한 값 사용 (저압뱅크 및 버퍼 설비비용, 단위: 원 → 백만원(M KRW) 변환) |
| **표시 방식** | 파란색 점 (marker='o', size=8, color='blue') |                                                                               |
| **표시 조건** | x, y 값이 모두 0이 아닐 때만 출력            |                                                                               |

---

**🧩 Trendline (회귀선)**

| **항목**                | **경로**                                                   | **설명**                                |
| :---------------------- | :--------------------------------------------------------- | :-------------------------------------- |
| **기울기 (Slope, m)**   | Output_EE1.csv → B열 3행                                   | 회귀식 ( y = m \times x + b ) 의 기울기 |
| **절편 (Intercept, b)** | Output_EE1.csv → B열 4행                                   | 회귀식 ( y = m \times x + b ) 의 절편   |
| **표시 방식**           | 빨간색 선 (color='r', linewidth=2)                         |                                         |
| **표시식**              | 그래프 내부에 y = mx + b 표시 (폰트: Arial, 크기 12, Bold) |                                         |
| **계산식**              | trend_y = m \* x_vals + b                                  |                                         |
| **표시 단위**           | M KRW (백만원 단위)                                        |                                         |

---

**🔹 3️⃣ 그래프 계산 로직 (의사코드 예시)**

import pandas as pd

import matplotlib.pyplot as plt

import numpy as np

\# 1. 데이터 로드

input_df = pd.read_excel('Input_Total.xlsx', sheet_name=0)

output_df = pd.read_csv('Output_EE1.csv')

\# 2. Data Point 추출

x_vals = input_df.iloc[514:529, 1].replace(0, np.nan).dropna() # B열(515~529행)

y_vals = input_df.iloc[529:544, 1].replace(0, np.nan).dropna() # B열(530~544행)

\# 단위 변환 (원 → 백만원)

y_vals = y_vals / 1_000_000

\# 3. Trendline 계수

slope = output_df.iloc[2, 1] # B열(3행)

intercept = output_df.iloc[3, 1] # B열(4행)

\# 4. 추세선 계산

trend_y = slope \* x_vals + intercept

\# 5. 그래프 생성

plt.figure(figsize=(6,5))

plt.scatter(x_vals, y_vals, color='blue', label='Data Points')

plt.plot(x_vals, trend_y, color='red', label='Trendline')

plt.text(0.2\*max(x_vals), 0.6\*max(y_vals),

`         `f"y = {slope:.4f}x + {intercept:.4f}",

`         `fontsize=12, color='black', fontweight='bold')

plt.xlabel('Buf or LBk Capacity (kg)')

plt.ylabel('Total Uninstalled Cost (M KRW)')

plt.title('Trendline on Buf/LBk Price Based on Capacity')

plt.legend()

plt.grid(True)

plt.show()

---

**🔹 4️⃣ 요구 기능 리스트**

| **기능 ID** | **기능명**       | **기능 설명**                                                   |
| :---------- | :--------------- | :-------------------------------------------------------------- |
| **F8431**   | 그래프 생성      | Input_Total.xlsx 및 Output_EE1.csv 기반 그래프 자동 렌더링      |
| **F8432**   | Trendline 표시   | B열(3~4행) 기반 y=mx+b 추세선 출력                              |
| **F8433**   | Data Point 표시  | 0이 아닌 x, y 데이터 포인트 파란색 점으로 출력                  |
| **F8434**   | 단위 변환        | 원 단위를 백만원(M KRW) 단위로 변환                             |
| **F8435**   | 추세식 표시      | 그래프 내부에 y=mx+b 수식 텍스트로 출력                         |
| **F8436**   | 축 라벨 표시     | X: Buf or LBk Capacity (kg) / Y: Total Uninstalled Cost (M KRW) |
| **F8437**   | 범례 표시        | Data Points, Trendline 항목 표시                                |
| **F8438**   | 그래프 저장      | “저장” 클릭 시 JPG/PNG로 그래프 캡처 및 저장                    |
| **F8439**   | 저장 파일명 규칙 | PlotPriceLBkBuf\_[YYYYMMDD\_HHMM].png                           |
| **F8440**   | 팝업 닫기        | “닫기” 클릭 시 그래프 결과 팝업 종료                            |
| **F8441**   | 오토 스케일링    | X, Y 범위 자동 계산 및 10% 여백 반영                            |
| **F8442**   | 단위 표기 자동화 | y축 단위(M KRW) 자동 변환                                       |
| **F8443**   | 회귀값 업데이트  | Output_EE1.csv 값 변경 시 즉시 반영                             |

---

**🔹 5️⃣ 그래프 저장 기능**

| **항목**           | **내용**                                              |
| :----------------- | :---------------------------------------------------- |
| **저장 버튼 기능** | 현재 그래프 이미지를 PNG/JPG 형식으로 저장            |
| **파일명 규칙**    | PlotPriceLBkBuf\_[YYYYMMDD\_HHMM].png                 |
| **저장 경로**      | C:\Users\<User>\Documents\EcoGraphs\|                 |
| **기본 포맷**      | PNG                                                   |
| **피드백 메시지**  | “PlotPriceLBkBuf 그래프가 성공적으로 저장되었습니다.” |
| **에러 처리**      | 파일 권한 또는 경로 접근 오류 시 경고창 표시          |

---

---

**📊 [탭 ID: PlotPriceHBk]**

**그래프명:** Trendline on HBk Price Based on Capacity\
**그래프 종류:** 2D Line + Scatter (Trendline 포함)

---

**🔹 1️⃣ 그래프 기본 정보**

| **항목**             | **값**                                           |
| :------------------- | :----------------------------------------------- |
| **그래프 타입**      | 2D Line Plot + Scatter (Trendline 포함)          |
| **그래프 제목**      | Trendline on HBk Price Based on Capacity         |
| **X축 제목**         | MBk or HBk Capacity (kg)                         |
| **Y축 제목**         | Total Uninstalled Cost (M KRW)                   |
| **단위 변환**        | 원 → 백만원(M KRW) 단위 (/1,000,000)             |
| **그래프 색상 규칙** | Data Points: 파란색 ● / Trendline: 빨간색 선     |
| **그래프 범례**      | Blue Circle → Data Points / Red Line → Trendline |
| **축 라벨 포맷**     | 3자리 콤마 구분, y축 단위는 “×10⁶” 형식          |
| **배경색**           | 흰색 (#FFFFFF)                                   |
| **범례 위치**        | 우상단 (upper right)                             |
| **추세식 표시 위치** | 그래프 좌측 상단 (y=mx+b 형태 표시, bold black)  |

---

**🔹 2️⃣ 입력 데이터 매핑**

**📁 데이터 파일 참조**

- **입력 파일:** Input_Total.xlsx
- **회귀계수 파일:** Output_EE1.csv

---

**🧩 Data Points (Scatter Plot)**

| **데이터**    | **경로**                                     | **내용**                                                              |
| :------------ | :------------------------------------------- | :-------------------------------------------------------------------- |
| **x값**       | Input_Total.xlsx → B열 (546~560행)           | 0을 제외한 값 사용 (고압뱅크 용량, 단위: kg)                          |
| **y값**       | Input_Total.xlsx → B열 (561~575행)           | 0을 제외한 값 사용 (고압뱅크 설비비용, 단위: 원 → 백만원(M KRW) 변환) |
| **표시 방식** | 파란색 점 (marker='o', size=8, color='blue') |                                                                       |
| **표시 조건** | x, y 값이 모두 0이 아닐 때만 출력            |                                                                       |

---

**🧩 Trendline (회귀선)**

| **항목**                | **경로**                                                   | **설명**                                |
| :---------------------- | :--------------------------------------------------------- | :-------------------------------------- |
| **기울기 (Slope, m)**   | Output_EE1.csv → C열 3행                                   | 회귀식 ( y = m \times x + b ) 의 기울기 |
| **절편 (Intercept, b)** | Output_EE1.csv → C열 4행                                   | 회귀식 ( y = m \times x + b ) 의 절편   |
| **표시 방식**           | 빨간색 선 (color='r', linewidth=2)                         |                                         |
| **표시식**              | 그래프 내부에 y = mx + b 표시 (폰트: Arial, 크기 12, Bold) |                                         |
| **계산식**              | trend_y = m \* x_vals + b                                  |                                         |
| **표시 단위**           | M KRW (백만원 단위)                                        |                                         |

---

**🔹 3️⃣ 그래프 계산 로직 (의사코드 예시)**

import pandas as pd

import matplotlib.pyplot as plt

import numpy as np

\# 1. 데이터 로드

input_df = pd.read_excel('Input_Total.xlsx', sheet_name=0)

output_df = pd.read_csv('Output_EE1.csv')

\# 2. Data Point 추출

x_vals = input_df.iloc[545:560, 1].replace(0, np.nan).dropna() # B열(546~560행)

y_vals = input_df.iloc[560:575, 1].replace(0, np.nan).dropna() # B열(561~575행)

\# 단위 변환 (원 → 백만원)

y_vals = y_vals / 1_000_000

\# 3. Trendline 계수

slope = output_df.iloc[2, 2] # C열(3행)

intercept = output_df.iloc[3, 2] # C열(4행)

\# 4. 추세선 계산

trend_y = slope \* x_vals + intercept

\# 5. 그래프 생성

plt.figure(figsize=(6,5))

plt.scatter(x_vals, y_vals, color='blue', label='Data Points')

plt.plot(x_vals, trend_y, color='red', label='Trendline')

plt.text(0.15\*max(x_vals), 0.6\*max(y_vals),

`         `f"y = {slope:.4f}x + {intercept:.4f}",

`         `fontsize=12, color='black', fontweight='bold')

plt.xlabel('MBk or HBk Capacity (kg)')

plt.ylabel('Total Uninstalled Cost (M KRW)')

plt.title('Trendline on HBk Price Based on Capacity')

plt.legend()

plt.grid(True)

plt.show()

---

**🔹 4️⃣ 요구 기능 리스트**

| **기능 ID** | **기능명**       | **기능 설명**                                                   |
| :---------- | :--------------- | :-------------------------------------------------------------- |
| **F8451**   | 그래프 생성      | Input_Total.xlsx 및 Output_EE1.csv 기반 그래프 자동 렌더링      |
| **F8452**   | Trendline 표시   | C열(3~4행) 기반 y=mx+b 추세선 출력                              |
| **F8453**   | Data Point 표시  | 0이 아닌 x, y 데이터 포인트 파란색 점으로 출력                  |
| **F8454**   | 단위 변환        | 원 단위를 백만원(M KRW) 단위로 변환                             |
| **F8455**   | 추세식 표시      | 그래프 내부에 y=mx+b 수식 텍스트로 출력                         |
| **F8456**   | 축 라벨 표시     | X: MBk or HBk Capacity (kg) / Y: Total Uninstalled Cost (M KRW) |
| **F8457**   | 범례 표시        | Data Points, Trendline 항목 표시                                |
| **F8458**   | 그래프 저장      | “저장” 클릭 시 JPG/PNG로 그래프 캡처 및 저장                    |
| **F8459**   | 저장 파일명 규칙 | PlotPriceHBk\_[YYYYMMDD\_HHMM].png                              |
| **F8460**   | 팝업 닫기        | “닫기” 클릭 시 그래프 결과 팝업 종료                            |
| **F8461**   | 오토 스케일링    | X, Y 범위 자동 계산 및 10% 여백 반영                            |
| **F8462**   | 단위 표기 자동화 | y축 단위(M KRW) 자동 변환                                       |
| **F8463**   | 회귀값 업데이트  | Output_EE1.csv 값 변경 시 즉시 반영                             |

---

**🔹 5️⃣ 그래프 저장 기능**

| **항목**           | **내용**                                           |
| :----------------- | :------------------------------------------------- |
| **저장 버튼 기능** | 현재 그래프 이미지를 PNG/JPG 형식으로 저장         |
| **파일명 규칙**    | PlotPriceHBk\_[YYYYMMDD\_HHMM].png                 |
| **저장 경로**      | C:\Users\<User>\Documents\EcoGraphs\|              |
| **기본 포맷**      | PNG                                                |
| **피드백 메시지**  | “PlotPriceHBk 그래프가 성공적으로 저장되었습니다.” |
| **에러 처리**      | 파일 권한 또는 경로 접근 오류 시 경고창 표시       |

---

---

**📊 [탭 ID: PlotPriceDisp]**

**그래프명:** Trendline on Dispenser Price Based on EA\
**그래프 종류:** 2D Line + Scatter (Trendline 포함)

---

**🔹 1️⃣ 그래프 기본 정보**

| **항목**             | **값**                                           |
| :------------------- | :----------------------------------------------- |
| **그래프 타입**      | 2D Line Plot + Scatter (Trendline 포함)          |
| **그래프 제목**      | Trendline on Dispenser Price Based on EA         |
| **X축 제목**         | Dispenser (EA)                                   |
| **Y축 제목**         | Total Uninstalled Cost (M KRW)                   |
| **단위 변환**        | 원 → 백만원(M KRW) 단위 (/1,000,000)             |
| **그래프 색상 규칙** | Data Points: 파란색 ● / Trendline: 빨간색 선     |
| **그래프 범례**      | Blue Circle → Data Points / Red Line → Trendline |
| **축 라벨 포맷**     | 3자리 콤마 구분, y축 단위는 “×10⁶” 형식          |
| **배경색**           | 흰색 (#FFFFFF)                                   |
| **범례 위치**        | 우상단 (upper right)                             |
| **추세식 표시 위치** | 그래프 중앙 왼쪽 (y=mx+b 형태 표시, bold black)  |

---

**🔹 2️⃣ 입력 데이터 매핑**

**📁 데이터 파일 참조**

- **입력 파일:** Input_Total.xlsx
- **회귀계수 파일:** Output_EE1.csv

---

**🧩 Data Points (Scatter Plot)**

| **데이터**    | **경로**                                     | **내용**                                                                |
| :------------ | :------------------------------------------- | :---------------------------------------------------------------------- |
| **x값**       | Input_Total.xlsx → B열 (577~591행)           | 0을 제외한 값 사용 (수소충전기 EA 수량)                                 |
| **y값**       | Input_Total.xlsx → B열 (592~606행)           | 0을 제외한 값 사용 (수소충전기 설비비용, 단위: 원 → 백만원(M KRW) 변환) |
| **표시 방식** | 파란색 점 (marker='o', size=8, color='blue') |                                                                         |
| **표시 조건** | x, y 값이 모두 0이 아닐 때만 출력            |                                                                         |

---

**🧩 Trendline (회귀선)**

| **항목**                | **경로**                                                   | **설명**                                |
| :---------------------- | :--------------------------------------------------------- | :-------------------------------------- |
| **기울기 (Slope, m)**   | Output_EE1.csv → D열 3행                                   | 회귀식 ( y = m \times x + b ) 의 기울기 |
| **절편 (Intercept, b)** | Output_EE1.csv → D열 4행                                   | 회귀식 ( y = m \times x + b ) 의 절편   |
| **표시 방식**           | 빨간색 선 (color='r', linewidth=2)                         |                                         |
| **표시식**              | 그래프 내부에 y = mx + b 표시 (폰트: Arial, 크기 12, Bold) |                                         |
| **계산식**              | trend_y = m \* x_vals + b                                  |                                         |
| **표시 단위**           | M KRW (백만원 단위)                                        |                                         |

---

**🔹 3️⃣ 그래프 계산 로직 (의사코드 예시)**

import pandas as pd

import matplotlib.pyplot as plt

import numpy as np

\# 1. 데이터 로드

input_df = pd.read_excel('Input_Total.xlsx', sheet_name=0)

output_df = pd.read_csv('Output_EE1.csv')

\# 2. Data Point 추출

x_vals = input_df.iloc[576:591, 1].replace(0, np.nan).dropna() # B열(577~591행)

y_vals = input_df.iloc[591:606, 1].replace(0, np.nan).dropna() # B열(592~606행)

\# 단위 변환 (원 → 백만원)

y_vals = y_vals / 1_000_000

\# 3. Trendline 계수

slope = output_df.iloc[2, 3] # D열(3행)

intercept = output_df.iloc[3, 3] # D열(4행)

\# 4. 추세선 계산

trend_y = slope \* x_vals + intercept

\# 5. 그래프 생성

plt.figure(figsize=(6,5))

plt.scatter(x_vals, y_vals, color='blue', label='Data Points')

plt.plot(x_vals, trend_y, color='red', label='Trendline')

plt.text(0.2\*max(x_vals), 0.6\*max(y_vals),

`         `f"y = {slope:.4f}x + {intercept:.4f}",

`         `fontsize=12, color='black', fontweight='bold')

plt.xlabel('Dispenser (EA)')

plt.ylabel('Total Uninstalled Cost (M KRW)')

plt.title('Trendline on Dispenser Price Based on EA')

plt.legend()

plt.grid(True)

plt.show()

---

**🔹 4️⃣ 요구 기능 리스트**

| **기능 ID** | **기능명**       | **기능 설명**                                              |
| :---------- | :--------------- | :--------------------------------------------------------- |
| **F8471**   | 그래프 생성      | Input_Total.xlsx 및 Output_EE1.csv 기반 그래프 자동 렌더링 |
| **F8472**   | Trendline 표시   | D열(3~4행) 기반 y=mx+b 추세선 출력                         |
| **F8473**   | Data Point 표시  | 0이 아닌 x, y 데이터 포인트 파란색 점으로 출력             |
| **F8474**   | 단위 변환        | 원 단위를 백만원(M KRW) 단위로 변환                        |
| **F8475**   | 추세식 표시      | 그래프 내부에 y=mx+b 수식 텍스트로 출력                    |
| **F8476**   | 축 라벨 표시     | X: Dispenser (EA) / Y: Total Uninstalled Cost (M KRW)      |
| **F8477**   | 범례 표시        | Data Points, Trendline 항목 표시                           |
| **F8478**   | 그래프 저장      | “저장” 클릭 시 JPG/PNG로 그래프 캡처 및 저장               |
| **F8479**   | 저장 파일명 규칙 | PlotPriceDisp\_[YYYYMMDD\_HHMM].png                        |
| **F8480**   | 팝업 닫기        | “닫기” 클릭 시 그래프 결과 팝업 종료                       |
| **F8481**   | 오토 스케일링    | X, Y 범위 자동 계산 및 10% 여백 반영                       |
| **F8482**   | 단위 표기 자동화 | y축 단위(M KRW) 자동 변환                                  |
| **F8483**   | 회귀값 업데이트  | Output_EE1.csv 값 변경 시 즉시 반영                        |

---

**🔹 5️⃣ 그래프 저장 기능**

| **항목**           | **내용**                                            |
| :----------------- | :-------------------------------------------------- |
| **저장 버튼 기능** | 현재 그래프 이미지를 PNG/JPG 형식으로 저장          |
| **파일명 규칙**    | PlotPriceDisp\_[YYYYMMDD\_HHMM].png                 |
| **저장 경로**      | C:\Users\<User>\Documents\EcoGraphs\|               |
| **기본 포맷**      | PNG                                                 |
| **피드백 메시지**  | “PlotPriceDisp 그래프가 성공적으로 저장되었습니다.” |
| **에러 처리**      | 파일 권한 또는 경로 접근 오류 시 경고창 표시        |

---

---

**📊 [탭 ID: PlotH2Sale]**

**그래프명:** Trendline on H₂ Sale Price Based on Year\
**그래프 종류:** 2D Line + Scatter (Trendline 포함)

---

**🔹 1️⃣ 그래프 기본 정보**

| **항목**             | **값**                                               |
| :------------------- | :--------------------------------------------------- |
| **그래프 타입**      | 2D Line Plot + Scatter (Trendline 포함)              |
| **그래프 제목**      | Trendline on H₂ Sale Price Based on Year             |
| **X축 제목**         | Year                                                 |
| **Y축 제목**         | H₂ Sale Price (KRW/kg)                               |
| **단위 변환**        | 없음 (단위 KRW 그대로 유지)                          |
| **그래프 색상 규칙** | Data Points: 파란색 ● / Trendline: 빨간색 선         |
| **그래프 범례**      | Blue Circle → Data Points / Red Line → Trendline     |
| **축 라벨 포맷**     | 3자리 콤마 구분, X축은 연도 표기                     |
| **배경색**           | 흰색 (#FFFFFF)                                       |
| **범례 위치**        | 우상단 (upper right)                                 |
| **추세식 표시 위치** | 그래프 좌측 중간 영역 (y=mx+b 형태 표시, bold black) |

---

**🔹 2️⃣ 입력 데이터 매핑**

**📁 데이터 파일 참조**

- **입력 파일:** Input_Total.xlsx
- **회귀계수 파일:** Output_EE1.csv

---

**🧩 Data Points (Scatter Plot)**

| **데이터**    | **경로**                                     | **내용**                                        |
| :------------ | :------------------------------------------- | :---------------------------------------------- |
| **x값**       | Input_Total.xlsx → B열 (641~655행)           | 0을 제외한 값 사용 (연도, 단위: Year)           |
| **y값**       | Input_Total.xlsx → B열 (656~670행)           | 0을 제외한 값 사용 (H₂ 판매 단가, 단위: KRW/kg) |
| **표시 방식** | 파란색 점 (marker='o', size=8, color='blue') |                                                 |
| **표시 조건** | x, y 값이 모두 0이 아닐 때만 출력            |                                                 |

---

**🧩 Trendline (회귀선)**

| **항목**                | **경로**                                                   | **설명**                                |
| :---------------------- | :--------------------------------------------------------- | :-------------------------------------- |
| **기울기 (Slope, m)**   | Output_EE1.csv → I열 3행                                   | 회귀식 ( y = m \times x + b ) 의 기울기 |
| **절편 (Intercept, b)** | Output_EE1.csv → I열 4행                                   | 회귀식 ( y = m \times x + b ) 의 절편   |
| **표시 방식**           | 빨간색 선 (color='r', linewidth=2)                         |                                         |
| **표시식**              | 그래프 내부에 y = mx + b 표시 (폰트: Arial, 크기 12, Bold) |                                         |
| **계산식**              | trend_y = m \* x_vals + b                                  |                                         |
| **표시 단위**           | KRW/kg                                                     |                                         |

---

**🔹 3️⃣ 그래프 계산 로직 (의사코드 예시)**

import pandas as pd

import matplotlib.pyplot as plt

import numpy as np

\# 1. 데이터 로드

input_df = pd.read_excel('Input_Total.xlsx', sheet_name=0)

output_df = pd.read_csv('Output_EE1.csv')

\# 2. Data Point 추출

x_vals = input_df.iloc[640:655, 1].replace(0, np.nan).dropna() # B열(641~655행)

y_vals = input_df.iloc[655:670, 1].replace(0, np.nan).dropna() # B열(656~670행)

\# 3. Trendline 계수

slope = output_df.iloc[2, 8] # I열(3행)

intercept = output_df.iloc[3, 8] # I열(4행)

\# 4. 추세선 계산

trend_y = slope \* x_vals + intercept

\# 5. 그래프 생성

plt.figure(figsize=(6,5))

plt.scatter(x_vals, y_vals, color='blue', label='Data Points')

plt.plot(x_vals, trend_y, color='red', label='Trendline')

plt.text(min(x_vals)+2, min(y_vals)+0.8\*(max(y_vals)-min(y_vals)),

`         `f"y = {slope:.4f}x + {intercept:.4f}",

`         `fontsize=12, color='black', fontweight='bold')

plt.xlabel('Year')

plt.ylabel('H2 Sale Price (KRW/kg)')

plt.title('Trendline on H2 Sale Price Based on Year')

plt.legend()

plt.grid(True)

plt.show()

---

**🔹 4️⃣ 요구 기능 리스트**

| **기능 ID** | **기능명**       | **기능 설명**                                              |
| :---------- | :--------------- | :--------------------------------------------------------- |
| **F8491**   | 그래프 생성      | Input_Total.xlsx 및 Output_EE1.csv 기반 그래프 자동 렌더링 |
| **F8492**   | Trendline 표시   | I열(3~4행) 기반 y=mx+b 추세선 출력                         |
| **F8493**   | Data Point 표시  | 0이 아닌 x, y 데이터 포인트 파란색 점으로 출력             |
| **F8494**   | 단위 유지        | KRW 단위 그대로 표시                                       |
| **F8495**   | 추세식 표시      | 그래프 내부에 y=mx+b 수식 텍스트로 출력                    |
| **F8496**   | 축 라벨 표시     | X: Year / Y: H₂ Sale Price (KRW/kg)                        |
| **F8497**   | 범례 표시        | Data Points, Trendline 항목 표시                           |
| **F8498**   | 그래프 저장      | “저장” 클릭 시 JPG/PNG로 그래프 캡처 및 저장               |
| **F8499**   | 저장 파일명 규칙 | PlotH2Sale\_[YYYYMMDD\_HHMM].png                           |
| **F8500**   | 팝업 닫기        | “닫기” 클릭 시 그래프 결과 팝업 종료                       |
| **F8501**   | 오토 스케일링    | X, Y 범위 자동 계산 및 10% 여백 반영                       |
| **F8502**   | 회귀값 업데이트  | Output_EE1.csv 값 변경 시 즉시 반영                        |
| **F8503**   | 축 자동 정렬     | 연도 순서 자동 정렬 기능 (x-axis ascending)                |

---

**🔹 5️⃣ 그래프 저장 기능**

| **항목**           | **내용**                                         |
| :----------------- | :----------------------------------------------- |
| **저장 버튼 기능** | 현재 그래프 이미지를 PNG/JPG 형식으로 저장       |
| **파일명 규칙**    | PlotH2Sale\_[YYYYMMDD\_HHMM].png                 |
| **저장 경로**      | C:\Users\<User>\Documents\EcoGraphs\|            |
| **기본 포맷**      | PNG                                              |
| **피드백 메시지**  | “PlotH2Sale 그래프가 성공적으로 저장되었습니다.” |
| **에러 처리**      | 파일 권한 또는 경로 접근 오류 시 경고창 표시     |

---

---

**📊 [탭 ID: PlotH2Purchase]**

**그래프명:** Trendline on Purchase Price Based on Year\
**그래프 종류:** 2D Line + Scatter (Trendline 포함)

---

**🔹 1️⃣ 그래프 기본 정보**

| **항목**             | **값**                                           |
| :------------------- | :----------------------------------------------- |
| **그래프 타입**      | 2D Line Plot + Scatter (Trendline 포함)          |
| **그래프 제목**      | Trendline on Purchase Price Based on Year        |
| **X축 제목**         | Year                                             |
| **Y축 제목**         | H₂ Purchase Price (KRW/kg)                       |
| **단위 변환**        | 없음 (KRW 단위 그대로 유지)                      |
| **그래프 색상 규칙** | Data Points: 파란색 ● / Trendline: 빨간색 선     |
| **그래프 범례**      | Blue Circle → Data Points / Red Line → Trendline |
| **축 라벨 포맷**     | 3자리 콤마 구분, X축은 연도 표기                 |
| **배경색**           | 흰색 (#FFFFFF)                                   |
| **범례 위치**        | 우상단 (upper right)                             |
| **추세식 표시 위치** | 그래프 좌측 중간 (y=mx+b 형태 표시, Bold)        |

---

**🔹 2️⃣ 입력 데이터 매핑**

**📁 데이터 파일 참조**

- **입력 파일:** Input_Total.xlsx
- **회귀계수 파일:** Output_EE1.csv

---

**🧩 Data Points (Scatter Plot)**

| **데이터**    | **경로**                                     | **내용**                                          |
| :------------ | :------------------------------------------- | :------------------------------------------------ |
| **x값**       | Input_Total.xlsx → B열 (672~686행)           | 0을 제외한 값 사용 (연도, 단위: Year)             |
| **y값**       | Input_Total.xlsx → B열 (687~701행)           | 0을 제외한 값 사용 (수소 구매 단가, 단위: KRW/kg) |
| **표시 방식** | 파란색 점 (marker='o', size=8, color='blue') |                                                   |
| **표시 조건** | x, y 값이 모두 0이 아닐 때만 출력            |                                                   |

---

**🧩 Trendline (회귀선)**

| **항목**                | **경로**                                                   | **설명**                                |
| :---------------------- | :--------------------------------------------------------- | :-------------------------------------- |
| **기울기 (Slope, m)**   | Output_EE1.csv → J열 3행                                   | 회귀식 ( y = m \times x + b ) 의 기울기 |
| **절편 (Intercept, b)** | Output_EE1.csv → J열 4행                                   | 회귀식 ( y = m \times x + b ) 의 절편   |
| **표시 방식**           | 빨간색 선 (color='r', linewidth=2)                         |                                         |
| **표시식**              | 그래프 내부에 y = mx + b 표시 (폰트: Arial, 크기 12, Bold) |                                         |
| **계산식**              | trend_y = m \* x_vals + b                                  |                                         |
| **표시 단위**           | KRW/kg                                                     |                                         |

---

**🔹 3️⃣ 그래프 계산 로직 (의사코드 예시)**

import pandas as pd

import matplotlib.pyplot as plt

import numpy as np

\# 1. 데이터 로드

input_df = pd.read_excel('Input_Total.xlsx', sheet_name=0)

output_df = pd.read_csv('Output_EE1.csv')

\# 2. Data Point 추출

x_vals = input_df.iloc[671:686, 1].replace(0, np.nan).dropna() # B열(672~686행)

y_vals = input_df.iloc[686:701, 1].replace(0, np.nan).dropna() # B열(687~701행)

\# 3. Trendline 계수

slope = output_df.iloc[2, 9] # J열(3행)

intercept = output_df.iloc[3, 9] # J열(4행)

\# 4. 추세선 계산

trend_y = slope \* x_vals + intercept

\# 5. 그래프 생성

plt.figure(figsize=(6,5))

plt.scatter(x_vals, y_vals, color='blue', label='Data Points')

plt.plot(x_vals, trend_y, color='red', label='Trendline')

plt.text(min(x_vals)+2, min(y_vals)+0.8\*(max(y_vals)-min(y_vals)),

`         `f"y = {slope:.4f}x + {intercept:.4f}",

`         `fontsize=12, color='black', fontweight='bold')

plt.xlabel('Year')

plt.ylabel('H2 Purchase Price (KRW/kg)')

plt.title('Trendline on Purchase Price Based on Year')

plt.legend()

plt.grid(True)

plt.show()

---

**🔹 4️⃣ 요구 기능 리스트**

| **기능 ID** | **기능명**       | **기능 설명**                                              |
| :---------- | :--------------- | :--------------------------------------------------------- |
| **F8511**   | 그래프 생성      | Input_Total.xlsx 및 Output_EE1.csv 기반 그래프 자동 렌더링 |
| **F8512**   | Trendline 표시   | J열(3~4행) 기반 y=mx+b 추세선 출력                         |
| **F8513**   | Data Point 표시  | 0이 아닌 x, y 데이터 포인트 파란색 점으로 출력             |
| **F8514**   | 단위 유지        | KRW 단위 그대로 표시                                       |
| **F8515**   | 추세식 표시      | 그래프 내부에 y=mx+b 수식 텍스트로 출력                    |
| **F8516**   | 축 라벨 표시     | X: Year / Y: H₂ Purchase Price (KRW/kg)                    |
| **F8517**   | 범례 표시        | Data Points, Trendline 항목 표시                           |
| **F8518**   | 그래프 저장      | “저장” 클릭 시 JPG/PNG로 그래프 캡처 및 저장               |
| **F8519**   | 저장 파일명 규칙 | PlotH2Purchase\_[YYYYMMDD\_HHMM].png                       |
| **F8520**   | 팝업 닫기        | “닫기” 클릭 시 그래프 결과 팝업 종료                       |
| **F8521**   | 오토 스케일링    | X, Y 범위 자동 계산 및 10% 여백 반영                       |
| **F8522**   | 회귀값 업데이트  | Output_EE1.csv 값 변경 시 즉시 반영                        |
| **F8523**   | 축 자동 정렬     | 연도 순서 자동 정렬 기능 (x-axis ascending)                |

---

**🔹 5️⃣ 그래프 저장 기능**

| **항목**           | **내용**                                             |
| :----------------- | :--------------------------------------------------- |
| **저장 버튼 기능** | 현재 그래프 이미지를 PNG/JPG 형식으로 저장           |
| **파일명 규칙**    | PlotH2Purchase\_[YYYYMMDD\_HHMM].png                 |
| **저장 경로**      | C:\Users\<User>\Documents\EcoGraphs\|                |
| **기본 포맷**      | PNG                                                  |
| **피드백 메시지**  | “PlotH2Purchase 그래프가 성공적으로 저장되었습니다.” |
| **에러 처리**      | 파일 권한 또는 경로 접근 오류 시 경고창 표시         |

---

---

**📊 [탭 ID: PlotOp]**

**그래프명:** Daily Number of H₂ Fueling Events (Over 30 Years)\
**그래프 종류:** 2D Line + Marker Plot (2-Series)

---

**🔹 1️⃣ 그래프 기본 정보**

| **항목**             | **값**                                                 |
| :------------------- | :----------------------------------------------------- |
| **그래프 타입**      | 2D Line Plot (Series 2개)                              |
| **그래프 제목**      | Daily Number of H₂ Fueling Events (Over 30 Years)      |
| **X축 제목**         | Year                                                   |
| **Y축 제목**         | Daily Number of H₂ Fueling Events (ea/day)             |
| **단위 변환**        | 없음                                                   |
| **그래프 색상 규칙** | Fueling Events: 파란색 / Rate of Operation: 빨간색     |
| **마커 스타일**      | Fueling Events: circle ● / Rate of Operation: square ■ |
| **선 스타일**        | 둘 다 실선 (linestyle='-')                             |
| **범례 위치**        | 우상단 (upper right)                                   |
| **배경색**           | 흰색 (#FFFFFF)                                         |
| **격자선 표시**      | True                                                   |
| **Y축 단위**         | ea/day (일일 충전 횟수)                                |

---

**🔹 2️⃣ 입력 데이터 매핑**

**📁 데이터 파일 참조**

- **데이터 파일:** Output_EE3.csv

---

**🧩 Data Series 구성**

| **시리즈명**          | **X 데이터**                   | **Y 데이터**                   | **색상** | **마커**  | **설명**                  |
| :-------------------- | :----------------------------- | :----------------------------- | :------- | :-------- | :------------------------ |
| **Fueling Events**    | Output_EE3.csv → A열 (2행부터) | Output_EE3.csv → B열 (2행부터) | 파란색   | 원형(o)   | 연도별 일일 수소충전 횟수 |
| **Rate of Operation** | Output_EE3.csv → A열 (2행부터) | Output_EE3.csv → C열 (2행부터) | 빨간색   | 사각형(s) | 연도별 충전소 운영률      |

---

**🔹 3️⃣ 그래프 계산 로직 (의사코드 예시)**

import pandas as pd

import matplotlib.pyplot as plt

\# 1. 데이터 로드

df = pd.read_csv('Output_EE3.csv')

\# 2. 데이터 추출

x_vals = df.iloc[1:, 0] # A열 (2행부터, Year)

y1_vals = df.iloc[1:, 1] # B열 (2행부터, Fueling Events)

y2_vals = df.iloc[1:, 2] # C열 (2행부터, Rate of Operation)

\# 3. 그래프 생성

plt.figure(figsize=(7,5))

plt.plot(x_vals, y1_vals, color='blue', marker='o', label='Fueling Events')

plt.plot(x_vals, y2_vals, color='red', marker='s', label='Rate of Operation')

plt.xlabel('Year')

plt.ylabel('Daily Number of H2 Fueling Events (ea/day)')

plt.title('Daily Number of H2 Fueling Events (Over 30 Years)')

plt.legend()

plt.grid(True)

plt.show()

---

**🔹 4️⃣ 요구 기능 리스트**

| **기능 ID** | **기능명**               | **기능 설명**                                               |
| :---------- | :----------------------- | :---------------------------------------------------------- |
| **F8531**   | 그래프 생성              | Output_EE3.csv 기반 2-Series 라인 그래프 생성               |
| **F8532**   | Fueling Events 시리즈    | A열–B열 데이터로 파란색 원형 마커 그래프 출력               |
| **F8533**   | Rate of Operation 시리즈 | A열–C열 데이터로 빨간색 사각형 마커 그래프 출력             |
| **F8534**   | 축 설정                  | X축: Year / Y축: Daily Number of H₂ Fueling Events (ea/day) |
| **F8535**   | 범례 표시                | Fueling Events, Rate of Operation 항목 표시                 |
| **F8536**   | 마커 스타일              | y1: circle(o), y2: square(s)                                |
| **F8537**   | 단위 표시                | Y축 단위 “ea/day” 유지                                      |
| **F8538**   | 그래프 저장              | “저장” 클릭 시 JPG/PNG로 그래프 저장                        |
| **F8539**   | 저장 파일명 규칙         | PlotOp\_[YYYYMMDD\_HHMM].png                                |
| **F8540**   | 팝업 닫기                | “닫기” 클릭 시 그래프 팝업 종료                             |
| **F8541**   | 오토 스케일링            | X, Y 자동 범위 조정 및 여백 반영                            |
| **F8542**   | 축 정렬                  | 연도 순서 자동 정렬 (오름차순)                              |
| **F8543**   | 실시간 반영              | Output_EE3.csv 갱신 시 그래프 즉시 업데이트                 |

---

**🔹 5️⃣ 그래프 저장 기능**

| **항목**           | **내용**                                     |
| :----------------- | :------------------------------------------- |
| **저장 버튼 기능** | 현재 그래프를 PNG 또는 JPG 형식으로 저장     |
| **파일명 규칙**    | PlotOp\_[YYYYMMDD\_HHMM].png                 |
| **저장 경로**      | C:\Users\<User>\Documents\EcoGraphs\|        |
| **기본 포맷**      | PNG                                          |
| **피드백 메시지**  | “PlotOp 그래프가 성공적으로 저장되었습니다.” |
| **에러 처리**      | 저장 권한 또는 경로 오류 시 경고창 표시      |

---

---

**📊 [탭 ID: PlotH2SnP]**

**그래프명:** Annual H₂ Purchase & Sales (Over 30 Years)\
**그래프 종류:** 2D Line + Marker Plot (2-Series)

---

**🔹 1️⃣ 그래프 기본 정보**

| **항목**             | **값**                                     |
| :------------------- | :----------------------------------------- |
| **그래프 타입**      | 2D Line Plot (Series 2개)                  |
| **그래프 제목**      | Annual H₂ Purchase & Sales (Over 30 Years) |
| **X축 제목**         | Year                                       |
| **Y축 제목**         | Annual H₂ Purchase & Sales (Won @ Yr)      |
| **단위 변환**        | 없음                                       |
| **그래프 색상 규칙** | Sales: 파란색 / Purchase: 빨간색           |
| **마커 스타일**      | Sales: 원형(o) / Purchase: 사각형(s)       |
| **선 스타일**        | 둘 다 실선 (linestyle='-')                 |
| **범례 위치**        | 우상단 (upper right)                       |
| **배경색**           | 흰색 (#FFFFFF)                             |
| **격자선 표시**      | True                                       |
| **Y축 단위**         | KRW (연간 금액 기준)                       |

---

**🔹 2️⃣ 입력 데이터 매핑**

**📁 데이터 파일 참조**

- **데이터 파일:** Output_EE3.csv

---

**🧩 Data Series 구성**

| **시리즈명**     | **X 데이터**                   | **Y 데이터**                   | **색상** | **마커**  | **설명**            |
| :--------------- | :----------------------------- | :----------------------------- | :------- | :-------- | :------------------ |
| **M_SalePerYr**  | Output_EE3.csv → A열 (2행부터) | Output_EE3.csv → D열 (2행부터) | 파란색   | 원형(o)   | 연도별 H₂ 판매 금액 |
| **M_PurchPerYr** | Output_EE3.csv → A열 (2행부터) | Output_EE3.csv → E열 (2행부터) | 빨간색   | 사각형(s) | 연도별 H₂ 구매 금액 |

---

**🔹 3️⃣ 그래프 계산 로직 (의사코드 예시)**

import pandas as pd

import matplotlib.pyplot as plt

\# 1. 데이터 로드

df = pd.read_csv('Output_EE3.csv')

\# 2. 데이터 추출

x_vals = df.iloc[1:, 0] # A열 (2행부터, 연도)

y1_vals = df.iloc[1:, 3] # D열 (2행부터, H2 판매 금액)

y2_vals = df.iloc[1:, 4] # E열 (2행부터, H2 구매 금액)

\# 3. 그래프 생성

plt.figure(figsize=(7,5))

plt.plot(x_vals, y1_vals, color='blue', marker='o', label='M_SalePerYr')

plt.plot(x_vals, y2_vals, color='red', marker='s', label='M_PurchPerYr')

plt.xlabel('Year')

plt.ylabel('Annual H2 Purchase & Sales (Won @ Yr)')

plt.title('Annual H2 Purchase & Sales (Over 30 Years)')

plt.legend()

plt.grid(True)

plt.show()

---

**🔹 4️⃣ 요구 기능 리스트**

| **기능 ID** | **기능명**          | **기능 설명**                                          |
| :---------- | :------------------ | :----------------------------------------------------- |
| **F8551**   | 그래프 생성         | Output_EE3.csv 기반 2-Series 라인 그래프 생성          |
| **F8552**   | M_SalePerYr 시리즈  | A열–D열 데이터로 파란색 원형 마커 그래프 출력          |
| **F8553**   | M_PurchPerYr 시리즈 | A열–E열 데이터로 빨간색 사각형 마커 그래프 출력        |
| **F8554**   | 축 설정             | X축: Year / Y축: Annual H₂ Purchase & Sales (Won @ Yr) |
| **F8555**   | 범례 표시           | Sales, Purchase 항목 표시                              |
| **F8556**   | 마커 스타일         | Sales: circle(o), Purchase: square(s)                  |
| **F8557**   | 단위 표시           | Y축 단위 “Won @ Yr” 유지                               |
| **F8558**   | 그래프 저장         | “저장” 클릭 시 JPG/PNG로 그래프 저장                   |
| **F8559**   | 저장 파일명 규칙    | PlotH2SnP\_[YYYYMMDD\_HHMM].png                        |
| **F8560**   | 팝업 닫기           | “닫기” 클릭 시 그래프 팝업 종료                        |
| **F8561**   | 오토 스케일링       | X, Y 자동 범위 조정 및 여백 반영                       |
| **F8562**   | 축 정렬             | 연도 순서 자동 정렬 (오름차순)                         |
| **F8563**   | 실시간 반영         | Output_EE3.csv 갱신 시 그래프 즉시 업데이트            |

---

**🔹 5️⃣ 그래프 저장 기능**

| **항목**           | **내용**                                        |
| :----------------- | :---------------------------------------------- |
| **저장 버튼 기능** | 현재 그래프를 PNG 또는 JPG 형식으로 저장        |
| **파일명 규칙**    | PlotH2SnP\_[YYYYMMDD\_HHMM].png                 |
| **저장 경로**      | C:\Users\<User>\Documents\EcoGraphs\|           |
| **기본 포맷**      | PNG                                             |
| **피드백 메시지**  | “PlotH2SnP 그래프가 성공적으로 저장되었습니다.” |
| **에러 처리**      | 저장 권한 또는 경로 오류 시 경고창 표시         |

---

---

**📊 [탭 ID: PlotPeople]**

**그래프명:** Number of Employees per Year (Over 30 Years)\
**그래프 종류:** 2D Line + Marker Plot (단일 시리즈)

---

**🔹 1️⃣ 그래프 기본 정보**

| **항목**        | **값**                                       |
| :-------------- | :------------------------------------------- |
| **그래프 타입** | 2D Line Plot                                 |
| **그래프 제목** | Number of Employees per Year (Over 30 Years) |
| **X축 제목**    | Year                                         |
| **Y축 제목**    | Number of Employees (People/yr)              |
| **단위 변환**   | 없음                                         |
| **그래프 색상** | 파란색 (#0070C0)                             |
| **마커 스타일** | 원형(o), 라인 연결                           |
| **선 스타일**   | 실선 (linestyle='-')                         |
| **범례**        | 표시하지 않음 (단일 시리즈 그래프)           |
| **배경색**      | 흰색 (#FFFFFF)                               |
| **격자선 표시** | True                                         |
| **Y축 단위**    | People/yr                                    |

---

**🔹 2️⃣ 입력 데이터 매핑**

**📁 데이터 파일 참조**

- **데이터 파일:** Output_EE3.csv

---

**🧩 Data Series 구성**

| **시리즈명**    | **X 데이터**                   | **Y 데이터**                   | **색상** | **마커** | **설명**               |
| :-------------- | :----------------------------- | :----------------------------- | :------- | :------- | :--------------------- |
| **PeoplePerYr** | Output_EE3.csv → A열 (2행부터) | Output_EE3.csv → F열 (2행부터) | 파란색   | 원형(o)  | 연도별 인력 수 (명/년) |

---

**🔹 3️⃣ 그래프 계산 로직 (의사코드 예시)**

import pandas as pd

import matplotlib.pyplot as plt

\# 1. 데이터 로드

df = pd.read_csv('Output_EE3.csv')

\# 2. 데이터 추출

x_vals = df.iloc[1:, 0] # A열 (2행부터, 연도)

y_vals = df.iloc[1:, 5] # F열 (2행부터, 인력 수)

\# 3. 그래프 생성

plt.figure(figsize=(7,5))

plt.plot(x_vals, y_vals, color='blue', marker='o', linestyle='-', label='Employees')

plt.xlabel('Year')

plt.ylabel('Number of Employees (People/yr)')

plt.title('Number of Employees per Year (Over 30 Years)')

plt.grid(True)

plt.show()

---

**🔹 4️⃣ 요구 기능 리스트**

| **기능 ID** | **기능명**       | **기능 설명**                                    |
| :---------- | :--------------- | :----------------------------------------------- |
| **F8571**   | 그래프 생성      | Output_EE3.csv 기반 연간 인원 변화 그래프 생성   |
| **F8572**   | 데이터 시리즈    | A열–F열 데이터로 인력 추이 그래프 표시           |
| **F8573**   | 축 설정          | X축: Year / Y축: Number of Employees (People/yr) |
| **F8574**   | 단위 표시        | Y축 단위 “People/yr” 유지                        |
| **F8575**   | 선 스타일        | 실선(Line) + 원형 마커                           |
| **F8576**   | 범례 표시        | 생략 (단일 시리즈)                               |
| **F8577**   | 그래프 저장      | “저장” 클릭 시 JPG/PNG로 그래프 저장             |
| **F8578**   | 저장 파일명 규칙 | PlotPeople\_[YYYYMMDD\_HHMM].png                 |
| **F8579**   | 팝업 닫기        | “닫기” 클릭 시 그래프 팝업 종료                  |
| **F8580**   | 오토 스케일링    | X, Y 자동 범위 조정 및 여백 반영                 |
| **F8581**   | 축 정렬          | 연도 순서 자동 정렬 (오름차순)                   |
| **F8582**   | 실시간 반영      | Output_EE3.csv 갱신 시 그래프 즉시 업데이트      |

---

**🔹 5️⃣ 그래프 저장 기능**

| **항목**           | **내용**                                         |
| :----------------- | :----------------------------------------------- |
| **저장 버튼 기능** | 현재 그래프를 PNG 또는 JPG 형식으로 저장         |
| **파일명 규칙**    | PlotPeople\_[YYYYMMDD\_HHMM].png                 |
| **저장 경로**      | C:\Users\<User>\Documents\EcoGraphs\|            |
| **기본 포맷**      | PNG                                              |
| **피드백 메시지**  | “PlotPeople 그래프가 성공적으로 저장되었습니다.” |
| **에러 처리**      | 저장 권한 또는 경로 오류 시 경고창 표시          |

---

---

**📊 [탭 ID: PlotDep]**

**그래프명:** Depreciation Expense (Over 30 Years)\
**그래프 종류:** 2D Line + Marker Plot (단일 시리즈)

---

**🔹 1️⃣ 그래프 기본 정보**

| **항목**        | **값**                               |
| :-------------- | :----------------------------------- |
| **그래프 타입** | 2D Line Plot                         |
| **그래프 제목** | Depreciation Expense (Over 30 Years) |
| **X축 제목**    | Year                                 |
| **Y축 제목**    | Depreciation Expense (Won/yr)        |
| **단위 변환**   | 없음                                 |
| **그래프 색상** | 파란색 (#0070C0)                     |
| **마커 스타일** | 원형(o), 라인 연결                   |
| **선 스타일**   | 실선 (linestyle='-')                 |
| **범례**        | 표시하지 않음 (단일 시리즈)          |
| **배경색**      | 흰색 (#FFFFFF)                       |
| **격자선 표시** | True                                 |
| **Y축 단위**    | Won/yr                               |

---

**🔹 2️⃣ 입력 데이터 매핑**

**📁 데이터 파일 참조**

- **데이터 파일:** Output_EE3.csv

---

**🧩 Data Series 구성**

| **시리즈명** | **X 데이터**                   | **Y 데이터**                   | **색상** | **마커** | **설명**                  |
| :----------- | :----------------------------- | :----------------------------- | :------- | :------- | :------------------------ |
| **DepPerYr** | Output_EE3.csv → A열 (2행부터) | Output_EE3.csv → G열 (2행부터) | 파란색   | 원형(o)  | 연도별 감가상각비 (원/년) |

---

**🔹 3️⃣ 그래프 계산 로직 (의사코드 예시)**

import pandas as pd

import matplotlib.pyplot as plt

\# 1. 데이터 로드

df = pd.read_csv('Output_EE3.csv')

\# 2. 데이터 추출

x_vals = df.iloc[1:, 0] # A열 (2행부터, 연도)

y_vals = df.iloc[1:, 6] # G열 (2행부터, 감가상각비)

\# 3. 그래프 생성

plt.figure(figsize=(7,5))

plt.plot(x_vals, y_vals, color='blue', marker='o', linestyle='-', label='Depreciation')

plt.xlabel('Year')

plt.ylabel('Depreciation Expense (Won/yr)')

plt.title('Depreciation Expense (Over 30 Years)')

plt.grid(True)

plt.show()

---

**🔹 4️⃣ 요구 기능 리스트**

| **기능 ID** | **기능명**       | **기능 설명**                                   |
| :---------- | :--------------- | :---------------------------------------------- |
| **F8591**   | 그래프 생성      | Output_EE3.csv 기반 연간 감가상각비 그래프 생성 |
| **F8592**   | 데이터 시리즈    | A열–G열 데이터로 감가상각비 추이 그래프 표시    |
| **F8593**   | 축 설정          | X축: Year / Y축: Depreciation Expense (Won/yr)  |
| **F8594**   | 단위 표시        | Y축 단위 “Won/yr” 유지                          |
| **F8595**   | 선 스타일        | 실선(Line) + 원형 마커                          |
| **F8596**   | 범례 표시        | 생략 (단일 시리즈)                              |
| **F8597**   | 그래프 저장      | “저장” 클릭 시 JPG/PNG로 그래프 저장            |
| **F8598**   | 저장 파일명 규칙 | PlotDep\_[YYYYMMDD\_HHMM].png                   |
| **F8599**   | 팝업 닫기        | “닫기” 클릭 시 그래프 팝업 종료                 |
| **F8600**   | 오토 스케일링    | X, Y 자동 범위 조정 및 여백 반영                |
| **F8601**   | 축 정렬          | 연도 순서 자동 정렬 (오름차순)                  |
| **F8602**   | 실시간 반영      | Output_EE3.csv 갱신 시 그래프 즉시 업데이트     |

---

**🔹 5️⃣ 그래프 저장 기능**

| **항목**           | **내용**                                      |
| :----------------- | :-------------------------------------------- |
| **저장 버튼 기능** | 현재 그래프를 PNG 또는 JPG 형식으로 저장      |
| **파일명 규칙**    | PlotDep\_[YYYYMMDD\_HHMM].png                 |
| **저장 경로**      | C:\Users\<User>\Documents\EcoGraphs\|         |
| **기본 포맷**      | PNG                                           |
| **피드백 메시지**  | “PlotDep 그래프가 성공적으로 저장되었습니다.” |
| **에러 처리**      | 저장 권한 또는 경로 오류 시 경고창 표시       |

---

---

**📊 [탭 ID: PlotOPEXElement]**

**그래프명:** Operating Costs per Year (Over 30 Years)\
**그래프 종류:** 2D Line + Marker Plot (Multi-Series)

---

**🔹 1️⃣ 그래프 기본 정보**

| **항목**        | **값**                                   |
| :-------------- | :--------------------------------------- |
| **그래프 타입** | 2D Line Plot (4 Series)                  |
| **그래프 제목** | Operating Costs per Year (Over 30 Years) |
| **X축 제목**    | Year                                     |
| **Y축 제목**    | Operating Costs (Won/yr)                 |
| **단위 변환**   | 없음                                     |
| **배경색**      | 흰색 (#FFFFFF)                           |
| **격자선 표시** | True                                     |
| **범례 위치**   | 상단 오른쪽 (upper right)                |
| **Y축 단위**    | Won/yr                                   |
| **마커 표시**   | On (각 Series 별 고유 스타일 지정)       |

---

**🔹 2️⃣ 입력 데이터 매핑**

**📁 데이터 파일 참조**

- **데이터 파일:** Output_EE3.csv

---

**🧩 Data Series 구성**

| **시리즈명**       | **X 데이터**  | **Y 데이터**  | **색상**         | **마커**  | **설명**                      |
| :----------------- | :------------ | :------------ | :--------------- | :-------- | :---------------------------- |
| **Electric Power** | A열 (2행부터) | H열 (2행부터) | 파란색 (#0070C0) | 원형(o)   | 연간 전력비                   |
| **H/W Operation**  | A열 (2행부터) | I열 (2행부터) | 빨간색 (#C00000) | 사각형(s) | 하드웨어 운전비 (기계장치 등) |
| **Labor Cost**     | A열 (2행부터) | J열 (2행부터) | 주황색 (#ED7D31) | 원형(o)   | 인건비                        |
| **Overhead G&A**   | A열 (2행부터) | K열 (2행부터) | 보라색 (#7030A0) | 사각형(s) | 관리비 및 일반간접비          |

---

**🔹 3️⃣ 그래프 계산 로직 (의사코드 예시)**

import pandas as pd

import matplotlib.pyplot as plt

\# 1. 데이터 로드

df = pd.read_csv('Output_EE3.csv')

\# 2. 데이터 추출

x_vals = df.iloc[1:, 0] # A열: Year

y1_vals = df.iloc[1:, 7] # H열: Electric Power

y2_vals = df.iloc[1:, 8] # I열: H/W Operation

y3_vals = df.iloc[1:, 9] # J열: Labor Cost

y4_vals = df.iloc[1:, 10] # K열: Overhead G&A

\# 3. 그래프 생성

plt.figure(figsize=(7,5))

plt.plot(x_vals, y1_vals, color='blue', marker='o', label='Electric Power')

plt.plot(x_vals, y2_vals, color='red', marker='s', label='H/W Operation')

plt.plot(x_vals, y3_vals, color='orange', marker='o', label='Labor Cost')

plt.plot(x_vals, y4_vals, color='purple', marker='s', label='Overhead G&A')

plt.xlabel('Year')

plt.ylabel('Operating Costs (Won/yr)')

plt.title('Operating Costs per Year (Over 30 Years)')

plt.legend(loc='upper right')

plt.grid(True)

plt.show()

---

**🔹 4️⃣ 요구 기능 리스트**

| **기능 ID** | **기능명**            | **기능 설명**                                      |
| :---------- | :-------------------- | :------------------------------------------------- |
| **F8611**   | 그래프 생성           | Output_EE3.csv 기반 연간 OPEX 4-Series 그래프 생성 |
| **F8612**   | Electric Power 시리즈 | A열–H열 데이터로 전력비 그래프 표시                |
| **F8613**   | H/W Operation 시리즈  | A열–I열 데이터로 HW 운전비 그래프 표시             |
| **F8614**   | Labor Cost 시리즈     | A열–J열 데이터로 인건비 그래프 표시                |
| **F8615**   | Overhead G&A 시리즈   | A열–K열 데이터로 간접비 그래프 표시                |
| **F8616**   | 축 설정               | X축: Year / Y축: Operating Costs (Won/yr)          |
| **F8617**   | 단위 표시             | Y축 단위 “Won/yr” 유지                             |
| **F8618**   | 그래프 저장           | “저장” 클릭 시 JPG/PNG로 그래프 저장               |
| **F8619**   | 저장 파일명 규칙      | PlotOPEXElement\_[YYYYMMDD\_HHMM].png              |
| **F8620**   | 팝업 닫기             | “닫기” 클릭 시 그래프 팝업 종료                    |
| **F8621**   | 오토 스케일링         | X, Y 자동 범위 조정 및 여백 반영                   |
| **F8622**   | 색상 구분             | Series 별 고유 색상 고정 (시각 혼동 방지)          |
| **F8623**   | 실시간 반영           | Output_EE3.csv 변경 시 그래프 자동 갱신            |

---

**🔹 5️⃣ 그래프 저장 기능**

| **항목**           | **내용**                                              |
| :----------------- | :---------------------------------------------------- |
| **저장 버튼 기능** | 현재 그래프를 PNG 또는 JPG 형식으로 저장              |
| **파일명 규칙**    | PlotOPEXElement\_[YYYYMMDD\_HHMM].png                 |
| **저장 경로**      | C:\Users\<User>\Documents\EcoGraphs\|                 |
| **기본 포맷**      | PNG                                                   |
| **피드백 메시지**  | “PlotOPEXElement 그래프가 성공적으로 저장되었습니다.” |
| **에러 처리**      | 저장 권한 또는 경로 오류 시 경고창 표시               |

---

---

**📊 [탭 ID: PlotOPEX]**

**그래프명:** WonOpex & PV of Opex (Over 30 Years)\
**그래프 종류:** 2D Line + Marker Plot (2-Series)

---

**🔹 1️⃣ 그래프 기본 정보**

| **항목**             | **값**                                   |
| :------------------- | :--------------------------------------- |
| **그래프 타입**      | 2D Line Plot                             |
| **그래프 제목**      | WonOpex & PV of Opex (Over 30 Years)     |
| **X축 제목**         | Year                                     |
| **Y축 제목**         | WonOpex & PV of Opex (Won @ Yr)          |
| **단위 변환**        | 없음                                     |
| **그래프 색상 규칙** | WonOpex: 파란색 / PV of Opex: 빨간색     |
| **마커 스타일**      | WonOpex: 원형(o) / PV of Opex: 사각형(s) |
| **선 스타일**        | 실선 (linestyle='-')                     |
| **범례 위치**        | 상단 오른쪽 (upper right)                |
| **배경색**           | 흰색 (#FFFFFF)                           |
| **격자선 표시**      | True                                     |
| **Y축 단위**         | Won @ Yr                                 |

---

**🔹 2️⃣ 입력 데이터 매핑**

**📁 데이터 파일 참조**

- **데이터 파일:** Output_EE3.csv

---

**🧩 Data Series 구성**

| **시리즈명**   | **X 데이터**                   | **Y 데이터**                   | **색상** | **마커**  | **설명**                             |
| :------------- | :----------------------------- | :----------------------------- | :------- | :-------- | :----------------------------------- |
| **WonOpex**    | Output_EE3.csv → A열 (2행부터) | Output_EE3.csv → L열 (2행부터) | 파란색   | 원형(o)   | 연간 운전비 (명목가 기준)            |
| **PV of Opex** | Output_EE3.csv → A열 (2행부터) | Output_EE3.csv → M열 (2행부터) | 빨간색   | 사각형(s) | 연간 운전비의 현재가치 (할인율 반영) |

---

**🔹 3️⃣ 그래프 계산 로직 (의사코드 예시)**

import pandas as pd

import matplotlib.pyplot as plt

\# 1. 데이터 로드

df = pd.read_csv('Output_EE3.csv')

\# 2. 데이터 추출

x_vals = df.iloc[1:, 0] # A열: Year

y1_vals = df.iloc[1:, 11] # L열: WonOpex

y2_vals = df.iloc[1:, 12] # M열: PV of Opex

\# 3. 그래프 생성

plt.figure(figsize=(7,5))

plt.plot(x_vals, y1_vals, color='blue', marker='o', label='WonOpex')

plt.plot(x_vals, y2_vals, color='red', marker='s', label='PV of Opex')

plt.xlabel('Year')

plt.ylabel('WonOpex & PV of Opex (Won @ Yr)')

plt.title('WonOpex & PV of Opex (Over 30 Years)')

plt.legend(loc='upper right')

plt.grid(True)

plt.show()

---

**🔹 4️⃣ 요구 기능 리스트**

| **기능 ID** | **기능명**        | **기능 설명**                                       |
| :---------- | :---------------- | :-------------------------------------------------- |
| **F8631**   | 그래프 생성       | Output_EE3.csv 기반 2-Series 운전비 그래프 생성     |
| **F8632**   | WonOpex 시리즈    | A열–L열 데이터로 연간 운전비 그래프 표시            |
| **F8633**   | PV of Opex 시리즈 | A열–M열 데이터로 연간 운전비의 현재가치 그래프 표시 |
| **F8634**   | 축 설정           | X축: Year / Y축: WonOpex & PV of Opex (Won @ Yr)    |
| **F8635**   | 단위 표시         | Y축 단위 “Won @ Yr” 유지                            |
| **F8636**   | 그래프 저장       | “저장” 클릭 시 JPG/PNG로 그래프 저장                |
| **F8637**   | 저장 파일명 규칙  | PlotOPEX\_[YYYYMMDD\_HHMM].png                      |
| **F8638**   | 팝업 닫기         | “닫기” 클릭 시 그래프 팝업 종료                     |
| **F8639**   | 오토 스케일링     | X, Y 자동 범위 조정 및 여백 반영                    |
| **F8640**   | 범례 표시         | WonOpex / PV of Opex 두 항목 표시                   |
| **F8641**   | 실시간 반영       | Output_EE3.csv 변경 시 그래프 즉시 갱신             |

---

**🔹 5️⃣ 그래프 저장 기능**

| **항목**           | **내용**                                       |
| :----------------- | :--------------------------------------------- |
| **저장 버튼 기능** | 현재 그래프를 PNG 또는 JPG 형식으로 저장       |
| **파일명 규칙**    | PlotOPEX\_[YYYYMMDD\_HHMM].png                 |
| **저장 경로**      | C:\Users\<User>\Documents\EcoGraphs\|          |
| **기본 포맷**      | PNG                                            |
| **피드백 메시지**  | “PlotOPEX 그래프가 성공적으로 저장되었습니다.” |
| **에러 처리**      | 저장 권한 또는 경로 오류 시 경고창 표시        |

---

---

**📊 [탭 ID: PlotCashFlow]**

**그래프명:** Annual Cash Flow (Over 30 Years)\
**그래프 종류:** 2D Line + Marker Plot (2-Series)

---

**🔹 1️⃣ 그래프 기본 정보**

| **항목**             | **값**                                      |
| :------------------- | :------------------------------------------ |
| **그래프 타입**      | 2D Line Plot                                |
| **그래프 제목**      | Annual Cash Flow (Over 30 Years)            |
| **X축 제목**         | Year                                        |
| **Y축 제목**         | Annual Cash Flow (Won @ Yr)                 |
| **단위 변환**        | 없음                                        |
| **그래프 색상 규칙** | CashFlow: 파란색 / CumuCashFlow: 빨간색     |
| **마커 스타일**      | CashFlow: 원형(o) / CumuCashFlow: 사각형(s) |
| **선 스타일**        | 실선 (linestyle='-')                        |
| **범례 위치**        | 상단 왼쪽 (upper left)                      |
| **배경색**           | 흰색 (#FFFFFF)                              |
| **격자선 표시**      | True                                        |
| **Y축 단위**         | Won @ Yr                                    |

---

**🔹 2️⃣ 입력 데이터 매핑**

**📁 데이터 파일 참조**

- **데이터 파일:** Output_EE3.csv

---

**🧩 Data Series 구성**

| **시리즈명**     | **X 데이터**                   | **Y 데이터**                   | **색상** | **마커**  | **설명**                                                        |
| :--------------- | :----------------------------- | :----------------------------- | :------- | :-------- | :-------------------------------------------------------------- |
| **CashFlow**     | Output_EE3.csv → A열 (2행부터) | Output_EE3.csv → N열 (2행부터) | 파란색   | 원형(o)   | 연도별 순현금흐름 (Operating + Financing + Investing 결과 반영) |
| **CumuCashFlow** | Output_EE3.csv → A열 (2행부터) | Output_EE3.csv → O열 (2행부터) | 빨간색   | 사각형(s) | 누적 현금흐름 (이전년도 CashFlow의 합계 누적치)                 |

---

**🔹 3️⃣ 그래프 계산 로직 (의사코드 예시)**

import pandas as pd

import matplotlib.pyplot as plt

\# 1. 데이터 로드

df = pd.read_csv('Output_EE3.csv')

\# 2. 데이터 추출

x_vals = df.iloc[1:, 0] # A열: Year

y1_vals = df.iloc[1:, 13] # N열: CashFlow

y2_vals = df.iloc[1:, 14] # O열: Cumulative CashFlow

\# 3. 그래프 생성

plt.figure(figsize=(7,5))

plt.plot(x_vals, y1_vals, color='blue', marker='o', label='CashFlow')

plt.plot(x_vals, y2_vals, color='red', marker='s', label='CumuCashFlow')

plt.xlabel('Year')

plt.ylabel('Annual Cash Flow (Won @ Yr)')

plt.title('Annual Cash Flow (Over 30 Years)')

plt.legend(loc='upper left')

plt.grid(True)

plt.show()

---

**🔹 4️⃣ 요구 기능 리스트**

| **기능 ID** | **기능명**            | **기능 설명**                                                  |
| :---------- | :-------------------- | :------------------------------------------------------------- |
| **F8651**   | 그래프 생성           | Output_EE3.csv 기반 2-Series 현금흐름 그래프 생성              |
| **F8652**   | CashFlow 시리즈       | A열–N열 데이터로 연간 현금흐름 표시                            |
| **F8653**   | CumuCashFlow 시리즈   | A열–O열 데이터로 누적 현금흐름 표시                            |
| **F8654**   | 축 설정               | X축: Year / Y축: Annual Cash Flow (Won @ Yr)                   |
| **F8655**   | 단위 표시             | Y축 단위 “Won @ Yr” 유지                                       |
| **F8656**   | 그래프 저장           | “저장” 클릭 시 JPG/PNG로 그래프 저장                           |
| **F8657**   | 저장 파일명 규칙      | PlotCashFlow\_[YYYYMMDD\_HHMM].png                             |
| **F8658**   | 팝업 닫기             | “닫기” 클릭 시 그래프 팝업 종료                                |
| **F8659**   | 오토 스케일링         | X, Y 자동 범위 조정 및 여백 반영                               |
| **F8660**   | 범례 표시             | CashFlow / CumuCashFlow 두 항목 표시                           |
| **F8661**   | 실시간 반영           | Output_EE3.csv 변경 시 그래프 즉시 업데이트                    |
| **F8662**   | 시계열 정렬           | 연도 순서 자동 정렬 (오름차순)                                 |
| **F8663**   | 음수 표시 지원        | 초기 투자 구간 음수 값 시각적 강조(빨간색 영역 음영 처리 옵션) |
| **F8664**   | 로그 스케일 선택 옵션 | 필요 시 Y축 로그 스케일 변환 기능 포함                         |

---

**🔹 5️⃣ 그래프 저장 기능**

| **항목**           | **내용**                                           |
| :----------------- | :------------------------------------------------- |
| **저장 버튼 기능** | 현재 그래프를 PNG 또는 JPG 형식으로 저장           |
| **파일명 규칙**    | PlotCashFlow\_[YYYYMMDD\_HHMM].png                 |
| **저장 경로**      | C:\Users\<User>\Documents\EcoGraphs\|              |
| **기본 포맷**      | PNG                                                |
| **피드백 메시지**  | “PlotCashFlow 그래프가 성공적으로 저장되었습니다.” |
| **에러 처리**      | 저장 권한 또는 경로 오류 시 경고창 표시            |

---
